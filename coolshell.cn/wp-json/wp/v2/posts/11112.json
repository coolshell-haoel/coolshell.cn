{"id":11112,"date":"2014-02-24T08:12:11","date_gmt":"2014-02-24T00:12:11","guid":{"rendered":"http:\/\/coolshell.cn\/?p=11112"},"modified":"2014-08-22T18:16:48","modified_gmt":"2014-08-22T10:16:48","slug":"%e7%94%b1%e8%8b%b9%e6%9e%9c%e7%9a%84%e4%bd%8e%e7%ba%a7bug%e6%83%b3%e5%88%b0%e7%9a%84","status":"publish","type":"post","link":"https:\/\/coolshell.cn\/articles\/11112.html","title":{"rendered":"\u7531\u82f9\u679c\u7684\u4f4e\u7ea7Bug\u60f3\u5230\u7684"},"content":{"rendered":"<p><img decoding=\"async\" loading=\"lazy\" class=\"alignright size-full wp-image-11123\" src=\"https:\/\/coolshell.cn\/wp-content\/uploads\/2014\/02\/apple_goto_fail.png\" alt=\"\" width=\"260\" height=\"158\" \/> 2014\u5e742\u670822\u65e5\uff0c\u5728\u8fd9\u4e2a\u201c\u8fd9\u4e48\u4e8c\u201d\u7684\u65e5\u5b50\u91cc\uff0c\u82f9\u679c\u516c\u53f8\u63a8\u9001\u4e86\u00a0iOS\u00a07.0.6\uff08\u7248\u672c\u53f711B651\uff09\u4fee\u590d\u4e86\u00a0SSL\u00a0\u8fde\u63a5\u9a8c\u8bc1\u7684\u4e00\u4e2a\u00a0bug\u3002\u5b98\u65b9\u7f51\u9875\u5728\u8fd9\u91cc\uff1a<a href=\"http:\/\/support.apple.com\/kb\/HT6147\" target=\"_blank\">http:\/\/support.apple.com\/kb\/HT6147<\/a>\uff0c\u7f51\u9875\u4e2d\u5982\u4e0b\u63cf\u8ff0\uff1a<\/p>\n<blockquote><p><strong>Impact<\/strong>: An attacker with a privileged network position may capture or modify data in sessions protected by SSL\/TLS<\/p>\n<p><strong>Description<\/strong>: Secure Transport failed to validate the authenticity of the connection. This issue was addressed by restoring missing validation steps.<\/p><\/blockquote>\n<p>\u4e5f\u5c31\u662f\u8bf4\uff0c\u8fd9\u4e2abug\u4f1a\u5f15\u8d77\u4e2d\u95f4\u4eba\u653b\u51fb\uff0cbug\u7684\u63cf\u8ff0\u4e2d\u8bf4\uff0c\u8fd9\u4e2a\u95ee\u9898\u662f\u56e0\u4e3amiss\u4e86\u5bf9\u8fde\u63a5\u8ba4\u8bc1\u7684\u5408\u6cd5\u6027\u68c0\u67e5\u7684\u6b65\u9aa4\u3002<\/p>\n<p>\u8fd9\u91cc\u591a\u8bf4\u4e00\u53e5\uff0c<strong>\u4e00\u65e6\u7f51\u4e0a\u53d1\u751f\u4efb\u4f55\u7684\u548cSSL\/TL\u76f8\u5173\u7684bug\u6216\u5b89\u5168\u95ee\u9898\uff0c\u4e0d\u7ba1\u662f\u505a\u4e3a\u7528\u6237\uff0c\u8fd8\u662f\u505a\u4e3a\u7a0b\u5e8f\u5458\u7684\u4f60\uff0c\u4f60\u4e00\u5b9a\u8981\u9ad8\u5ea6\u91cd\u89c6\u8d77\u6765<\/strong>\u3002\u56e0\u4e3a\u8fd9\u4e2a\u7f51\u7edc\u901a\u4fe1\u7684\u52a0\u5bc6\u534f\u8bae\u88ab\u5e7f\u6cdb\u7684\u5e94\u7528\u5728\u5f88\u591a\u5f88\u591a\u6700\u6700\u9700\u8981\u5b89\u5168\u7684\u5730\u65b9\uff0c\u5982\u679cSSL\/TLS\u6709\u95ee\u9898\u7684\u8bdd\uff0c\u610f\u5473\u7740\u8fd9\u4e2a\u4e16\u754c\u7684\u8ba1\u7b97\u673a\u5b89\u5168\u4f53\u7cfb\u7684\u5d29\u6e83\u3002<\/p>\n<div id=\"ez-toc-container\" class=\"ez-toc-v2_0_48 counter-hierarchy ez-toc-counter ez-toc-grey ez-toc-container-direction\">\n<div class=\"ez-toc-title-container\">\n<p class=\"ez-toc-title\">\u76ee\u5f55<\/p>\n<span class=\"ez-toc-title-toggle\"><\/span><\/div>\n<nav><ul class='ez-toc-list ez-toc-list-level-1 ' ><li class='ez-toc-page-1 ez-toc-heading-level-4'><a class=\"ez-toc-link ez-toc-heading-1\" href=\"https:\/\/coolshell.cn\/articles\/11112.html\/#Bug%E7%9A%84%E4%BB%A3%E7%A0%81%E5%8E%9F%E5%9B%A0\" title=\"Bug\u7684\u4ee3\u7801\u539f\u56e0\">Bug\u7684\u4ee3\u7801\u539f\u56e0<\/a><\/li><li class='ez-toc-page-1 ez-toc-heading-level-4'><a class=\"ez-toc-link ez-toc-heading-2\" href=\"https:\/\/coolshell.cn\/articles\/11112.html\/#%E4%B8%80%E4%BA%9B%E6%80%9D%E8%80%83\" title=\"\u4e00\u4e9b\u601d\u8003\">\u4e00\u4e9b\u601d\u8003<\/a><ul class='ez-toc-list-level-5'><li class='ez-toc-heading-level-5'><a class=\"ez-toc-link ez-toc-heading-3\" href=\"https:\/\/coolshell.cn\/articles\/11112.html\/#0%EF%BC%89%E5%85%B3%E4%BA%8E%E7%BC%96%E8%AF%91%E6%8A%A5%E8%AD%A6\" title=\"0\uff09\u5173\u4e8e\u7f16\u8bd1\u62a5\u8b66\">0\uff09\u5173\u4e8e\u7f16\u8bd1\u62a5\u8b66<\/a><\/li><li class='ez-toc-page-1 ez-toc-heading-level-5'><a class=\"ez-toc-link ez-toc-heading-4\" href=\"https:\/\/coolshell.cn\/articles\/11112.html\/#1%EF%BC%89%E5%85%B3%E4%BA%8ECode_Merge_%E5%92%8C_Code_Review\" title=\"1\uff09\u5173\u4e8eCode Merge \u548c Code Review\">1\uff09\u5173\u4e8eCode Merge \u548c Code Review<\/a><\/li><li class='ez-toc-page-1 ez-toc-heading-level-5'><a class=\"ez-toc-link ez-toc-heading-5\" href=\"https:\/\/coolshell.cn\/articles\/11112.html\/#2%EF%BC%89%E5%85%B3%E4%BA%8E%E6%B5%8B%E8%AF%95\" title=\"2\uff09\u5173\u4e8e\u6d4b\u8bd5\">2\uff09\u5173\u4e8e\u6d4b\u8bd5<\/a><\/li><li class='ez-toc-page-1 ez-toc-heading-level-5'><a class=\"ez-toc-link ez-toc-heading-6\" href=\"https:\/\/coolshell.cn\/articles\/11112.html\/#3%EF%BC%89%E5%85%B3%E4%BA%8E%E7%BC%96%E7%A0%81%E9%A3%8E%E6%A0%BC\" title=\"3\uff09\u5173\u4e8e\u7f16\u7801\u98ce\u683c\">3\uff09\u5173\u4e8e\u7f16\u7801\u98ce\u683c<\/a><\/li><li class='ez-toc-page-1 ez-toc-heading-level-5'><a class=\"ez-toc-link ez-toc-heading-7\" href=\"https:\/\/coolshell.cn\/articles\/11112.html\/#4%EF%BC%89%E5%85%B3%E4%BA%8Egoto%E8%AF%AD%E5%8F%A5\" title=\"4\uff09\u5173\u4e8egoto\u8bed\u53e5\">4\uff09\u5173\u4e8egoto\u8bed\u53e5<\/a><\/li><\/ul><\/li><li class='ez-toc-page-1 ez-toc-heading-level-4'><a class=\"ez-toc-link ez-toc-heading-8\" href=\"https:\/\/coolshell.cn\/articles\/11112.html\/#%E6%80%BB%E7%BB%93\" title=\"\u603b\u7ed3\">\u603b\u7ed3<\/a><\/li><\/ul><\/nav><\/div>\n<h4><span class=\"ez-toc-section\" id=\"Bug%E7%9A%84%E4%BB%A3%E7%A0%81%E5%8E%9F%E5%9B%A0\"><\/span>Bug\u7684\u4ee3\u7801\u539f\u56e0<span class=\"ez-toc-section-end\"><\/span><\/h4>\n<p>Adam Langley\u7684\u300a<a href=\"https:\/\/www.imperialviolet.org\/2014\/02\/22\/applebug.html\">Apple&#8217;s SSL\/TLS bug<\/a>\u00a0\u300b\u7684\u535a\u6587\u66b4\u51fa\u4e86\u8fd9\u4e2abug\u7684\u7ec6\u8282\u3002\uff08\u5728\u82f9\u679c\u7684\u5f00\u6e90\u7f51\u7ad9\u4e0a\uff0c\u901a\u8fc7\u67e5\u770b\u82f9\u679c\u7684\u548cSSL\/TLS\u6709\u5173\u7684\u4ee3\u7801\u53d8\u66f4\uff0c\u6211\u4eec\u53ef\u4ee5\u5728\u6587\u4ef6<a href=\"http:\/\/opensource.apple.com\/source\/Security\/Security-55471\/libsecurity_ssl\/lib\/sslKeyExchange.c\" target=\"_blank\">sslKeyExchange.c<\/a>\u4e2d\u627e\u5230\u4e0b\u9762\u7684\u4ee3\u7801\uff09<\/p>\n<p><!--more--><\/p>\n<pre data-enlighter-language=\"c\" class=\"EnlighterJSRAW\" data-enlighter-highlight=\"12\">static OSStatus\r\nSSLVerifySignedServerKeyExchange(SSLContext *ctx, bool isRsa, SSLBuffer signedParams,\r\n                                 uint8_t *signature, UInt16 signatureLen)\r\n{\r\n\tOSStatus        err;\r\n\t...\r\n\r\n\tif ((err = SSLHashSHA1.update(&amp;hashCtx, &amp;serverRandom)) != 0)\r\n\t\tgoto fail;\r\n\tif ((err = SSLHashSHA1.update(&amp;hashCtx, &amp;signedParams)) != 0)\r\n\t\tgoto fail;\r\n\t\tgoto fail;\r\n\tif ((err = SSLHashSHA1.final(&amp;hashCtx, &amp;hashOut)) != 0)\r\n\t\tgoto fail;\r\n\terr = sslRawVerify(ctx,\r\n                       ctx-&gt;peerPubKey,\r\n                       dataToSign,\t\t\t\t\/* plaintext *\/\r\n                       dataToSignLen,\t\t\t\/* plaintext length *\/\r\n                       signature,\r\n                       signatureLen);\r\n\tif(err) {\r\n\t\tsslErrorLog(&quot;SSLDecodeSignedServerKeyExchange: sslRawVerify &quot;\r\n                    &quot;returned %d\\n&quot;, (int)err);\r\n\t\tgoto fail;\r\n\t}\r\n\r\nfail:\r\n    SSLFreeBuffer(&amp;signedHashes);\r\n    SSLFreeBuffer(&amp;hashCtx);\r\n    return err;\r\n}<\/pre>\n<p>\u6ce8\u610f\uff0c\u6211\u9ad8\u4eae\u7684\u5730\u65b9\uff0c\u4e5f\u5c31\u662f\u90a3\u91cc\u6709\u4e24\u4e2agoto fail; \u56e0\u4e3aif\u8bed\u53e5\u6ca1\u6709\u52a0\u5927\u62ec\u53f7\uff0c\u6240\u4ee5\uff0c\u53ea\u6709\u7b2c\u4e00\u4e2agoto\u662f\u5c5e\u4e8eif\u7684\uff0c\u800c\u7b2c\u4e8c\u4e2agoto\u5219\u662f\u6c38\u8fdc\u90fd\u4f1a\u88ab\u6267\u884c\u5230\u7684\uff08\u6ce8\uff1a\u8fd9\u91cc\u4e0d\u662fPython\u662fC\u8bed\u8a00\uff0c\u7f29\u8fdb\u4e0d\u4ee3\u8868\u8fd9\u4e2a\u8bed\u53e5\u5c5e\u4e8e\u540c\u4e00\u4e2a\u8bed\u53e5\u5757\uff09\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u5c31\u7b97\u662f\u524d\u9762\u7684if\u68c0\u67e5\u90fd\u5931\u8d25\u4e86\uff08err \u00a0== 0\uff09\uff0c\u4e5f\u4f1agoto fail\u3002\u6211\u4eec\u53ef\u4ee5\u770b\u5230fail\u6807\u7b7e\u4e2d\u91ca\u653e\u5b8c\u5185\u5b58\u540e\u5c31\u4f1areturn err;<\/p>\n<p>\u4f60\u60f3\u4e00\u4e0b\uff0c<strong>\u8fd9\u6bb5\u7a0b\u5e8f\u5728SSLHashSHA1.update() \u00a0\u8fd4\u56de\u6210\u529f\uff0c\u4e5f\u5c31\u662f\u8fd4\u56de0 \u7684\u65f6\u5019\u4f1a\u53d1\u751f\u4ec0\u4e48\u6837\u7684\u4e8b\uff1f\u662f\u7684\uff0c\u771f\u6b63\u5e72\u6d3b\u7684\u00a0sslRawVerify()\u88abbypass\u4e86\u3002\u800c\u4e14\u8fd9\u4e2a\u51fd\u6570SSLVerifySignedServerKeyExchange() \u8fd8\u8fd4\u56de\u4e860\uff0c\u4e5f\u5c31\u662f\u6210\u529f\u4e86\uff01<\/strong>\u5c3c\u739b\uff01\u4f60\u53ef\u80fd\u60f3\u5230\u9177\u58f3\u7f51\u4e0a\u4e4b\u524d\u300a<a title=\"\u4e00\u4e2a\u7a7a\u683c\u5f15\u53d1\u7684\u60e8\u5267\" href=\"https:\/\/coolshell.cn\/articles\/4875.html\" target=\"_blank\">\u4e00\u4e2a\u7a7a\u683c\u5f15\u53d1\u7684\u60e8\u5267<\/a>\u300b\u7684\u6587\u7ae0\u3002\u90fd\u662f\u4f4e\u7ea7bug\u3002<\/p>\n<p>\u8fd9\u4e2a\u4f4e\u7ea7bug\u5728\u8fd9\u4e2a\u5468\u672b\u5728\u7f51\u4e0a\u88ab\u7092\u7ffb\u4e86\u5929\uff0c\u4f60\u53ef\u4ee5<strong><a href=\"https:\/\/twitter.com\/search?q=%23gotofail\" target=\"_blank\">\u4e0aTwiter\u4e0a\u770b\u770b#gotofail\u7684\u6807\u7b7e\u7684\u76db\u51b5<\/a><\/strong>\u3002<strong>Goto Fail\u5fc5\u7136\u4f1a\u6210\u4e3a\u5386\u53f2\u4e0a\u7684\u4e00\u4e2a\u7ecf\u5178\u4e8b\u4ef6<\/strong>\u3002<\/p>\n<p>\u5982\u679c\u4f60\u559c\u6b22XKCD\uff0c\u4f60\u4e00\u5b9a\u4f1a\u60f3\u5230\u8fd9\u4e2a\u6f2b\u753b\uff1a<\/p>\n<p><img decoding=\"async\" loading=\"lazy\" class=\"aligncenter\" src=\"https:\/\/sslimgs.xkcd.com\/comics\/goto.png\" alt=\"\" width=\"740\" height=\"201\" \/><\/p>\n<p><span style=\"line-height: 1.5em;\"><strong>\u6ce8\u610f<\/strong>\uff1a\u8fd9\u4e2abug\u4e0d\u4f1a\u5f71\u54cdTLS 1.2\u7248\u672c\uff0c\u56e0\u4e3a1.2\u7248\u672c\u4e0d\u4f1a\u7528\u8fd9\u4e2a\u51fd\u6570\uff0c\u8d70\u7684\u662f\u53e6\u4e00\u5957\u673a\u5236\u3002\u4f46\u662f\u522b\u5fd8\u4e86client\u7aef\u662f\u53ef\u4ee5\u9009\u62e9\u7248\u672c\u7684\u3002<\/span><\/p>\n<p>\u5982\u679c\u4f60\u60f3\u6d4b\u8bd5\u4e00\u4e0b\u4f60\u7684\u6d4f\u89c8\u5668\u662f\u5426\u4f1a\u6709\u95ee\u9898\uff0c<strong>\u4f60\u53ef\u4ee5\u4e0a\u4e00\u4e0b\u5f53\u5929\u5c31\u4e0a\u7ebf\u7684<a href=\"https:\/\/gotofail.com\/\" target=\"_blank\"> https:\/\/gotofail.com<\/a>\u00a0\u7f51\u7ad9<\/strong><\/p>\n<h4><span class=\"ez-toc-section\" id=\"%E4%B8%80%E4%BA%9B%E6%80%9D%E8%80%83\"><\/span>\u4e00\u4e9b\u601d\u8003<span class=\"ez-toc-section-end\"><\/span><\/h4>\n<p>\u4e0b\u9762\u662f\u6211\u5bf9\u8fd9\u4e2a\u95ee\u9898\u7684\u4e00\u4e9b\u601d\u8003\u3002<\/p>\n<h5><span class=\"ez-toc-section\" id=\"0%EF%BC%89%E5%85%B3%E4%BA%8E%E7%BC%96%E8%AF%91%E6%8A%A5%E8%AD%A6\"><\/span>0\uff09\u5173\u4e8e\u7f16\u8bd1\u62a5\u8b66<span class=\"ez-toc-section-end\"><\/span><\/h5>\n<p>\u6709\u4eba\u5728\u8bf4\u82f9\u679c\u7684\u8fd9\u4e2a\u4ee3\u7801\u4e2d\u7684goto\u8bed\u53e5\u4f1a\u4ea7\u751f\u6b7b\u4ee3\u7801\u2014\u2014dead code\uff0c\u4e5f\u5c31\u662f\u6c38\u8fdc\u90fd\u4e0d\u4f1a\u6267\u884c\u5230\u7684\u4ee3\u7801\uff0cC\/C++\u7684\u7f16\u7a0b\u5668\u662f\u4f1a\u62a5\u8b66\u7684\u3002\u4f46\uff0c\u5b9e\u9645\u4e0a\uff0cdead code\u5728\u9ed8\u8ba4\u4e0a\u7684\u4e0d\u4f1a\u62a5\u8b66\u7684\u3002\u5373\u4f7f\u4f60\u52a0\u4e0a-Wall\uff0cGCC 4.8.2 \u6216 Clang 3.3 \u90fd\u4e0d\u4f1a\u62a5\u8b66\uff0c\u5305\u62ecVisual Studio 2012\u5728\u9ed8\u8ba4\u7684\u62a5\u8b66\u7ea7\u522b\u4e5f\u4e0d\u4f1a\uff08\u9ed8\u8ba4\u662f\/W3\u7ea7\uff0c\u9700\u8981\u4e0a\u5347\u5230\/W4\u7ea7\u4ee5\u4e0a\uff0c\u4f46\u662f\u5347\u7ea7\u5230\/W4\u4e0a\uff0c\u4f60\u7684\u5de5\u7a0b\u53ef\u80fd\u4f1a\u6709N\u591a\u7684Warning\uff0c\u4f60\u4e0d\u4e00\u5b9a\u80fd\u770b\u5f97\u8fc7\u6765\uff09\u3002gcc\u548cClang\u6709\u4e00\u4e2a\u53c2\u6570\u53eb\uff1a-Wunreachable-code\uff0c\u662f\u53ef\u4ee5\u5bf9\u8fd9\u79cd\u60c5\u51b5\u62a5\u8b66\u7684\uff0c\u4f46\u5373\u6ca1\u6709\u88ab\u5305\u62ec\u5728-Wall\u91cc\u3002\u539f\u56e0\u662f\uff0c\u8fd9\u4e2a\u53c2\u6570\u6709\u5f88\u591a\u7684\u95ee\u9898\uff0c\u56e0\u4e3a\u7f16\u8bd1\u5668\u7684\u4f18\u5316\u4ee3\u7801\u7684\u884c\u4e3a\uff0c\u8fd9\u4e2a\u53c2\u6570\u5e76\u4e0d\u80fd\u5bf9\u6bcf\u79cd\u60c5\u51b5\u90fd\u51c6\u786e\u5730\u62a5\u544a\u3002\u53e6\u8bf7\u6ce8\u610f\uff0cGCC\u7684\u65b0\u7248\u672c\u4e2d\u5254\u9664\u4e86\u8fd9\u4e2a\u53c2\u6570\u3002\u5f53\u7136\uff0c\u5176\u5b83\u4e00\u4e9b\u9759\u6001\u7684\u4ee3\u7801\u68c0\u67e5\u5de5\u5177\u4e5f\u53ef\u4ee5\u68c0\u67e5\u8fd9\u4e2a\u4f4e\u7ea7\u7684\u95ee\u9898\u3002<\/p>\n<p>\u53e6\u5916\uff0c\u662f\u4e0d\u662f\u7528IDE\u7684\u4ee3\u7801\u81ea\u52a8\u5316\u683c\u5f0f\u5de5\u5177\u4e5f\u53ef\u4ee5\u5e2e\u4e0a\u4e00\u70b9\u5fd9\u5462\uff1f\u81f3\u5c11\u53ef\u4ee5\u628a\u90a3\u4e2a\u7f29\u8fdb\u53d8\u6210\u8ba9\u4eba\u4e00\u770b\u5c31\u89c9\u5f97\u6709\u95ee\u9898\u3002<\/p>\n<h5><span class=\"ez-toc-section\" id=\"1%EF%BC%89%E5%85%B3%E4%BA%8ECode_Merge_%E5%92%8C_Code_Review\"><\/span>1\uff09\u5173\u4e8eCode Merge \u548c Code Review<span class=\"ez-toc-section-end\"><\/span><\/h5>\n<p>\u4f60\u53ef\u4ee5\u901a\u8fc7\u8fd9\u91cc\u7684\u4ee3\u7801\u6bd4\u8f83\u770b\u5230\u8fd9\u4e2abug\u7684diff\uff0c\u4e5f\u53ef\u4ee5\u5230<a href=\"https:\/\/gist.github.com\/alexyakoubian\/9151610\/revisions\" target=\"_blank\">\u8fd9\u91cc\u770b\u770b<\/a>\uff08631\u884c\uff09\u3002<\/p>\n<blockquote style=\"font-size: 11px;\"><p>diff -urN &lt;(curl -s http:\/\/opensource.apple.com\/source\/Security\/Security-55179.13\/libsecurity_ssl\/lib\/sslKeyExchange.c\\?txt) \\ &lt;(curl -s http:\/\/opensource.apple.com\/source\/Security\/Security-55471\/libsecurity_ssl\/lib\/sslKeyExchange.c\\?txt) \\<\/p><\/blockquote>\n<p>\u901a\u8fc7code diff\u4f60\u53ef\u4ee5\u770b\u5230\uff0c<strong>\u82f9\u679c\u516c\u53f8\u662f\u5728\u91cd\u6784\u4ee3\u7801\u2014\u2014\u4e3a\u5f88\u591a\u51fd\u6570\u53bb\u6389\u4e86ctx\u7684\u53c2\u6570<\/strong>\u3002<\/p>\n<p>\u6240\u4ee5\uff0c\u6211\u4eec\u53ef\u4ee5\u731c\u6d4b\uff0c\u4e24\u4e2agoto fail\u8bed\u53e5\uff0c\u53ef\u80fd\u662f\u56e0\u4e3a\u5bf9code\u5728\u4e0d\u540cbranch\u4e0a\u505amerge\u53d1\u751f\u7684\u3002\u7248\u672c\u5de5\u5177merge\u4ee3\u7801\u7684\u65f6\u5019\uff0c\u7ecf\u5e38\u6027\u7684\u4f1a\u51fa\u73b0\u8fd9\u6837\u7684\u95ee\u9898\u3002\u5982\u679c\u4ee3\u7801\u7684diff\u5f88\u591a\uff0c\u8fd9\u4e2a\u95ee\u9898\u4f1a\u5f88\u5bb9\u6613\u5c31\u6ca1\u6709\u6ce8\u610f\u5230\u3002\u5c31\u7b97\u6709code review\uff0c\u8fd9\u4e2a\u6709\u95ee\u9898\u7684\u4ee3\u7801\u4e5f\u5f88\u96be\u88ab\u627e\u51fa\u6765\u7684\u3002<strong>\u5982\u679c\u4f60\u6765review\u4e0b\u9762\u7684diff\uff0c\u4f60\u4f1a\u6ce8\u610f\u5230\u8fd9\u4e2a\u9519\u8bef\u5417\uff1f<\/strong><\/p>\n<p><img decoding=\"async\" loading=\"lazy\" class=\"aligncenter\" src=\"https:\/\/coolshell.cn\/wp-content\/uploads\/2014\/02\/gotofail.jpg\" alt=\"\" width=\"560\" height=\"275\" \/><\/p>\n<p>\u4e5f\u5c31\u662f\u8bf4\uff0c\u5728\u91cd\u6784\u5206\u652f\u4e0a\u7684\u4ee3\u7801\u662f\u5bf9\u7684\uff0c\u4f46\u662f\u5728\u5206\u652fmerge\u7684\u65f6\u5019\uff0c\u88abmerge\u5de5\u5177\u641e\u4e71\u4e86\u3002\u6240\u4ee5\u8bf4\uff0c<strong>\u6211\u4eec\u5728\u505acode merge\u7684\u65f6\u5019\uff0c\u4e00\u5b9a\u8981\u5c0f\u5fc3\u5c0f\u5fc3\u518d\u5c0f\u5fc3\uff0c\u4e0d\u80fd\u5b8c\u5168\u76f8\u4fe1merge\u5de5\u5177<\/strong>\u3002<\/p>\n<h5><span class=\"ez-toc-section\" id=\"2%EF%BC%89%E5%85%B3%E4%BA%8E%E6%B5%8B%E8%AF%95\"><\/span>2\uff09\u5173\u4e8e\u6d4b\u8bd5<span class=\"ez-toc-section-end\"><\/span><\/h5>\n<p>\u5f88\u660e\u663e\uff0c\u8fd9\u4e2abug\u5f88\u96be\u88abcode review\u53d1\u73b0\u3002\u5bf9\u4e8e\u91cd\u6784\u4ee3\u7801\u548c\u4ee3\u7801merge\u91cc\u4f17\u591a\u7684diff\uff0c\u662f\u5f88\u96be\u88abreview\u7684\u3002<\/p>\n<p>\u5f53\u7136\uff0c\u201c\u4e8b\u540e\u8bf8\u845b\u4eae\u201d\u7684\u4eba\u4eec\u603b\u662f\u5f88\u5bb9\u6613\u5730\u8bf4\u8fd9\u4e2a\u95ee\u9898\u53ef\u4ee5\u88ab\u6d4b\u8bd5\u53d1\u73b0\uff0c\u4f46\u662f\u5b9e\u9645\u60c5\u51b5\u662f\u8fd9\u6837\u7684\u5417\uff1f<\/p>\n<p>\u8fd9\u4e2a\u95ee\u9898\u4e5f\u5f88\u96be\u88ab\u529f\u80fd\u6d4b\u8bd5\u53d1\u73b0\uff0c\u56e0\u4e3a\u8fd9\u4e2a\u51fd\u6570\u5728\u662f\u5728\u7f51\u7edc\u63e1\u624b\u91cc\u5f88\u6df1\u7684\u5730\u65b9\uff0c\u529f\u80fd \u6d4b\u8bd5\u4e0d\u4e00\u5b9a\u80fd\u8986\u76d6\u5f97\u90a3\u4e48\u6df1\uff0c\u4f60\u8981\u5199\u8fd9\u6837\u7684case\uff0c\u5fc5\u9700\u5bf9TLS\u7684\u534f\u8bae\u6808\u975e\u5e38\u719f\u6089\uff0c\u719f\u6089\u5230\u5bf9\u4ed6\u6240\u6709\u7684\u53c2\u6570\u90fd\u5f88\u719f\u6089\uff0c\u5e76\u80fd\u5199\u51fa\u9488\u5bf9\u6bcf\u4e00\u4e2a\u53c2\u6570\u4ee5\u53ca\u8fd9\u4e9b\u53c2\u6570\u7684\u7ec4\u5408\u505a\u4e00\u5806test case\uff0c\u8fd9\u4e2a\u4e8b\u60c5\u4e5f\u662f\u4e00\u4ef6\u5f88\u590d\u6742\u7684\u4e8b\u3002\u8981\u5199\u51fa\u6240\u6709\u7684case\u672c\u8eab\u5c31\u662f\u4e00\u4ef6\u5f88\u96be\u5f88\u96be\u7684\u4e8b\u60c5\u3002\u5173\u4e8e\u8fd9\u4e2a\u53ebSSLVerifySignedServerKeyExchange()\u51fd\u6570\u7684\u7ec6\u8282\uff0c\u4f60\u53ef\u4ee5\u770b\u770b\u76f8\u5173\u7684<a href=\"https:\/\/tools.ietf.org\/html\/rfc5246#section-7.4.3\">ServerKeyExchange<\/a>\u00a0RFC\u6587\u6863\u3002<\/p>\n<p>\u5982\u679c\u53ea\u770b\u8fd9\u4e2a\u95ee\u9898\u7684\u8bdd\uff0c\u4f60\u4f1a\u8bf4\u5bf9\u8fd9\u4e2a\u51fd\u6570\u505a\u7684 Unit Test \u53ef\u4ee5\u53d1\u73b0\u8fd9\u4e2a\u95ee\u9898\uff0c\u662f\u7684\u3002\u4f46\u662f\uff0c\u522b\u5fd8\u4e86SSL\/TLS\u8fd9\u4e48\u591a\u5e74\u4e86\uff0c\u8fd9\u4e9b\u57fa\u7840\u51fd\u6570\u90fd\u5e94\u8be5\u662f\u5f88\u7a33\u5b9a\u7684\u4e86\uff0c \u5728\u4e8b\u524d\uff0c\u6211\u4eec\u53ef\u80fd\u4e0d\u4f1a\u60f3\u5230\u8981\u53bb\u4e3a\u8fd9\u4e9b\u7a33\u5b9a\u4e86\u591a\u5c11\u5e74\u7684\u51fd\u6570\u5199\u51e0\u4e2aUnit Test\u3002<\/p>\n<p><strong>\u53ea\u8981\u6709\u8db3\u591f\u591a\u7684\u65f6\u95f4\uff0c\u6211\u4eec\u662f\u53ef\u4ee5\u5bf9\u6240\u6709\u7684\u529f\u80fd\u70b9\uff0c\u6240\u6709\u7684\u51fd\u6570\u90fd\u505aUT\uff0c\u4e5f\u53ef\u4ee5\u53bb\u8ffd\u6c42\u505a\u4ee3\u7801\u8986\u76d6\u548c\u5206\u652f\u8986\u76d6\u4e00\u6837\u3002\u4f46\u6709\u4e00\u70b9\u6211\u4eec\u5374\u6c38\u8fdc\u65e0\u6cd5\u505a\u5230\uff0c\u90a3\u5c31\u662f\u2014\u2014\u7a77\u4e3e\u6240\u6709\u7684\u8d1f\u9762\u6848\u4f8b<\/strong>\u3002\u6240\u4ee5\uff0c\u5bf9\u4e8e\u6d4b\u8bd5\u6765\u8bf4\uff0c\u6211\u4eec\u4e0d\u80fd\u8d70\u6781\u7aef\uff0c\u9700\u8981\u66f4\u806a\u660e\u7684\u6d4b\u8bd5\u3002\u5c31\u50cf\u6211\u5728\u300a<a title=\"\u6211\u4eec\u9700\u8981\u4e13\u804c\u7684QA\u5417\uff1f\" href=\"https:\/\/coolshell.cn\/articles\/6994.html\" target=\"_blank\">\u6211\u4eec\u9700\u8981\u4e13\u804c\u7684QA<\/a>\u300b\u6587\u7ae0\u91cc\u7684\u8bf4\u8fc7\u7684\u2014\u2014<strong>\u6d4b\u8bd5\u6bd4coding\u96be\u5ea6\u5927\u591a\u4e86\uff0c\u6d4b\u8bd5\u8fd9\u4e2a\u5de5\u4f5c\u53ea\u6709\u9ad8\u7ea7\u7684\u5f00\u53d1\u4eba\u5458\u624d\u505a\u5f97\u597d\u3002\u6211\u4ece\u6765\u4e0d\u76f8\u4fe1\u4e0d\u5199\u4ee3\u7801\u7684\u4eba\u80fd\u505a\u597d\u6d4b\u8bd5\u3002<\/strong><\/p>\n<p>\u8fd9\u91cc\uff0c<strong>\u6211\u5e76\u4e0d\u662f\u8bf4\u901a\u8fc7\u6d4b\u8bd5\u6765\u53d1\u73b0\u8fd9\u4e2a\u95ee\u9898\u7684\u53ef\u80fd\u6027\u4e0d\u5927\uff0c\u6211\u60f3\u8bf4\u7684\u662f\uff0c\u6d4b\u8bd5\u5f88\u91cd\u8981\uff0c\u5355\u6d4b\u66f4\u91cd\u8981\u3002\u4f46\u662f\uff0c\u6211\u4eec\u65e0\u6cd5\u9762\u9762\u4ff1\u5230<\/strong>\u3002\u5728\u6211\u4eec\u6ca1\u6709\u5173\u6ce8\u5230\u7684\u5730\u65b9\uff0c\u603b\u4f1a\u53d1\u751f\u611a\u8822\u7684\u9519\u8bef\u3002<\/p>\n<p>P.S.\uff0c\u5728\u5404\u5927\u7f51\u7ad9\u5bf9\u8fd9\u4e2a\u4e8b\u7684\u8ba8\u8bba\u4e2d\uff0c\u6211\u4eec\u53ef\u4ee5\u770b\u5230OS X\u4e0b\u7684curl\u547d\u4ee4\u5c45\u7136\u53ef\u4ee5\u63a5\u53d7\u4e00\u4e2a\u6ca1\u6709\u9a8c\u8bc1\u8fc7\u7684IP\u5730\u5740\u7684https\u7684\u8bf7\u6c42\uff0c\u867d\u7136\u73b0\u5728\u8fd8\u6ca1\u6709\u4eba\u77e5\u9053\u8fd9\u4e8b\u7684\u539f\u56e0\uff0c\u4f46\u662f\uff0c\u8fd9\u53ef\u80fd\u662f\u6ca1\u6709\u5728\u6d4b\u8bd5\u4e2d\u67e5\u5230\u7684\u4e00\u4e2a\u539f\u56e0\u3002<\/p>\n<h5><span class=\"ez-toc-section\" id=\"3%EF%BC%89%E5%85%B3%E4%BA%8E%E7%BC%96%E7%A0%81%E9%A3%8E%E6%A0%BC\"><\/span>3\uff09\u5173\u4e8e\u7f16\u7801\u98ce\u683c<span class=\"ez-toc-section-end\"><\/span><\/h5>\n<p><span style=\"line-height: 1.5em;\">\u5bf9\u4e8e\u7a0b\u5e8f\u5458\u6765\u8bf4\uff0c\u5728C\u8bed\u8a00\u4e2d\uff0c\u7701\u6389\u8bed\u53e5\u5927\u62ec\u53f7\u662f\u4e00\u4ef6\u975e\u5e38\u4e0d\u660e\u667a \u7684\u4e8b\u60c5\u3002\u5982\u6211\u4eec\u5f3a\u5236\u4f7f\u7528\u8bed\u53e5\u5757\u62ec\u53f7\uff0c\u90a3\u4e48\uff0c\u8fd9\u4e24\u4e2agoto fail\u90fd\u4f1a\u5728\u4e00\u4e2aif\u7684\u8bed\u53e5\u5757\u91cc\uff0c\u800c\u4e14\u4e5f\u5bb9\u6613\u7ef4\u62a4\u5e76\u4e14\u6613\u8bfb\u3002\uff08\u53e6\u5916\uff0c\u901a\u8fc7\u8fd9\u4e2abug\uff0c\u6211\u4eec\u53ef\u4ee5\u611f\u53d7\u5230\uff0c\u50cfPython\u90a3\u6837\uff0c\u7528\u7f29\u8fdb\u6765\u8868\u793a\u8bed\u53e5\u5757\uff0c\u7684\u786e\u662f\u633a\u597d\u7684\u4e00\u4ef6\u4e8b\uff09<\/span><\/p>\n<p>\u4e5f\u6709\u4eba\u8bf4\uff0c\u5982\u679c\u4f60\u786c\u8981\u7528\u53ea\u6709\u5355\u6761\u8bed\u53e5\uff0c\u4e14\u4e0d\u7528\u8bed\u53e5\u5757\u62ec\u53f7\uff0c\u90a3\u4e48\uff0c\u8fd9\u5c31\u662f\u4e00\u6761\u8bed\u53e5\uff0c\u5e94\u8be5\u653e\u5728\u540c\u4e00\u884c\u4e0a\u3002\u5982\u4e0b\u6240\u793a\uff1a<\/p>\n<p><code data-enlighter-language=\"c\" class=\"EnlighterJSRAW\">if \u00a0(check_something) \u00a0 do_something(); <\/code><\/p>\n<p>\u4f46\u662f\u8fd9\u6837\u4e00\u6765\uff0c\u4f60\u5728\u5355\u6b65\u8c03\u8bd5\u4ee3\u7801\u7684\u65f6\u5019\uff0c\u5c31\u6709\u70b9\u4e0d\u723d\u4e86\uff0c\u5f53\u4f60step over\u7684\u65f6\u5019\uff0c\u4f60\u5b8c\u5168\u4e0d\u77e5\u9053if\u7684\u6761\u4ef6\u662f\u771f\u8fd8\u662f\u5047\u3002\u6240\u4ee5\uff0c\u8fd8\u662f\u5206\u591a\u884c\uff0c\u52a0\u4e0a\u5927\u62ec\u53f7\u4f1a\u597d\u4e00\u4e9b\u3002<\/p>\n<p>\u76f8\u4f3c\u7684\u95ee\u9898\uff0c\u6211\u5f88\u5341\u591a\u5e74\u524d\u4e5f\u72af\u8fc7\uff0c\u800c\u4e14\u90a3\u6b21\u6211\u51fa\u7684\u95ee\u9898\u4e5f\u6bd4\u8f83\u5927\uff0c\u5bfc\u81f4\u4e86\u7528\u6237\u7684\u6570\u636e\u51fa\u9519\u3002\u90a3\u6b21\u5c31\u662f\u7ef4\u62a4\u522b\u4eba\u7684\u4ee3\u7801\uff0c\u522b\u4eba\u7684\u4ee3\u7801\u5c31\u662f\u6ca1\u6709if\u7684\u8bed\u53e5\u5757\u62ec\u53f7\uff0c\u5c31\u50cf\u82f9\u679c\u7684\u4ee3\u7801\u90a3\u6837\u3002<span style=\"line-height: 1.5em;\">\u6211\u60f3\u5728return z\u4e4b\u524d\u8c03\u7528\u4e00\u4e2a\u51fd\u6570\uff0c\u7ed3\u679c\u5c31\u676f\u5177\u4e86\uff1a<\/span><\/p>\n<pre data-enlighter-language=\"c\" class=\"EnlighterJSRAW\" data-enlighter-highlight=\"6\">if ( ...... )\r\n    return x;\r\nif ( ...... )\r\n    return y;\r\nif ( ...... )\r\n    foo();\r\n    return z;<\/pre>\n<p>\u8fd9\u4e2a\u9519\u8bef\u4e00\u4e0d\u5c0f\u5fc3\u5c31\u72af\u4e86\uff0c\u56e0\u4e3a\u4eba\u7684\u5927\u8111\u4f1a\u76f8\u5f53\u7136\u5730\u8ba4\u4e3a\u7f29\u8fdb\u7684\u90fd\u662f\u4e00\u4e2a\u8bed\u53e5\u5757\u91cc\u7684\u3002\u4f46\u662f\u5982\u679c\u539f\u6765\u7684\u4ee3\u7801\u90fd\u52a0\u4e0a\u4e86\u5927\u62ec\u53f7\uff0c\u7136\u540e\u628a\u7f29\u8fdb\u505a\u6b63\u5e38\uff0c\u90a3\u4e48\u5bf9\u540e\u9762\u7ef4\u62a4\u7684\u4eba\u4f1a\u662f\u4e00\u4e2a\u975e\u5e38\u597d\u7684\u4e8b\u60c5\u3002\u5c31\u4e0d\u4f1a\u72af\u6211\u8fd9\u4e2a\u4f4e\u7ea7\u9519\u8bef\u4e86\u3002\u5c31\u50cf\u4e0b\u9762\u7684\u4ee3\u7801\u4e00\u6837\uff0c\u867d\u7136\u5199\u8d77\u6765\u6709\u70b9\u7f57\u55e6\uff0c\u4f46\u5229\u4eba\u5229\u5df1\u3002<\/p>\n<pre data-enlighter-language=\"c\" class=\"EnlighterJSRAW\">if ( ...... ){\r\n    return x;\r\n}\r\nif ( ...... ){\r\n    return y;\r\n}\r\nif ( ...... ){\r\n    return z;\r\n}<\/pre>\n<p>\u4e0e\u6b64\u7c7b\u4f3c\u7684\u4ee3\u7801\u98ce\u683c\u8fd8\u6709\u5982\u4e0b\uff0c\u4f60\u89c9\u5f97\u54ea\u4e2a\u66f4\u5bb9\u6613\u9605\u8bfb\u5462\uff1f<\/p>\n<ul>\n<li>if (!p) \u00a0 \u00a0\u548c \u00a0if (p == NULL)<\/li>\n<\/ul>\n<ul>\n<li>if (p) \u00a0 \u00a0\u548c \u00a0if (p != NULL)<\/li>\n<\/ul>\n<ul>\n<li>if (!bflag) \u00a0\u548c if \u00a0(bflag == false)<\/li>\n<\/ul>\n<ul>\n<li>if ( CheckSomthing() ) \u00a0\u548c if ( CheckSomething() == true )<\/li>\n<\/ul>\n<p>\u53e6\u5916\u8fd8\u6709\u5f88\u591a\u4eba\u5728switch \u8bed\u53e5\u91cc\u7528case\u6765\u505aif\uff0c\u4e5f\u5c31\u662f\u8bf4case\u540e\u9762\u6ca1\u6709break\u3002\u5c31\u50cf<a href=\"http:\/\/en.wikipedia.org\/wiki\/Duff's_device\" target=\"_blank\">Duff&#8217;s Device<\/a>\u4e00\u6837\uff0c\u518d\u914d\u4ee5goto\uff0c\u4ee3\u7801\u5c31\u5199\u5f97\u76f8\u5f53\u7cbe\u5f69\u4e86\uff08\u8fd9\u91cc<a href=\"https:\/\/github.com\/agentzh\/luajit2\/blob\/master\/src\/host\/buildvm.c#L395\" target=\"_blank\">\u6709\u4e2a\u4f8b\u5b50<\/a>\uff09<\/p>\n<p><span style=\"line-height: 1.5em;\">\u6240\u4ee5\u8bf4\uff0c\u4ee3\u7801\u4e0d\u662f\u70ab\u9177\u7684\u5730\u65b9\u662f\u7ed9\u522b\u4eba\u8bfb\u7684\u3002<\/span><\/p>\n<p>\u53e6\u5916\uff0c\u6211\u5728\u60f3\uff0c\u4e3a\u4ec0\u4e48\u82f9\u679c\u7684\u8fd9\u6bb5\u4ee3\u7801\u4e0d\u5199\u6210\u4e0b\u9762\u8fd9\u6837\u7684\u5f62\u5f0f\uff1f\u4f60\u770b\uff0c\u4e0b\u9762\u8fd9\u79cd\u60c5\u51b5\u4e0d\u4e5f\u5f88\u5e72\u51c0\u5417\uff1f<\/p>\n<pre data-enlighter-language=\"c\" class=\"EnlighterJSRAW\">\r\nif (  ((err = ReadyHash(&amp;SSLHashSHA1, &amp;hashCtx)) != 0 )\r\n       || ((err = SSLHashSHA1.update(&amp;hashCtx, &amp;clientRandom)) != 0)\r\n       || ((err = SSLHashSHA1.update(&amp;hashCtx, &amp;serverRandom) != 0)\r\n       || ((err = SSLHashSHA1.update(&amp;hashCtx, &amp;signedParams) != 0)\r\n       || ((err = SSLHashSHA1.final(&amp;hashCtx, &amp;hashOut)) != 0)) {\r\n\r\n     goto fail;\r\n}\r\n<\/pre>\n<p>\u5176\u5b9e\uff0c\u8fd8\u53ef\u4ee5\u505a\u4e00\u4e9b\u4ee3\u7801\u4e0a\u7684\u4f18\u5316\uff0c\u6bd4\u5982\uff0c\u628afail\u6807\u7b7e\u91cc\u7684\u90a3\u4e9b\u4e1c\u897f\u5199\u6210\u4e00\u4e2a\u5b8f\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u53bb\u6389goto\u8bed\u53e5\u4e86\u3002<\/p>\n<h5><span class=\"ez-toc-section\" id=\"4%EF%BC%89%E5%85%B3%E4%BA%8Egoto%E8%AF%AD%E5%8F%A5\"><\/span>4\uff09\u5173\u4e8egoto\u8bed\u53e5<span class=\"ez-toc-section-end\"><\/span><\/h5>\n<p>\u5173\u4e8egoto\u8bed\u53e5\uff0c1968\u5e74\uff0c<a href=\"http:\/\/en.wikipedia.org\/wiki\/Edsger_Dijkstra\">Edsger Dijkstra<\/a>\u00a0\u6295\u4e86\u4e00\u7bc7\u6587\u7ae0\u5230Communications of the ACM\u3002\u539f\u672c\u7684\u6807\u9898\u662f\u300aA Case Against the Goto Statement\u300b\u3002CACM\u7f16\u8f91<a href=\"http:\/\/en.wikipedia.org\/wiki\/Niklaus_Wirth\">Niklaus Wirth<\/a>\u7075\u611f\u6765\u4e86\uff0c\u628a\u6807\u9898\u6539\u4e3a\u6211\u4eec\u719f\u77e5\u7684 \u300a<a href=\"http:\/\/www.u.arizona.edu\/~rubinson\/copyright_violations\/Go_To_Considered_Harmful.html\" target=\"_blank\">Go To\u00a0Statement Considered Harmful<\/a>\u300bDijkstra\u5199\u7684\u5185\u5bb9\u4e5f\u662f\u5176\u4e00\u8d2f\u7684\u7280\u5229\u8bed\u6c14\uff0c\u6587\u4e2d\u8bf4\uff1a\u201c\u51e0\u5e74\u524d\u6211\u5c31\u89c2\u5bdf\u5230\uff0c\u4e00\u4e2a\u7a0b\u5e8f\u5458\u7684\u54c1\u8d28\u662f\u5176\u7a0b\u5e8f\u4e2dgoto\u8bed\u53e5\u7684\u5bc6\u5ea6\u6210\u53cd\u6bd4\u7684\u201d\uff0c\u4ed6\u8fd8\u8bf4\uff0c\u201c\u540e\u6765\u6211\u53d1\u73b0\u4e86\u4e3a\u4ec0\u4e48goto\u8bed\u53e5\u7684\u4f7f\u7528\u6709\u8fd9\u4e48\u4e25\u91cd\u7684\u540e\u679c\uff0c\u5e76\u76f8\u4fe1\u6240\u6709\u9ad8\u7ea7\u8bed\u8a00\u90fd\u5e94\u8be5\u628agoto\u5e9f\u9664\u6389\u3002\u201d \u00a0\uff08<strong>\u82b1\u7d6e<\/strong>\uff1a\u56e0\u4e3a\uff0c\u8fd9\u7bc7\u6587\u7ae0\u7684\u51fa\u73b0\uff0c\u8ba1\u7b97\u5b66\u754c\u5f00\u59cb\u7528&#8217;\u00a0<a href=\"http:\/\/en.wikipedia.org\/wiki\/Considered_harmful\">X considered harmful<\/a>\u00a0&#8216;\u5f53\u6587\u7ae0\u6807\u9898\u7684\u98ce\u6f6e\uff0c\u76f4\u5230<a href=\"http:\/\/meyerweb.com\/eric\/comment\/chech.html\">\u6709\u4eba\u7ec8\u4e8e\u53d7\u4e0d\u4e86<\/a>\u4e3a\u6b62\uff09<\/p>\n<p>\u4e3a\u4ec0\u4e48goto\u8bed\u53e5\u4e0d\u597d\u5462\uff1fDijkstra\u8bf4\uff0c\u4e00\u4e2a\u53d8\u91cf\u4ee3\u8868\u4ec0\u4e48\u610f\u4e49\u8981\u770b\u5176\u4e0a\u4e0b\u6587\u3002\u4e00\u4e2a\u7a0b\u5e8f\u7528N<code><\/code>\u8bb0\u5f55\u623f\u95f4\u91cc\u7684\u4eba\u6570\uff0c\u5728\u5927\u90e8\u5206\u65f6\u5019\uff0cN<code><\/code>\u4ee3\u8868\u7684\u662f\u201c\u76ee\u524d\u623f\u95f4\u91cc\u7684\u4eba\u201d\u3002\u4f46\u5728\u89c2\u5bdf\u5230\u53c8\u6709\u4e00\u4e2a\u4eba\u8fdb\u623f\u95f4\u540e\u3001\u628aN<code><\/code>\u9012\u589e\u7684\u6307\u4ee4\u524d\u7684\u8fd9\u6bb5\u7a0b\u5e8f\u533a\u5757\u4e2d\uff0cN<code><\/code>\u7684\u503c\u4ee3\u8868\u7684\u662f\u201c\u76ee\u524d\u623f\u95f4\u91cc\u7684\u4eba\u6570\u52a0\u4e00\u201d\u3002\u56e0\u6b64\uff0c\u8981\u6b63\u786e\u8be0\u91ca\u7a0b\u5e8f\u7684\u72b6\u6001\uff0c\u5fc5\u987b\u77e5\u9053\u7a0b\u5e8f\u6267\u884c\u7684\u5386\u53f2\uff0c\u6216\u7740\u8bf4\uff0c\u77e5\u9053\u73b0\u5728\u201c\u7b97\u5230\u54ea\u201d\u4e86\u3002<\/p>\n<p>\u600e\u4e48\u8c08\u201c\u7b97\u5230\u54ea\u4e86\u201d\uff1f\u5982\u679c\u662f\u4e00\u76f4\u7ebf\u6267\u884c\u4e0b\u6765\u7684\u7a0b\u5e8f\uff0c\u6211\u4eec\u53ea\u8981\u6307\u5230\u90a3\u6761\u8bed\u53e5\uff0c\u8bf4\u201c\u5c31\u662f\u8fd9\u91cc\u201d\uff0c\u5c31\u53ef\u4ee5\u4e86\u3002\u5982\u679c\u662f\u6709\u5faa\u73af\u7a0b\u5e8f\uff0c\u6211\u4eec\u53ef\u80fd\u5f97\u8bf4\uff1a\u201c\u73b0\u5728\u5728\u5faa\u73af\u7684\u8fd9\u4e2a\u5730\u65b9\uff0c\u5faa\u73af\u5df2\u7ecf\u6267\u884c\u4e86\u7b2c<code>i<\/code>\u6b21\u201d\u3002\u5982\u679c\u662f\u5728\u51fd\u6570\u4e2d\uff0c\u6211\u4eec\u53ef\u80fd\u5f97\u8bf4\uff1a\u201c\u73b0\u5728\u6267\u884c\u5230\u51fd\u6570<code>p<\/code>\u7684\u8fd9\u4e00\u70b9\uff1b<code>p<\/code>\u521a\u521a\u88ab<code>q\u8c03\u7528<\/code>\uff0c\u8c03\u7528\u70b9\u5728\u4e00\u4e2a\u5faa\u73af\u4e2d\uff0c\u8fd9\u4e2a\u5faa\u73af\u5df2\u7ecf\u6267\u884c\u4e86<code>i<\/code>\u6b21\u201d\u3002<\/p>\n<p>\u5982\u679c\u6709goto<code>\u8bed\u53e5\u4e86<\/code>\u5462\uff1f\u90a3\u5c31\u9ebb\u70e6\u4e86\u3002\u56e0\u4e3a\u7535\u8111\u5728\u6267\u884c\u67d0\u4e2a\u6307\u4ee4\u524d\uff0c\u53ef\u80fd\u662f\u4ece\u7a0b\u5e8f\u4e2d\u8bb8\u8bb8\u591a\u591agoto<code><\/code>\u5176\u4e2d\u4e4b\u4e00\u8df3\u8fc7\u6765\u7684\u3002\u8981\u8c08\u67d0\u53d8\u91cf\u7684\u6027\u8d28\u4e5f\u51e0\u4e4e\u53d8\u5f97\u4e0d\u53ef\u80fd\u4e86\u3002\u8fd9\u5c31\u662f\u4e3a\u4ec0\u4e48goto\u8bed\u53e5\u95ee\u9898\u3002<\/p>\n<p>Dijkstra\u7684\u8fd9\u7bc7\u6587\u7ae0\u5bf9\u540e\u9762\u5f88\u591a\u7a0b\u5e8f\u5458\u6709\u975e\u5e38\u6df1\u7684\u5f71\u54cd\uff0c\u5305\u62ec\u6211\u5728\u5185\uff0c\u90fd\u89c9\u5f97Goto\u8bed\u53e5\u80fd\u4e0d\u7528\u5c31\u4e0d\u7528\uff0c\u867d\u7136\uff0c\u6211\u5728\u5341\u5e74\u524d\u7684\u300a<a href=\"http:\/\/blog.csdn.net\/haoel\/article\/month\/2003\/05\" target=\"_blank\">\u7f16\u7a0b\u4fee\u517b<\/a>\u300b\uff08\u8fd9\u7bc7\u6587\u7ae0\u5df2\u7ecf\u4e25\u91cd\u8fc7\u65f6\uff0c\u67d0\u4e9b\u6761\u76ee\u5df2\u7ecf\u6f0f\u6d1e\u767e\u51fa\uff09\u4e2d\u7684<a href=\"http:\/\/blog.csdn.net\/haoel\/article\/details\/2876\" target=\"_blank\">\u7b2c23\u6761<\/a>\u4e5f\u8bf4\u8fc7\uff0c\u6211\u53ea\u8ba4\u4e3a\u5728goto\u8bed\u53e5\u53ea\u6709\u4e00\u79cd\u60c5\u51b5\u53ef\u4ee5\u4f7f\u7528\uff0c\u5c31\u662f\u82f9\u679c\u8fd9\u4e2abug\u91cc\u7684\u7528\u6cd5\u3002\u4f46\u662f\u6211\u4e5f\u540c\u610fDijkstra\uff0cgoto\u8bed\u53e5\u80fd\u4e0d\u7528\u5c31\u4e0d\u7528\u4e86\u3002\u5c31\u82f9\u679c\u7684\u8fd9\u4e2a\u95ee\u9898\u800c\u8a00\uff0c\u5728\u66f4\u4e3a\u9ad8\u7ea7\u7684C++\u4e2d\uff0c<a href=\"http:\/\/en.wikipedia.org\/wiki\/Resource_Acquisition_Is_Initialization\" target=\"_blank\">\u4f7f\u7528RAII\u6280\u672f<\/a>\uff0c\u8fd9\u6837\u7684goto\u8bed\u53e5\u5df2\u7ecf\u6ca1\u6709\u4ec0\u4e48\u5b58\u5728\u7684\u610f\u4e49\u4e86\u3002<\/p>\n<p>Dijkstra\u8fd9\u7bc7\u6587\u7ae0\u540e\u6765\u6210\u4e3a\u7ed3\u6784\u5316\u7a0b\u5f0f\u8bba\u6218\u6700\u6709\u540d\u7684\u6587\u7ae0\u4e4b\u4e00\u3002\u957f\u8fbe19\u5e74\u4e4b\u540e\uff0cFrank Rubin\u6295\u4e86\u4e00\u7bc7\u6587\u7ae0\u5230CACM,\u6807\u9898\u4e3a\u300a<a href=\"http:\/\/www.ecn.purdue.edu\/ParaMount\/papers\/rubin87goto.pdf\">&#8216;\u00a0<code><\/code>Go To Considered Harmful&#8217; Considered Harmful<\/a>\u00a0\u300bRubin\u8bf4\uff0c\u300c\u867d\u7136Dijkstra\u7684\u8bf4\u6cd5\u65e2\u592a\u5b66\u672f\u53c8\u7f3a\u4e4f\u8bf4\u670d\u529b\u300d\uff0c\u5374\u4f3c\u4e4e\u70d9\u5230\u6bcf\u4e2a\u7a0b\u5e8f\u5458\u7684\u5fc3\u91cc\u4e86\u3002\u8fd9\u6837\uff0c\u5f53\u6709\u4eba\u8bf4\u201c\u7528goto\u8bed\u53e5\u6765\u89e3\u8fd9\u9898\u53ef\u80fd\u4f1a\u6bd4\u8f83\u597d\u201d\u4f1a\u88ab\u4e25\u91cd\u9119\u89c6\u3002\u4e8e\u662fRubin\u51fa\u4e86\u4e00\u9053\u8fd9\u6837\u7684\u9898\uff1a\u4ee4<code>X<\/code>\u4e3a<code>N * N<\/code>\u7684\u6574\u6570\u9635\u5217\u3002\u5982\u679c<code>X<\/code>\u7684\u7b2c<code>i<\/code>\u884c\u5168\u90fd\u662f\u96f6\uff0c\u8bf7\u8f93\u51fa<code>i<\/code>\u3002\u5982\u679c\u4e0d\u53ea\u4e00\u884c\uff0c\u8f93\u51fa\u6700\u5c0f\u7684<code>i<\/code>\u00a0.<\/p>\n<p>Rubin\u627e\u4e86\u4e00\u4e9b\u60ef\u7528goto\u548c\u4e0d\u7528goto\u7684\u7a0b\u5e8f\u5458\u6765\u89e3\u9898\uff0c\u53d1\u73b0\u7528goto\u7684\u7a0b\u5e8f\u53c8\u5feb\u53c8\u6e05\u695a\u3002\u800c\u4e0d\u7528goto\u901a\u5e38\u82b1\u4e86\u66f4\u591a\u7684\u65f6\u95f4\uff0c\u5199\u51fa\u5f88\u590d\u6742\u7684\u89e3\u7b54\u3002\u4f60\u89c9\u5f97\u5462\uff1f \u53e6\u5916\uff0c\u4f60\u4f1a\u600e\u4e48\u5199\u8fd9\u9898\u7684\u7a0b\u5e8f\u5462\uff1f<\/p>\n<p>\uff08<strong>\u82b1\u7d6e<\/strong>\uff1a\u4ee5\u540e\u51e0\u4e2a\u6708\u7684CACM\u70ed\u95f9\u6b7b\u4e86\u3002\u7f16\u8f91\u6536\u5230\u8bb8\u591a\u56de\u5e94\uff0c\u4e24\u4e2a\u6708\u540e\u520a\u51fa\u4e86\u5176\u4e2d\u4e94\u7bc7\u3002\u6587\u7ae0\u4e5f\u5305\u62ec\u4e86\u300a<a href=\"http:\/\/www.ecn.purdue.edu\/ParaMount\/papers\/acm_may87.pdf\">&#8220;&#8216;GOTO Considered Harmful&#8217; Considered Harmful&#8221; Considered Harmful?<\/a>\u00a0\u300b\uff09<\/p>\n<p><strong>\u5bf9\u4e8e\u6211\u800c\u8a00\uff0cgoto\u8bed\u53e5\u7684\u5f0a\u8fdc\u8fdc\u5927\u4e8e\u5229\uff0c\u572899%\u7684\u60c5\u51b5\u4e0b\uff0c\u6211\u662f\u7ad9\u5728\u53cdgoto\u8fd9\u8fb9\u7684<\/strong>\u3002Java\u548cPython\u5c31\u6ca1\u6709\u63d0\u4f9bGoto\u8bed\u53e5\uff0c\u539f\u56e0\u5c31\u662f\u56e0\u4e3agoto\u8bed\u53e5\u5f88\u5bb9\u6613\u88ab\u6ee5\u7528\uff01<\/p>\n<p><strong>\u66f4\u65b0\uff1a2014\u5e743\u67085\u65e5<\/strong> &#8211;\u00a0RedHat \u8fd1\u65e5\u4e5f\u53d1\u73b0\u4e2aGnuTLS\u5b89\u5168\u95ee\u9898\uff0c\u4e0e\u82f9\u679c\u7684\u7c7b\u4f3c\uff1a\u65e0\u6cd5\u6b63\u786e\u68c0\u9a8c\u7279\u5b9a\u7684\u4f2a\u9020SSL\u8bc1\u4e66\uff0c\u8fd9\u4e2a\u603b\u662f\u4f1a\u5c06\u4f2a\u9020\u8bc1\u4e66\u8bc6\u522b\u4e3a\u6709\u6548\u8bc1\u4e66\u3002\u867d\u7136Redhat\u7684\u4ee3\u7801\u4e3aif\u52a0\u4e0a\u4e86\u82b1\u62ec\u53f7\uff0c\u4f46\u8fd8\u662f\u56e0\u4e3a\u6ca1\u6709\u63a7\u5236\u597dgoto\uff0c\u9020\u6210\u4e86bug\u3002\u6240\u4ee5\u8bf4\u554a\uff0cgoto\u8bed\u53e5\u7684\u5751\u662f\u5f88\u591a\u3002<\/p>\n<ul>\n<li>BUG\u9875\u9762\uff1a<a href=\"https:\/\/bugzilla.redhat.com\/show_bug.cgi?id=1069865\" target=\"_blank\">https:\/\/bugzilla.redhat.com\/show_bug.cgi?id=1069865<\/a><\/li>\n<\/ul>\n<ul>\n<li>\u76f8\u5173\u7684Diff: <a href=\"https:\/\/bugzilla.redhat.com\/attachment.cgi?id=867911&amp;action=diff\" target=\"_blank\">https:\/\/bugzilla.redhat.com\/attachment.cgi?id=867911&amp;action=diff<\/a><\/li>\n<\/ul>\n<p>goto\u8bed\u53e5\u5728\u5199\u4ee3\u7801\u7684\u65f6\u5019\u4e5f\u8bb8\u4f60\u4f1a\u5f88\u723d\uff0c\u4f46\u662f\u5728\u7ef4\u62a4\u7684\u65f6\u5019\uff0c\u7edd\u5bf9\u662f\u4e00\u5806\u5751\uff01redhat\u7684\u8fd9\u4e2apatch\u4e3a\u539f\u6765\u672c\u6765\u53ea\u6709\u4e00\u4e2alabel\u7684goto\u53c8\u52a0\u4e86\u53e6\u4e00\u4e2alabel\uff0c\u73b0\u5728\u4e24\u4e2alabel\u4ea4\u5deegoto\uff0c\u7ee7\u7eed\u6316\u5751\u2026\u2026<\/p>\n<h4><span class=\"ez-toc-section\" id=\"%E6%80%BB%E7%BB%93\"><\/span>\u603b\u7ed3<span class=\"ez-toc-section-end\"><\/span><\/h4>\n<p>\u4f60\u770b\uff0c\u6211\u4eec\u4e0d\u80fd\u5b8c\u5168\u6d88\u706d\u95ee\u9898\uff0c\u4f46\u662f\uff0c\u6211\u4eec\u53ef\u4ee5\u7528\u4e0b\u9762\u51e0\u4e2a\u624b\u6bb5\u6765\u51cf\u5c11\u95ee\u9898\uff1a<\/p>\n<p style=\"padding-left: 30px;\">1\uff09<strong>\u5c3d\u91cf\u5728\u7f16\u8bd1\u4e0a\u53d1\u751f\u9519\u8bef\uff0c\u800c\u4e0d\u662f\u5728\u8fd0\u884c\u65f6<\/strong>\u3002<\/p>\n<p style=\"padding-left: 30px;\">2\uff09<strong>\u4ee3\u7801\u662f\u8ba9\u4eba\u8bfb\u7684\uff0c\u987a\u4fbf\u8ba9\u673a\u5668\u8fd0\u884c<\/strong>\u3002\u4e0d\u8981\u6015\u9ebb\u70e6\uff0c\u597d\u7684\u4ee3\u7801\u98ce\u683c\uff0c\u6613\u8bfb\u7684\u4ee3\u7801\u4f1a\u51cf\u5c11\u5f88\u591a\u95ee\u9898\u3002<\/p>\n<p style=\"padding-left: 30px;\">3\uff09<strong>Code Review\u662f\u4e00\u4ef6\u5f88\u4e25\u8083\u7684\u4e8b\u60c5<\/strong>\uff0c\u4f46 Code Reivew\u7684\u524d\u63d0\u6761\u4ef6\u662f\u4ee3\u7801\u7684\u53ef\u8bfb\u6027\u4e00\u5b9a\u8981\u5f88\u597d\u3002<\/p>\n<p style=\"padding-left: 30px;\">4\uff09<strong>\u6d4b\u8bd5\u662f\u4e00\u4ef6\u5f88\u91cd\u8981\u4e5f\u662f\u5f88\u96be\u7684\u4e8b\u60c5\uff0c\u5c24\u5176\u662f\u5f00\u53d1\u4eba\u5458\u8981\u975e\u5e38\u91cd\u89c6<\/strong>\u3002<\/p>\n<p style=\"padding-left: 30px;\">5\uff09<strong>\u4e0d\u8981\u8d70\u98de\u7ebf\uff0c\u7528\u98de\u7ebf\u6765\u89e3\u51b3\u95ee\u9898\u662f\u53ef\u803b\u7684\uff01<\/strong>\u6240\u4ee5\uff0c\u7528goto\u8bed\u53e5\u6765\u7ec4\u7ec7\u4ee3\u7801\u7684\u65f6\u4ee3\u8fc7\u53bb\u4e86\uff0c\u4f60\u53ef\u4ee5\u6709\u5f88\u591a\u79cd\u65b9\u5f0f\u4e0d\u7528goto\u4e5f\u53ef\u4ee5\u628a\u4ee3\u7801\u7ec4\u7ec7\u5f97\u5f88\u597d\u3002<\/p>\n<p>\u6700\u540e\uff0c\u6211\u5728\u6dd8\u5b9d\u8fc7\u53bb\u7684\u4e00\u5e74\u91cc\uff0c\u7ecf\u5386\u8fc7\u4e00\u4e9bP1\/P2\u6545\u969c\uff0c\u5c24\u5176\u662f\u53bb\u5e74\u76848-9\u6708\u4efd\u6545\u969c\u9891\u53d1\u7684\u6708\u4efd\uff0c\u6211\u53d1\u73b0\u5176\u4e2d\u670970%\u7684P1\/P2\u6545\u969c\uff0c\u5c31\u662f\u56e0\u4e3a\u6ca1\u6709code review\uff0c\u6ca1\u6709\u505a\u597d\u6d4b\u8bd5\uff0c\u5927\u91cf\u5730\u7528\u98de\u7ebf\u6765\u89e3\u51b3\u95ee\u9898\uff0c\u5f52\u6839\u7ed3\u5e95\u5c31\u662f\u53ea\u91cd\u4e1a\u52a1\u7ed3\u679c\uff0c\u5bf9\u6280\u672f\u6ca1\u6709\u5e94\u6709\u7684\u4e25\u8c28\u7684\u6001\u5ea6\u548c\u656c\u754f\u4e4b\u5fc3\u3002<\/p>\n<p><span style=\"color: #cc0000;\"><strong>\u6b63\u5982\u82f9\u679c\u7684\u8fd9\u4e2a\u201cgoto fail\u201d\u4e8b\u4ef6\u6240\u6697\u55bb\u7684\uff0c\u5982\u679c\u4f60\u5bf9\u6280\u672f\u6ca1\u6709\u5e94\u6709\u7684\u4e25\u8c28\u548c\u656c\u754f\u4e4b\u5fc3\uff0c\u4f60\u4e00\u5b9a\u4f1a\u2014\u2014<\/strong><\/span><\/p>\n<p style=\"text-align: center; font-size: 36px; color: #cc0000; font-family: Georgia,;\"><strong>Go To Fail !!!<\/strong><\/p>\n<p>\u5728\u8fd9\u91cc\u5520\u53e8\u8fd9\u4e48\u591a\uff0c\u4e0e\u5927\u5bb6\u5171\u52c9\uff01<\/p>\n<p>\uff08\u5168\u6587\u5b8c\uff09<\/p>\n","raw":"","protected":false},"excerpt":{"rendered":"<p>2014\u5e742\u670822\u65e5\uff0c\u5728\u8fd9\u4e2a\u201c\u8fd9\u4e48\u4e8c\u201d\u7684\u65e5\u5b50\u91cc\uff0c\u82f9\u679c\u516c\u53f8\u63a8\u9001\u4e86\u00a0iOS\u00a07.0.6\uff08\u7248\u672c\u53f711B651\uff09\u4fee\u590d\u4e86\u00a0SSL\u00a0\u8fde\u63a5\u9a8c\u8bc1\u7684\u4e00\u4e2a\u00a0bug\u3002\u5b98\u65b9\u7f51\u9875\u5728\u8fd9\u91cc\uff1a&#8230;<\/p>\n<p class=\"read-more\"><a class=\"btn btn-default\" href=\"https:\/\/coolshell.cn\/articles\/11112.html\"> Read More<span class=\"screen-reader-text\">  Read More<\/span><\/a><\/p>\n","protected":false},"author":2,"featured_media":0,"comment_status":"open","ping_status":"open","sticky":false,"template":"","format":"standard","meta":[],"categories":[5,195,15],"tags":[337,218,59,713],"series":[],"aioseo_notices":[],"views":111208,"post_thumbnail_image":"https:\/\/coolshell.cn\/wp-content\/uploads\/2014\/02\/apple_goto_fail.png","content_first_image":"https:\/\/coolshell.cn\/wp-content\/uploads\/2014\/02\/apple_goto_fail.png","post_medium_image_300":"https:\/\/coolshell.cn\/wp-content\/uploads\/2014\/02\/apple_goto_fail.png","post_thumbnail_image_624":"https:\/\/coolshell.cn\/wp-content\/uploads\/2014\/02\/apple_goto_fail.png","post_frist_image":"https:\/\/coolshell.cn\/wp-content\/uploads\/2014\/02\/apple_goto_fail.png","post_medium_image":"https:\/\/coolshell.cn\/wp-content\/uploads\/2014\/02\/apple_goto_fail.png","post_large_image":"https:\/\/coolshell.cn\/wp-content\/uploads\/2014\/02\/apple_goto_fail.png","post_full_image":"https:\/\/coolshell.cn\/wp-content\/uploads\/2014\/02\/apple_goto_fail.png","post_all_images":[{"imagesurl":"https:\/\/coolshell.cn\/wp-content\/uploads\/2014\/02\/apple_goto_fail.png","id":"image0"},{"imagesurl":"https:\/\/sslimgs.xkcd.com\/comics\/goto.png","id":"image1"},{"imagesurl":"https:\/\/coolshell.cn\/wp-content\/uploads\/2014\/02\/gotofail.jpg","id":"image2"}],"videoAdId":"","listAd":"0","listAdId":"","listAdEvery":5,"total_comments":116,"category_name":"C\/C++\u8bed\u8a00","post_date":"2014-02-24","like_count":"0","praiseWord":"\u9f13\u52b1","excitationAd":"0","rewardedVideoAdId":"","detailAdId":"","detailAd":"0","enterpriseMinapp":"0","audios":[],"postImageUrl":"http:\/\/coolshell.cn\/wp-content\/uploads\/2016\/09\/coolshell-360x200.jpg","avatarurls":[],"related_posts":[],"pageviews":111209,"pageviews_wl":29712,"ratings_average":4,"ratings_total":258,"ratings_users":57,"next_post_id":11235,"next_post_title":"\u4e00\u4e2a\u6d6e\u70b9\u6570\u8de8\u5e73\u53f0\u4ea7\u751f\u7684\u95ee\u9898","previous_post_id":10975,"previous_post_title":"\u4e00\u4e2a\u201c\u8747\u91cf\u7ea7\u201d C \u8bed\u8a00\u534f\u7a0b\u5e93"}