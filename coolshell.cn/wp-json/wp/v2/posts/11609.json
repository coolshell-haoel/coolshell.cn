{"id":11609,"date":"2014-05-28T08:20:32","date_gmt":"2014-05-28T00:20:32","guid":{"rendered":"http:\/\/coolshell.cn\/?p=11609"},"modified":"2016-07-30T21:31:41","modified_gmt":"2016-07-30T13:31:41","slug":"tcp%e7%9a%84%e9%82%a3%e4%ba%9b%e4%ba%8b%e5%84%bf%ef%bc%88%e4%b8%8b%ef%bc%89","status":"publish","type":"post","link":"https:\/\/coolshell.cn\/articles\/11609.html","title":{"rendered":"TCP \u7684\u90a3\u4e9b\u4e8b\u513f\uff08\u4e0b\uff09"},"content":{"rendered":"<p><img decoding=\"async\" loading=\"lazy\" class=\"alignright wp-image-11641\" src=\"https:\/\/coolshell.cn\/wp-content\/uploads\/2014\/05\/xin_2001040422167711230318.jpg\" alt=\"\" width=\"360\" height=\"244\" srcset=\"https:\/\/coolshell.cn\/wp-content\/uploads\/2014\/05\/xin_2001040422167711230318.jpg 400w, https:\/\/coolshell.cn\/wp-content\/uploads\/2014\/05\/xin_2001040422167711230318-300x203.jpg 300w, https:\/\/coolshell.cn\/wp-content\/uploads\/2014\/05\/xin_2001040422167711230318-399x270.jpg 399w\" sizes=\"(max-width: 360px) 100vw, 360px\" \/>\u8fd9\u7bc7\u6587\u7ae0\u662f\u4e0b\u7bc7\uff0c\u6240\u4ee5\u5982\u679c\u4f60\u5bf9TCP\u4e0d\u719f\u6089\u7684\u8bdd\uff0c\u8fd8\u8bf7\u4f60\u5148\u770b\u770b\u4e0a\u7bc7\u300a<a href=\"https:\/\/coolshell.cn\/articles\/11564.html\" target=\"_blank\">TCP\u7684\u90a3\u4e9b\u4e8b\u513f\uff08\u4e0a\uff09<\/a>\u300b \u4e0a\u7bc7\u4e2d\uff0c\u6211\u4eec\u4ecb\u7ecd\u4e86TCP\u7684\u534f\u8bae\u5934\u3001\u72b6\u6001\u673a\u3001\u6570\u636e\u91cd\u4f20\u4e2d\u7684\u4e1c\u897f\u3002\u4f46\u662fTCP\u8981\u89e3\u51b3\u4e00\u4e2a\u5f88\u5927\u7684\u4e8b\uff0c\u90a3\u5c31\u662f\u8981\u5728\u4e00\u4e2a\u7f51\u7edc\u6839\u636e\u4e0d\u540c\u7684\u60c5\u51b5\u6765\u52a8\u6001\u8c03\u6574\u81ea\u5df1\u7684\u53d1\u5305\u7684\u901f\u5ea6\uff0c\u5c0f\u5219\u8ba9\u81ea\u5df1\u7684\u8fde\u63a5\u66f4\u7a33\u5b9a\uff0c\u5927\u5219\u8ba9\u6574\u4e2a\u7f51\u7edc\u66f4\u7a33\u5b9a\u3002\u5728\u4f60\u9605\u8bfb\u4e0b\u7bc7\u4e4b\u524d\uff0c\u4f60\u9700\u8981\u505a\u597d\u51c6\u5907\uff0c\u672c\u7bc7\u6587\u7ae0\u6709\u597d\u4e9b\u7b97\u6cd5\u548c\u7b56\u7565\uff0c\u53ef\u80fd\u4f1a\u5f15\u53d1\u4f60\u7684\u5404\u79cd\u601d\u8003\uff0c\u8ba9\u4f60\u7684\u5927\u8111\u5206\u914d\u5f88\u591a\u5185\u5b58\u548c\u8ba1\u7b97\u8d44\u6e90\uff0c\u6240\u4ee5\uff0c\u4e0d\u9002\u5408\u5728\u5395\u6240\u4e2d\u9605\u8bfb\u3002<\/p>\n<div id=\"ez-toc-container\" class=\"ez-toc-v2_0_48 counter-hierarchy ez-toc-counter ez-toc-grey ez-toc-container-direction\">\n<div class=\"ez-toc-title-container\">\n<p class=\"ez-toc-title\">\u76ee\u5f55<\/p>\n<span class=\"ez-toc-title-toggle\"><\/span><\/div>\n<nav><ul class='ez-toc-list ez-toc-list-level-1 ' ><li class='ez-toc-page-1 ez-toc-heading-level-4'><a class=\"ez-toc-link ez-toc-heading-1\" href=\"https:\/\/coolshell.cn\/articles\/11609.html\/#TCP%E7%9A%84RTT%E7%AE%97%E6%B3%95\" title=\"TCP\u7684RTT\u7b97\u6cd5\">TCP\u7684RTT\u7b97\u6cd5<\/a><ul class='ez-toc-list-level-5'><li class='ez-toc-heading-level-5'><a class=\"ez-toc-link ez-toc-heading-2\" href=\"https:\/\/coolshell.cn\/articles\/11609.html\/#%E7%BB%8F%E5%85%B8%E7%AE%97%E6%B3%95\" title=\"\u7ecf\u5178\u7b97\u6cd5\">\u7ecf\u5178\u7b97\u6cd5<\/a><\/li><li class='ez-toc-page-1 ez-toc-heading-level-5'><a class=\"ez-toc-link ez-toc-heading-3\" href=\"https:\/\/coolshell.cn\/articles\/11609.html\/#Karn_Partridge_%E7%AE%97%E6%B3%95\" title=\"Karn \/ Partridge \u7b97\u6cd5\">Karn \/ Partridge \u7b97\u6cd5<\/a><\/li><li class='ez-toc-page-1 ez-toc-heading-level-5'><a class=\"ez-toc-link ez-toc-heading-4\" href=\"https:\/\/coolshell.cn\/articles\/11609.html\/#Jacobson_Karels_%E7%AE%97%E6%B3%95\" title=\"Jacobson \/ Karels \u7b97\u6cd5\">Jacobson \/ Karels \u7b97\u6cd5<\/a><\/li><\/ul><\/li><li class='ez-toc-page-1 ez-toc-heading-level-4'><a class=\"ez-toc-link ez-toc-heading-5\" href=\"https:\/\/coolshell.cn\/articles\/11609.html\/#TCP%E6%BB%91%E5%8A%A8%E7%AA%97%E5%8F%A3\" title=\"TCP\u6ed1\u52a8\u7a97\u53e3\">TCP\u6ed1\u52a8\u7a97\u53e3<\/a><ul class='ez-toc-list-level-5'><li class='ez-toc-heading-level-5'><a class=\"ez-toc-link ez-toc-heading-6\" href=\"https:\/\/coolshell.cn\/articles\/11609.html\/#Zero_Window\" title=\"Zero Window\">Zero Window<\/a><\/li><li class='ez-toc-page-1 ez-toc-heading-level-5'><a class=\"ez-toc-link ez-toc-heading-7\" href=\"https:\/\/coolshell.cn\/articles\/11609.html\/#Silly_Window_Syndrome\" title=\"Silly Window Syndrome\">Silly Window Syndrome<\/a><\/li><\/ul><\/li><li class='ez-toc-page-1 ez-toc-heading-level-4'><a class=\"ez-toc-link ez-toc-heading-8\" href=\"https:\/\/coolshell.cn\/articles\/11609.html\/#TCP%E7%9A%84%E6%8B%A5%E5%A1%9E%E5%A4%84%E7%90%86_%E2%80%93_Congestion_Handling\" title=\"TCP\u7684\u62e5\u585e\u5904\u7406 &#8211;\u00a0Congestion Handling\">TCP\u7684\u62e5\u585e\u5904\u7406 &#8211;\u00a0Congestion Handling<\/a><ul class='ez-toc-list-level-5'><li class='ez-toc-heading-level-5'><a class=\"ez-toc-link ez-toc-heading-9\" href=\"https:\/\/coolshell.cn\/articles\/11609.html\/#%E6%85%A2%E7%83%AD%E5%90%AF%E5%8A%A8%E7%AE%97%E6%B3%95_%E2%80%93_Slow_Start\" title=\"\u6162\u70ed\u542f\u52a8\u7b97\u6cd5 &#8211; Slow Start\">\u6162\u70ed\u542f\u52a8\u7b97\u6cd5 &#8211; Slow Start<\/a><\/li><li class='ez-toc-page-1 ez-toc-heading-level-5'><a class=\"ez-toc-link ez-toc-heading-10\" href=\"https:\/\/coolshell.cn\/articles\/11609.html\/#_%E6%8B%A5%E5%A1%9E%E9%81%BF%E5%85%8D%E7%AE%97%E6%B3%95_%E2%80%93_Congestion_Avoidance\" title=\"\u00a0\u62e5\u585e\u907f\u514d\u7b97\u6cd5 &#8211;\u00a0Congestion Avoidance\">\u00a0\u62e5\u585e\u907f\u514d\u7b97\u6cd5 &#8211;\u00a0Congestion Avoidance<\/a><\/li><li class='ez-toc-page-1 ez-toc-heading-level-5'><a class=\"ez-toc-link ez-toc-heading-11\" href=\"https:\/\/coolshell.cn\/articles\/11609.html\/#%E6%8B%A5%E5%A1%9E%E7%8A%B6%E6%80%81%E6%97%B6%E7%9A%84%E7%AE%97%E6%B3%95\" title=\"\u62e5\u585e\u72b6\u6001\u65f6\u7684\u7b97\u6cd5\">\u62e5\u585e\u72b6\u6001\u65f6\u7684\u7b97\u6cd5<\/a><\/li><li class='ez-toc-page-1 ez-toc-heading-level-5'><a class=\"ez-toc-link ez-toc-heading-12\" href=\"https:\/\/coolshell.cn\/articles\/11609.html\/#%E5%BF%AB%E9%80%9F%E6%81%A2%E5%A4%8D%E7%AE%97%E6%B3%95_%E2%80%93_Fast_Recovery\" title=\"\u5feb\u901f\u6062\u590d\u7b97\u6cd5 &#8211; Fast Recovery\">\u5feb\u901f\u6062\u590d\u7b97\u6cd5 &#8211; Fast Recovery<\/a><\/li><li class='ez-toc-page-1 ez-toc-heading-level-5'><a class=\"ez-toc-link ez-toc-heading-13\" href=\"https:\/\/coolshell.cn\/articles\/11609.html\/#%E7%AE%97%E6%B3%95%E7%A4%BA%E6%84%8F%E5%9B%BE\" title=\"\u7b97\u6cd5\u793a\u610f\u56fe\">\u7b97\u6cd5\u793a\u610f\u56fe<\/a><\/li><li class='ez-toc-page-1 ez-toc-heading-level-5'><a class=\"ez-toc-link ez-toc-heading-14\" href=\"https:\/\/coolshell.cn\/articles\/11609.html\/#FACK%E7%AE%97%E6%B3%95\" title=\"FACK\u7b97\u6cd5\">FACK\u7b97\u6cd5<\/a><\/li><\/ul><\/li><li class='ez-toc-page-1 ez-toc-heading-level-4'><a class=\"ez-toc-link ez-toc-heading-15\" href=\"https:\/\/coolshell.cn\/articles\/11609.html\/#%E5%85%B6%E5%AE%83%E6%8B%A5%E5%A1%9E%E6%8E%A7%E5%88%B6%E7%AE%97%E6%B3%95%E7%AE%80%E4%BB%8B\" title=\"\u5176\u5b83\u62e5\u585e\u63a7\u5236\u7b97\u6cd5\u7b80\u4ecb\">\u5176\u5b83\u62e5\u585e\u63a7\u5236\u7b97\u6cd5\u7b80\u4ecb<\/a><ul class='ez-toc-list-level-5'><li class='ez-toc-heading-level-5'><a class=\"ez-toc-link ez-toc-heading-16\" href=\"https:\/\/coolshell.cn\/articles\/11609.html\/#TCP_Vegas_%E6%8B%A5%E5%A1%9E%E6%8E%A7%E5%88%B6%E7%AE%97%E6%B3%95\" title=\"TCP Vegas \u62e5\u585e\u63a7\u5236\u7b97\u6cd5\">TCP Vegas \u62e5\u585e\u63a7\u5236\u7b97\u6cd5<\/a><\/li><li class='ez-toc-page-1 ez-toc-heading-level-5'><a class=\"ez-toc-link ez-toc-heading-17\" href=\"https:\/\/coolshell.cn\/articles\/11609.html\/#HSTCPHigh_Speed_TCP_%E7%AE%97%E6%B3%95\" title=\"HSTCP(High Speed TCP) \u7b97\u6cd5\">HSTCP(High Speed TCP) \u7b97\u6cd5<\/a><\/li><li class='ez-toc-page-1 ez-toc-heading-level-5'><a class=\"ez-toc-link ez-toc-heading-18\" href=\"https:\/\/coolshell.cn\/articles\/11609.html\/#_TCP_BIC_%E7%AE%97%E6%B3%95\" title=\"\u00a0TCP BIC \u7b97\u6cd5\">\u00a0TCP BIC \u7b97\u6cd5<\/a><\/li><li class='ez-toc-page-1 ez-toc-heading-level-5'><a class=\"ez-toc-link ez-toc-heading-19\" href=\"https:\/\/coolshell.cn\/articles\/11609.html\/#TCP_WestWood%E7%AE%97%E6%B3%95\" title=\"TCP WestWood\u7b97\u6cd5\">TCP WestWood\u7b97\u6cd5<\/a><\/li><li class='ez-toc-page-1 ez-toc-heading-level-5'><a class=\"ez-toc-link ez-toc-heading-20\" href=\"https:\/\/coolshell.cn\/articles\/11609.html\/#%E5%85%B6%E5%AE%83\" title=\"\u5176\u5b83\">\u5176\u5b83<\/a><\/li><\/ul><\/li><li class='ez-toc-page-1 ez-toc-heading-level-4'><a class=\"ez-toc-link ez-toc-heading-21\" href=\"https:\/\/coolshell.cn\/articles\/11609.html\/#_%E5%90%8E%E8%AE%B0\" title=\"\u00a0\u540e\u8bb0\">\u00a0\u540e\u8bb0<\/a><\/li><\/ul><\/nav><\/div>\n<h4><span class=\"ez-toc-section\" id=\"TCP%E7%9A%84RTT%E7%AE%97%E6%B3%95\"><\/span>TCP\u7684RTT\u7b97\u6cd5<span class=\"ez-toc-section-end\"><\/span><\/h4>\n<p>\u4ece\u524d\u9762\u7684TCP\u91cd\u4f20\u673a\u5236\u6211\u4eec\u77e5\u9053Timeout\u7684\u8bbe\u7f6e\u5bf9\u4e8e\u91cd\u4f20\u975e\u5e38\u91cd\u8981\u3002<\/p>\n<ul>\n<li>\u8bbe\u957f\u4e86\uff0c\u91cd\u53d1\u5c31\u6162\uff0c\u4e22\u4e86\u8001\u534a\u5929\u624d\u91cd\u53d1\uff0c\u6ca1\u6709\u6548\u7387\uff0c\u6027\u80fd\u5dee\uff1b<\/li>\n<li>\u8bbe\u77ed\u4e86\uff0c\u4f1a\u5bfc\u81f4\u53ef\u80fd\u5e76\u6ca1\u6709\u4e22\u5c31\u91cd\u53d1\u3002\u4e8e\u662f\u91cd\u53d1\u7684\u5c31\u5feb\uff0c\u4f1a\u589e\u52a0\u7f51\u7edc\u62e5\u585e\uff0c\u5bfc\u81f4\u66f4\u591a\u7684\u8d85\u65f6\uff0c\u66f4\u591a\u7684\u8d85\u65f6\u5bfc\u81f4\u66f4\u591a\u7684\u91cd\u53d1\u3002<\/li>\n<\/ul>\n<p>\u800c\u4e14\uff0c\u8fd9\u4e2a\u8d85\u65f6\u65f6\u95f4\u5728\u4e0d\u540c\u7684\u7f51\u7edc\u7684\u60c5\u51b5\u4e0b\uff0c\u6839\u672c\u6ca1\u6709\u529e\u6cd5\u8bbe\u7f6e\u4e00\u4e2a\u6b7b\u7684\u503c\u3002\u53ea\u80fd\u52a8\u6001\u5730\u8bbe\u7f6e\u3002 \u4e3a\u4e86\u52a8\u6001\u5730\u8bbe\u7f6e\uff0cTCP\u5f15\u5165\u4e86RTT\u2014\u2014Round Trip Time\uff0c\u4e5f\u5c31\u662f\u4e00\u4e2a\u6570\u636e\u5305\u4ece\u53d1\u51fa\u53bb\u5230\u56de\u6765\u7684\u65f6\u95f4\u3002\u8fd9\u6837\u53d1\u9001\u7aef\u5c31\u5927\u7ea6\u77e5\u9053\u9700\u8981\u591a\u5c11\u7684\u65f6\u95f4\uff0c\u4ece\u800c\u53ef\u4ee5\u65b9\u4fbf\u5730\u8bbe\u7f6eTimeout\u2014\u2014RTO\uff08Retransmission TimeOut\uff09\uff0c\u4ee5\u8ba9\u6211\u4eec\u7684\u91cd\u4f20\u673a\u5236\u66f4\u9ad8\u6548\u3002 \u542c\u8d77\u6765\u4f3c\u4e4e\u5f88\u7b80\u5355\uff0c\u597d\u50cf\u5c31\u662f\u5728\u53d1\u9001\u7aef\u53d1\u5305\u65f6\u8bb0\u4e0bt0\uff0c\u7136\u540e\u63a5\u6536\u7aef\u518d\u628a\u8fd9\u4e2aack\u56de\u6765\u65f6\u518d\u8bb0\u4e00\u4e2at1\uff0c\u4e8e\u662fRTT = t1 &#8211; t0\u3002\u6ca1\u90a3\u4e48\u7b80\u5355\uff0c\u8fd9\u53ea\u662f\u4e00\u4e2a\u91c7\u6837\uff0c\u4e0d\u80fd\u4ee3\u8868\u666e\u904d\u60c5\u51b5\u3002<\/p>\n<p><!--more--><\/p>\n<h5><span class=\"ez-toc-section\" id=\"%E7%BB%8F%E5%85%B8%E7%AE%97%E6%B3%95\"><\/span>\u7ecf\u5178\u7b97\u6cd5<span class=\"ez-toc-section-end\"><\/span><\/h5>\n<p><a href=\"http:\/\/tools.ietf.org\/html\/rfc793\" target=\"_blank\">RFC793<\/a>\u00a0\u4e2d\u5b9a\u4e49\u7684\u7ecf\u5178\u7b97\u6cd5\u662f\u8fd9\u6837\u7684\uff1a<\/p>\n<p style=\"padding-left: 30px;\">1\uff09\u9996\u5148\uff0c\u5148\u91c7\u6837RTT\uff0c\u8bb0\u4e0b\u6700\u8fd1\u597d\u51e0\u6b21\u7684RTT\u503c\u3002<\/p>\n<p style=\"padding-left: 30px;\">2\uff09\u7136\u540e\u505a\u5e73\u6ed1\u8ba1\u7b97SRTT\uff08 Smoothed RTT\uff09\u3002\u516c\u5f0f\u4e3a\uff1a\uff08\u5176\u4e2d\u7684 \u03b1 \u53d6\u503c\u57280.8 \u5230 0.9\u4e4b\u95f4\uff0c\u8fd9\u4e2a\u7b97\u6cd5\u82f1\u6587\u53ebExponential weighted moving average\uff0c\u4e2d\u6587\u53eb\uff1a\u52a0\u6743\u79fb\u52a8\u5e73\u5747\uff09<\/p>\n<p style=\"text-align: center;\"><strong>SRTT =\u00a0( \u03b1 * SRTT ) + ((1- \u03b1) * RTT)<\/strong><\/p>\n<p style=\"padding-left: 30px;\">3\uff09\u5f00\u59cb\u8ba1\u7b97RTO\u3002\u516c\u5f0f\u5982\u4e0b\uff1a<\/p>\n<p style=\"text-align: center;\"><strong>RTO = min [ UBOUND, \u00a0max [ LBOUND, \u00a0 (\u03b2 * SRTT) ] \u00a0]<\/strong><\/p>\n<p>\u5176\u4e2d\uff1a<\/p>\n<ul>\n<li>UBOUND\u662f\u6700\u5927\u7684timeout\u65f6\u95f4\uff0c\u4e0a\u9650\u503c<\/li>\n<li>LBOUND\u662f\u6700\u5c0f\u7684timeout\u65f6\u95f4\uff0c\u4e0b\u9650\u503c<\/li>\n<li>\u03b2 \u503c\u4e00\u822c\u57281.3\u52302.0\u4e4b\u95f4\u3002<\/li>\n<\/ul>\n<h5><span class=\"ez-toc-section\" id=\"Karn_Partridge_%E7%AE%97%E6%B3%95\"><\/span>Karn \/ Partridge \u7b97\u6cd5<span class=\"ez-toc-section-end\"><\/span><\/h5>\n<p>\u4f46\u662f\u4e0a\u9762\u7684\u8fd9\u4e2a\u7b97\u6cd5\u5728\u91cd\u4f20\u7684\u65f6\u5019\u4f1a\u51fa\u6709\u4e00\u4e2a\u7ec8\u6781\u95ee\u9898\u2014\u2014\u4f60\u662f\u7528\u7b2c\u4e00\u6b21\u53d1\u6570\u636e\u7684\u65f6\u95f4\u548cack\u56de\u6765\u7684\u65f6\u95f4\u505aRTT\u6837\u672c\u503c\uff0c\u8fd8\u662f\u7528\u91cd\u4f20\u7684\u65f6\u95f4\u548cACK\u56de\u6765\u7684\u65f6\u95f4\u505aRTT\u6837\u672c\u503c\uff1f<\/p>\n<p>\u8fd9\u4e2a\u95ee\u9898\u65e0\u8bba\u4f60\u9009\u90a3\u5934\u90fd\u662f\u6309\u4e0b\u846b\u82a6\u8d77\u4e86\u74e2\u3002 \u5982\u4e0b\u56fe\u6240\u793a\uff1a<\/p>\n<ul>\n<li>\u60c5\u51b5\uff08a\uff09\u662fack\u6ca1\u56de\u6765\uff0c\u6240\u4ee5\u91cd\u4f20\u3002\u5982\u679c\u4f60\u8ba1\u7b97\u7b2c\u4e00\u6b21\u53d1\u9001\u548cACK\u7684\u65f6\u95f4\uff0c\u90a3\u4e48\uff0c\u660e\u663e\u7b97\u5927\u4e86\u3002<\/li>\n<li>\u60c5\u51b5\uff08b\uff09\u662fack\u56de\u6765\u6162\u4e86\uff0c\u4f46\u662f\u5bfc\u81f4\u4e86\u91cd\u4f20\uff0c\u4f46\u521a\u91cd\u4f20\u4e0d\u4e00\u4f1a\u513f\uff0c\u4e4b\u524dACK\u5c31\u56de\u6765\u4e86\u3002\u5982\u679c\u4f60\u662f\u7b97\u91cd\u4f20\u7684\u65f6\u95f4\u548cACK\u56de\u6765\u7684\u65f6\u95f4\u7684\u5dee\uff0c\u5c31\u4f1a\u7b97\u77ed\u4e86\u3002<\/li>\n<\/ul>\n<p><img decoding=\"async\" loading=\"lazy\" class=\"aligncenter wp-image-11605\" src=\"https:\/\/coolshell.cn\/wp-content\/uploads\/2014\/05\/Karn-Partridge-Algorithm.jpg\" alt=\"\" width=\"545\" height=\"243\" srcset=\"https:\/\/coolshell.cn\/wp-content\/uploads\/2014\/05\/Karn-Partridge-Algorithm.jpg 745w, https:\/\/coolshell.cn\/wp-content\/uploads\/2014\/05\/Karn-Partridge-Algorithm-300x133.jpg 300w\" sizes=\"(max-width: 545px) 100vw, 545px\" \/><\/p>\n<p>\u6240\u4ee51987\u5e74\u7684\u65f6\u5019\uff0c\u641e\u4e86\u4e00\u4e2a\u53eb<a href=\"http:\/\/en.wikipedia.org\/wiki\/Karn's_Algorithm\" target=\"_blank\">Karn \/ Partridge Algorithm<\/a>\uff0c\u8fd9\u4e2a\u7b97\u6cd5\u7684\u6700\u5927\u7279\u70b9\u662f\u2014\u2014<strong>\u5ffd\u7565\u91cd\u4f20\uff0c\u4e0d\u628a\u91cd\u4f20\u7684RTT\u505a\u91c7\u6837<\/strong>\uff08\u4f60\u770b\uff0c\u4f60\u4e0d\u9700\u8981\u53bb\u89e3\u51b3\u4e0d\u5b58\u5728\u7684\u95ee\u9898\uff09\u3002<\/p>\n<p>\u4f46\u662f\uff0c\u8fd9\u6837\u4e00\u6765\uff0c\u53c8\u4f1a\u5f15\u53d1\u4e00\u4e2a\u5927BUG\u2014\u2014<strong>\u5982\u679c\u5728\u67d0\u4e00\u65f6\u95f4\uff0c\u7f51\u7edc\u95ea\u52a8\uff0c\u7a81\u7136\u53d8\u6162\u4e86\uff0c\u4ea7\u751f\u4e86\u6bd4\u8f83\u5927\u7684\u5ef6\u65f6\uff0c\u8fd9\u4e2a\u5ef6\u65f6\u5bfc\u81f4\u8981\u91cd\u8f6c\u6240\u6709\u7684\u5305\uff08\u56e0\u4e3a\u4e4b\u524d\u7684RTO\u5f88\u5c0f\uff09\uff0c\u4e8e\u662f\uff0c\u56e0\u4e3a\u91cd\u8f6c\u7684\u4e0d\u7b97\uff0c\u6240\u4ee5\uff0cRTO\u5c31\u4e0d\u4f1a\u88ab\u66f4\u65b0\uff0c\u8fd9\u662f\u4e00\u4e2a\u707e\u96be<\/strong>\u3002 \u4e8e\u662fKarn\u7b97\u6cd5\u7528\u4e86\u4e00\u4e2a\u53d6\u5de7\u7684\u65b9\u5f0f\u2014\u2014\u53ea\u8981\u4e00\u53d1\u751f\u91cd\u4f20\uff0c\u5c31\u5bf9\u73b0\u6709\u7684RTO\u503c\u7ffb\u500d\uff08\u8fd9\u5c31\u662f\u6240\u8c13\u7684\u00a0Exponential backoff\uff09\uff0c\u5f88\u660e\u663e\uff0c\u8fd9\u79cd\u6b7b\u89c4\u77e9\u5bf9\u4e8e\u4e00\u4e2a\u9700\u8981\u4f30\u8ba1\u6bd4\u8f83\u51c6\u786e\u7684RTT\u4e5f\u4e0d\u9760\u8c31\u3002<\/p>\n<h5><span class=\"ez-toc-section\" id=\"Jacobson_Karels_%E7%AE%97%E6%B3%95\"><\/span>Jacobson \/ Karels \u7b97\u6cd5<span class=\"ez-toc-section-end\"><\/span><\/h5>\n<p>\u524d\u9762\u4e24\u79cd\u7b97\u6cd5\u7528\u7684\u90fd\u662f\u201c\u52a0\u6743\u79fb\u52a8\u5e73\u5747\u201d\uff0c\u8fd9\u79cd\u65b9\u6cd5\u6700\u5927\u7684\u6bdb\u75c5\u5c31\u662f\u5982\u679cRTT\u6709\u4e00\u4e2a\u5927\u7684\u6ce2\u52a8\u7684\u8bdd\uff0c\u5f88\u96be\u88ab\u53d1\u73b0\uff0c\u56e0\u4e3a\u88ab\u5e73\u6ed1\u6389\u4e86\u3002\u6240\u4ee5\uff0c1988\u5e74\uff0c\u53c8\u6709\u4eba\u63a8\u51fa\u6765\u4e86\u4e00\u4e2a\u65b0\u7684\u7b97\u6cd5\uff0c\u8fd9\u4e2a\u7b97\u6cd5\u53ebJacobson \/ Karels Algorithm\uff08\u53c2\u770b<a href=\"http:\/\/tools.ietf.org\/html\/rfc6298\" target=\"_blank\">RFC6289<\/a>\uff09\u3002\u8fd9\u4e2a\u7b97\u6cd5\u5f15\u5165\u4e86\u6700\u65b0\u7684RTT\u7684\u91c7\u6837\u548c\u5e73\u6ed1\u8fc7\u7684SRTT\u7684\u5dee\u8ddd\u505a\u56e0\u5b50\u6765\u8ba1\u7b97\u3002 \u516c\u5f0f\u5982\u4e0b\uff1a\uff08\u5176\u4e2d\u7684DevRTT\u662fDeviation RTT\u7684\u610f\u601d\uff09<\/p>\n<p style=\"padding-left: 30px;\"><b>SRTT<\/b><b>\u00a0= S<\/b><b>RTT<\/b><b>\u00a0+ \u03b1<\/b><b>\u00a0<\/b><b>(<\/b><b>RTT<\/b><b>\u00a0\u2013 S<\/b><b>RTT<\/b><b>) \u00a0<\/b>\u2014\u2014 \u8ba1\u7b97\u5e73\u6ed1RTT<\/p>\n<p style=\"padding-left: 30px;\"><b>DevRTT<\/b><b>\u00a0= (1-\u03b2<\/b><b>)*<\/b><b>DevRTT<\/b><b>\u00a0+ \u03b2<\/b><b>*(|<\/b><b>RTT-SRTT<\/b><b>|) <\/b>\u2014\u2014\u8ba1\u7b97\u5e73\u6ed1RTT\u548c\u771f\u5b9e\u7684\u5dee\u8ddd\uff08\u52a0\u6743\u79fb\u52a8\u5e73\u5747\uff09<\/p>\n<p style=\"padding-left: 30px;\"><strong>RTO= \u00b5 *\u00a0SRTT + \u2202 *DevRTT <\/strong>\u2014\u2014 \u795e\u4e00\u6837\u7684\u516c\u5f0f<\/p>\n<p>\uff08\u5176\u4e2d\uff1a\u5728Linux\u4e0b\uff0c\u03b1 = 0.125\uff0c\u03b2 = 0.25\uff0c \u03bc = 1\uff0c\u2202\u00a0= 4 \u2014\u2014\u8fd9\u5c31\u662f\u7b97\u6cd5\u4e2d\u7684\u201c\u8c03\u5f97\u4e00\u624b\u597d\u53c2\u6570\u201d\uff0cnobody knows why, it just works&#8230;\uff09 \u6700\u540e\u7684\u8fd9\u4e2a\u7b97\u6cd5\u5728\u88ab\u7528\u5728\u4eca\u5929\u7684TCP\u534f\u8bae\u4e2d\uff08Linux\u7684\u6e90\u4ee3\u7801\u5728\uff1a<a href=\"http:\/\/lxr.free-electrons.com\/source\/net\/ipv4\/tcp_input.c?v=2.6.32#L609\" target=\"_blank\">tcp_rtt_estimator<\/a>\uff09\u3002<\/p>\n<h4><span class=\"ez-toc-section\" id=\"TCP%E6%BB%91%E5%8A%A8%E7%AA%97%E5%8F%A3\"><\/span>TCP\u6ed1\u52a8\u7a97\u53e3<span class=\"ez-toc-section-end\"><\/span><\/h4>\n<p>\u9700\u8981\u8bf4\u660e\u4e00\u4e0b\uff0c\u5982\u679c\u4f60\u4e0d\u4e86\u89e3TCP\u7684\u6ed1\u52a8\u7a97\u53e3\u8fd9\u4e2a\u4e8b\uff0c\u4f60\u7b49\u4e8e\u4e0d\u4e86\u89e3TCP\u534f\u8bae\u3002\u6211\u4eec\u90fd\u77e5\u9053\uff0c<strong>TCP\u5fc5\u9700\u8981\u89e3\u51b3\u7684\u53ef\u9760\u4f20\u8f93\u4ee5\u53ca\u5305\u4e71\u5e8f\uff08reordering\uff09\u7684\u95ee\u9898<\/strong>\uff0c\u6240\u4ee5\uff0cTCP\u5fc5\u9700\u8981\u77e5\u9053\u7f51\u7edc\u5b9e\u9645\u7684\u6570\u636e\u5904\u7406\u5e26\u5bbd\u6216\u662f\u6570\u636e\u5904\u7406\u901f\u5ea6\uff0c\u8fd9\u6837\u624d\u4e0d\u4f1a\u5f15\u8d77\u7f51\u7edc\u62e5\u585e\uff0c\u5bfc\u81f4\u4e22\u5305\u3002<\/p>\n<p>\u6240\u4ee5\uff0cTCP\u5f15\u5165\u4e86\u4e00\u4e9b\u6280\u672f\u548c\u8bbe\u8ba1\u6765\u505a\u7f51\u7edc\u6d41\u63a7\uff0cSliding Window\u662f\u5176\u4e2d\u4e00\u4e2a\u6280\u672f\u3002 \u524d\u9762\u6211\u4eec\u8bf4\u8fc7\uff0c<strong>TCP\u5934\u91cc\u6709\u4e00\u4e2a\u5b57\u6bb5\u53ebWindow\uff0c\u53c8\u53ebAdvertised-Window\uff0c\u8fd9\u4e2a\u5b57\u6bb5\u662f\u63a5\u6536\u7aef\u544a\u8bc9\u53d1\u9001\u7aef\u81ea\u5df1\u8fd8\u6709\u591a\u5c11\u7f13\u51b2\u533a\u53ef\u4ee5\u63a5\u6536\u6570\u636e<\/strong>\u3002<strong>\u4e8e\u662f\u53d1\u9001\u7aef\u5c31\u53ef\u4ee5\u6839\u636e\u8fd9\u4e2a\u63a5\u6536\u7aef\u7684\u5904\u7406\u80fd\u529b\u6765\u53d1\u9001\u6570\u636e\uff0c\u800c\u4e0d\u4f1a\u5bfc\u81f4\u63a5\u6536\u7aef\u5904\u7406\u4e0d\u8fc7\u6765<\/strong>\u3002 \u4e3a\u4e86\u8bf4\u660e\u6ed1\u52a8\u7a97\u53e3\uff0c\u6211\u4eec\u9700\u8981\u5148\u770b\u4e00\u4e0bTCP\u7f13\u51b2\u533a\u7684\u4e00\u4e9b\u6570\u636e\u7ed3\u6784\uff1a<\/p>\n<p><img decoding=\"async\" loading=\"lazy\" class=\"aligncenter wp-image-11594\" src=\"https:\/\/coolshell.cn\/wp-content\/uploads\/2014\/05\/sliding_window.jpg\" alt=\"\" width=\"450\" height=\"179\" srcset=\"https:\/\/coolshell.cn\/wp-content\/uploads\/2014\/05\/sliding_window.jpg 906w, https:\/\/coolshell.cn\/wp-content\/uploads\/2014\/05\/sliding_window-300x119.jpg 300w, https:\/\/coolshell.cn\/wp-content\/uploads\/2014\/05\/sliding_window-900x358.jpg 900w\" sizes=\"(max-width: 450px) 100vw, 450px\" \/><\/p>\n<p>\u4e0a\u56fe\u4e2d\uff0c\u6211\u4eec\u53ef\u4ee5\u770b\u5230\uff1a<\/p>\n<ul>\n<li>\u63a5\u6536\u7aefLastByteRead\u6307\u5411\u4e86TCP\u7f13\u51b2\u533a\u4e2d\u8bfb\u5230\u7684\u4f4d\u7f6e\uff0cNextByteExpected\u6307\u5411\u7684\u5730\u65b9\u662f\u6536\u5230\u7684\u8fde\u7eed\u5305\u7684\u6700\u540e\u4e00\u4e2a\u4f4d\u7f6e\uff0cLastByteRcved\u6307\u5411\u7684\u662f\u6536\u5230\u7684\u5305\u7684\u6700\u540e\u4e00\u4e2a\u4f4d\u7f6e\uff0c\u6211\u4eec\u53ef\u4ee5\u770b\u5230\u4e2d\u95f4\u6709\u4e9b\u6570\u636e\u8fd8\u6ca1\u6709\u5230\u8fbe\uff0c\u6240\u4ee5\u6709\u6570\u636e\u7a7a\u767d\u533a\u3002<\/li>\n<\/ul>\n<ul>\n<li>\u53d1\u9001\u7aef\u7684LastByteAcked\u6307\u5411\u4e86\u88ab\u63a5\u6536\u7aefAck\u8fc7\u7684\u4f4d\u7f6e\uff08\u8868\u793a\u6210\u529f\u53d1\u9001\u786e\u8ba4\uff09\uff0cLastByteSent\u8868\u793a\u53d1\u51fa\u53bb\u4e86\uff0c\u4f46\u8fd8\u6ca1\u6709\u6536\u5230\u6210\u529f\u786e\u8ba4\u7684Ack\uff0cLastByteWritten\u6307\u5411\u7684\u662f\u4e0a\u5c42\u5e94\u7528\u6b63\u5728\u5199\u7684\u5730\u65b9\u3002<\/li>\n<\/ul>\n<p>\u4e8e\u662f\uff1a<\/p>\n<ul>\n<li>\u63a5\u6536\u7aef\u5728\u7ed9\u53d1\u9001\u7aef\u56deACK\u4e2d\u4f1a\u6c47\u62a5\u81ea\u5df1\u7684AdvertisedWindow = MaxRcvBuffer &#8211; LastByteRcvd &#8211; 1;<\/li>\n<\/ul>\n<ul>\n<li>\u800c\u53d1\u9001\u65b9\u4f1a\u6839\u636e\u8fd9\u4e2a\u7a97\u53e3\u6765\u63a7\u5236\u53d1\u9001\u6570\u636e\u7684\u5927\u5c0f\uff0c\u4ee5\u4fdd\u8bc1\u63a5\u6536\u65b9\u53ef\u4ee5\u5904\u7406\u3002<\/li>\n<\/ul>\n<p>\u4e0b\u9762\u6211\u4eec\u6765\u770b\u4e00\u4e0b\u53d1\u9001\u65b9\u7684\u6ed1\u52a8\u7a97\u53e3\u793a\u610f\u56fe\uff1a<\/p>\n<p><img decoding=\"async\" loading=\"lazy\" class=\"aligncenter size-full wp-image-11596\" src=\"https:\/\/coolshell.cn\/wp-content\/uploads\/2014\/05\/tcpswwindows.png\" alt=\"\" width=\"660\" height=\"270\" srcset=\"https:\/\/coolshell.cn\/wp-content\/uploads\/2014\/05\/tcpswwindows.png 660w, https:\/\/coolshell.cn\/wp-content\/uploads\/2014\/05\/tcpswwindows-300x122.png 300w\" sizes=\"(max-width: 660px) 100vw, 660px\" \/><\/p>\n<p style=\"text-align: center;\">\uff08<a href=\"http:\/\/www.tcpipguide.com\/free\/t_TCPSlidingWindowAcknowledgmentSystemForDataTranspo-6.htm\" target=\"_blank\">\u56fe\u7247\u6765\u6e90<\/a>\uff09<\/p>\n<p>\u4e0a\u56fe\u4e2d\u5206\u6210\u4e86\u56db\u4e2a\u90e8\u5206\uff0c\u5206\u522b\u662f\uff1a\uff08\u5176\u4e2d\u90a3\u4e2a\u9ed1\u6a21\u578b\u5c31\u662f\u6ed1\u52a8\u7a97\u53e3\uff09<\/p>\n<ul>\n<li>#1\u5df2\u6536\u5230ack\u786e\u8ba4\u7684\u6570\u636e\u3002<\/li>\n<li>#2\u53d1\u8fd8\u6ca1\u6536\u5230ack\u7684\u3002<\/li>\n<li>#3\u5728\u7a97\u53e3\u4e2d\u8fd8\u6ca1\u6709\u53d1\u51fa\u7684\uff08\u63a5\u6536\u65b9\u8fd8\u6709\u7a7a\u95f4\uff09\u3002<\/li>\n<li>#4\u7a97\u53e3\u4ee5\u5916\u7684\u6570\u636e\uff08\u63a5\u6536\u65b9\u6ca1\u7a7a\u95f4\uff09<\/li>\n<\/ul>\n<p>\u4e0b\u9762\u662f\u4e2a\u6ed1\u52a8\u540e\u7684\u793a\u610f\u56fe\uff08\u6536\u523036\u7684ack\uff0c\u5e76\u53d1\u51fa\u4e8646-51\u7684\u5b57\u8282\uff09\uff1a<\/p>\n<p><img decoding=\"async\" loading=\"lazy\" class=\"aligncenter size-full wp-image-11597\" src=\"https:\/\/coolshell.cn\/wp-content\/uploads\/2014\/05\/tcpswslide.png\" alt=\"\" width=\"660\" height=\"210\" srcset=\"https:\/\/coolshell.cn\/wp-content\/uploads\/2014\/05\/tcpswslide.png 660w, https:\/\/coolshell.cn\/wp-content\/uploads\/2014\/05\/tcpswslide-300x95.png 300w\" sizes=\"(max-width: 660px) 100vw, 660px\" \/><\/p>\n<p>\u4e0b\u9762\u6211\u4eec\u6765\u770b\u4e00\u4e2a\u63a5\u53d7\u7aef\u63a7\u5236\u53d1\u9001\u7aef\u7684\u56fe\u793a\uff1a<\/p>\n<p><img decoding=\"async\" loading=\"lazy\" class=\"aligncenter size-full wp-image-11617\" src=\"https:\/\/coolshell.cn\/wp-content\/uploads\/2014\/05\/tcpswflow.png\" alt=\"\" width=\"666\" height=\"836\" srcset=\"https:\/\/coolshell.cn\/wp-content\/uploads\/2014\/05\/tcpswflow.png 666w, https:\/\/coolshell.cn\/wp-content\/uploads\/2014\/05\/tcpswflow-238x300.png 238w\" sizes=\"(max-width: 666px) 100vw, 666px\" \/><\/p>\n<p style=\"text-align: center;\">\uff08<a href=\"http:\/\/www.tcpipguide.com\/free\/t_TCPWindowSizeAdjustmentandFlowControl-2.htm\" target=\"_blank\">\u56fe\u7247\u6765\u6e90<\/a>\uff09<\/p>\n<h5 style=\"text-align: left;\"><span class=\"ez-toc-section\" id=\"Zero_Window\"><\/span>Zero Window<span class=\"ez-toc-section-end\"><\/span><\/h5>\n<p style=\"text-align: left;\">\u4e0a\u56fe\uff0c\u6211\u4eec\u53ef\u4ee5\u770b\u5230\u4e00\u4e2a\u5904\u7406\u7f13\u6162\u7684Server\uff08\u63a5\u6536\u7aef\uff09\u662f\u600e\u4e48\u628aClient\uff08\u53d1\u9001\u7aef\uff09\u7684TCP Sliding Window\u7ed9\u964d\u62100\u7684\u3002\u6b64\u65f6\uff0c\u4f60\u4e00\u5b9a\u4f1a\u95ee\uff0c\u5982\u679cWindow\u53d8\u62100\u4e86\uff0cTCP\u4f1a\u600e\u4e48\u6837\uff1f\u662f\u4e0d\u662f\u53d1\u9001\u7aef\u5c31\u4e0d\u53d1\u6570\u636e\u4e86\uff1f\u662f\u7684\uff0c\u53d1\u9001\u7aef\u5c31\u4e0d\u53d1\u6570\u636e\u4e86\uff0c\u4f60\u53ef\u4ee5\u60f3\u50cf\u6210\u201cWindow Closed\u201d\uff0c\u90a3\u4f60\u4e00\u5b9a\u8fd8\u4f1a\u95ee\uff0c\u5982\u679c\u53d1\u9001\u7aef\u4e0d\u53d1\u6570\u636e\u4e86\uff0c\u63a5\u6536\u65b9\u4e00\u4f1a\u513fWindow size \u53ef\u7528\u4e86\uff0c\u600e\u4e48\u901a\u77e5\u53d1\u9001\u7aef\u5462\uff1f<\/p>\n<p style=\"text-align: left;\">\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\uff0cTCP\u4f7f\u7528\u4e86Zero Window Probe\u6280\u672f\uff0c\u7f29\u5199\u4e3aZWP\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0c\u53d1\u9001\u7aef\u5728\u7a97\u53e3\u53d8\u62100\u540e\uff0c\u4f1a\u53d1ZWP\u7684\u5305\u7ed9\u63a5\u6536\u65b9\uff0c\u8ba9\u63a5\u6536\u65b9\u6765ack\u4ed6\u7684Window\u5c3a\u5bf8\uff0c\u4e00\u822c\u8fd9\u4e2a\u503c\u4f1a\u8bbe\u7f6e\u62103\u6b21\uff0c\u7b2c\u6b21\u5927\u7ea630-60\u79d2\uff08\u4e0d\u540c\u7684\u5b9e\u73b0\u53ef\u80fd\u4f1a\u4e0d\u4e00\u6837\uff09\u3002\u5982\u679c3\u6b21\u8fc7\u540e\u8fd8\u662f0\u7684\u8bdd\uff0c\u6709\u7684TCP\u5b9e\u73b0\u5c31\u4f1a\u53d1RST\u628a\u94fe\u63a5\u65ad\u4e86\u3002<\/p>\n<p style=\"text-align: left;\"><strong>\u6ce8\u610f<\/strong>\uff1a\u53ea\u8981\u6709\u7b49\u5f85\u7684\u5730\u65b9\u90fd\u53ef\u80fd\u51fa\u73b0DDoS\u653b\u51fb\uff0cZero Window\u4e5f\u4e0d\u4f8b\u5916\uff0c\u4e00\u4e9b\u653b\u51fb\u8005\u4f1a\u5728\u548cHTTP\u5efa\u597d\u94fe\u53d1\u5b8cGET\u8bf7\u6c42\u540e\uff0c\u5c31\u628aWindow\u8bbe\u7f6e\u4e3a0\uff0c\u7136\u540e\u670d\u52a1\u7aef\u5c31\u53ea\u80fd\u7b49\u5f85\u8fdb\u884cZWP\uff0c\u4e8e\u662f\u653b\u51fb\u8005\u4f1a\u5e76\u53d1\u5927\u91cf\u7684\u8fd9\u6837\u7684\u8bf7\u6c42\uff0c\u628a\u670d\u52a1\u5668\u7aef\u7684\u8d44\u6e90\u8017\u5c3d\u3002\uff08\u5173\u4e8e\u8fd9\u65b9\u9762\u7684\u653b\u51fb\uff0c\u5927\u5bb6\u53ef\u4ee5\u79fb\u6b65\u770b\u4e00\u4e0b<a href=\"http:\/\/en.wikipedia.org\/wiki\/Sockstress\" target=\"_blank\">Wikipedia\u7684SockStress\u8bcd\u6761<\/a>\uff09<\/p>\n<p style=\"text-align: left;\">\u53e6\u5916\uff0cWireshark\u4e2d\uff0c\u4f60\u53ef\u4ee5\u4f7f\u7528tcp.analysis.zero_window\u6765\u8fc7\u6ee4\u5305\uff0c\u7136\u540e\u4f7f\u7528\u53f3\u952e\u83dc\u5355\u91cc\u7684follow TCP stream\uff0c\u4f60\u53ef\u4ee5\u770b\u5230ZeroWindowProbe\u53caZeroWindowProbeAck\u7684\u5305\u3002<\/p>\n<h5 style=\"text-align: left;\"><span class=\"ez-toc-section\" id=\"Silly_Window_Syndrome\"><\/span>Silly Window Syndrome<span class=\"ez-toc-section-end\"><\/span><\/h5>\n<p>Silly Window Syndrome\u7ffb\u8bd1\u6210\u4e2d\u6587\u5c31\u662f\u201c\u7cca\u6d82\u7a97\u53e3\u7efc\u5408\u75c7\u201d\u3002\u6b63\u5982\u4f60\u4e0a\u9762\u770b\u5230\u7684\u4e00\u6837\uff0c\u5982\u679c\u6211\u4eec\u7684\u63a5\u6536\u65b9\u592a\u5fd9\u4e86\uff0c\u6765\u4e0d\u53ca\u53d6\u8d70Receive Windows\u91cc\u7684\u6570\u636e\uff0c\u90a3\u4e48\uff0c\u5c31\u4f1a\u5bfc\u81f4\u53d1\u9001\u65b9\u8d8a\u6765\u8d8a\u5c0f\u3002\u5230\u6700\u540e\uff0c\u5982\u679c\u63a5\u6536\u65b9\u817e\u51fa\u51e0\u4e2a\u5b57\u8282\u5e76\u544a\u8bc9\u53d1\u9001\u65b9\u73b0\u5728\u6709\u51e0\u4e2a\u5b57\u8282\u7684window\uff0c\u800c\u6211\u4eec\u7684\u53d1\u9001\u65b9\u4f1a\u4e49\u65e0\u53cd\u987e\u5730\u53d1\u9001\u8fd9\u51e0\u4e2a\u5b57\u8282\u3002<\/p>\n<p>\u8981\u77e5\u9053\uff0c\u6211\u4eec\u7684TCP+IP\u5934\u670940\u4e2a\u5b57\u8282\uff0c\u4e3a\u4e86\u51e0\u4e2a\u5b57\u8282\uff0c\u8981\u8fbe\u4e0a\u8fd9\u4e48\u5927\u7684\u5f00\u9500\uff0c\u8fd9\u592a\u4e0d\u7ecf\u6d4e\u4e86\u3002<\/p>\n<p>\u53e6\u5916\uff0c\u4f60\u9700\u8981\u77e5\u9053\u7f51\u7edc\u4e0a\u6709\u4e2aMTU\uff0c\u5bf9\u4e8e\u4ee5\u592a\u7f51\u6765\u8bf4\uff0cMTU\u662f1500\u5b57\u8282\uff0c\u9664\u53bbTCP+IP\u5934\u768440\u4e2a\u5b57\u8282\uff0c\u771f\u6b63\u7684\u6570\u636e\u4f20\u8f93\u53ef\u4ee5\u67091460\uff0c\u8fd9\u5c31\u662f\u6240\u8c13\u7684MSS\uff08Max Segment Size\uff09\u6ce8\u610f\uff0cTCP\u7684RFC\u5b9a\u4e49\u8fd9\u4e2aMSS\u7684\u9ed8\u8ba4\u503c\u662f536\uff0c\u8fd9\u662f\u56e0\u4e3a<span style=\"color: #252525;\">\u00a0<\/span><span class=\"reference-text\" style=\"color: #252525;\"><a class=\"external mw-magiclink-rfc\" style=\"color: #663366;\" href=\"http:\/\/tools.ietf.org\/html\/rfc791\" rel=\"nofollow\">RFC 791<\/a>\u91cc\u8bf4\u4e86\u4efb\u4f55\u4e00\u4e2a<\/span>IP\u8bbe\u5907\u90fd\u5f97\u6700\u5c11\u63a5\u6536576\u5c3a\u5bf8\u7684\u5927\u5c0f\uff08\u5b9e\u9645\u4e0a\u6765\u8bf4576\u662f\u62e8\u53f7\u7684\u7f51\u7edc\u7684MTU\uff0c\u800c576\u51cf\u53bbIP\u5934\u768420\u4e2a\u5b57\u8282\u5c31\u662f536\uff09\u3002<\/p>\n<p><strong>\u5982\u679c\u4f60\u7684\u7f51\u7edc\u5305\u53ef\u4ee5\u585e\u6ee1MTU\uff0c\u90a3\u4e48\u4f60\u53ef\u4ee5\u7528\u6ee1\u6574\u4e2a\u5e26\u5bbd\uff0c\u5982\u679c\u4e0d\u80fd\uff0c\u90a3\u4e48\u4f60\u5c31\u4f1a\u6d6a\u8d39\u5e26\u5bbd<\/strong>\u3002\uff08\u5927\u4e8eMTU\u7684\u5305\u6709\u4e24\u79cd\u7ed3\u5c40\uff0c\u4e00\u79cd\u662f\u76f4\u63a5\u88ab\u4e22\u4e86\uff0c\u53e6\u4e00\u79cd\u662f\u4f1a\u88ab\u91cd\u65b0\u5206\u5757\u6253\u5305\u53d1\u9001\uff09 \u4f60\u53ef\u4ee5\u60f3\u50cf\u6210\u4e00\u4e2aMTU\u5c31\u76f8\u5f53\u4e8e\u4e00\u4e2a\u98de\u673a\u7684\u6700\u591a\u53ef\u4ee5\u88c5\u7684\u4eba\uff0c\u5982\u679c\u8fd9\u98de\u673a\u91cc\u6ee1\u8f7d\u7684\u8bdd\uff0c\u5e26\u5bbd\u6700\u9ad8\uff0c\u5982\u679c\u4e00\u4e2a\u98de\u673a\u53ea\u8fd0\u4e00\u4e2a\u4eba\u7684\u8bdd\uff0c\u65e0\u7591\u6210\u672c\u589e\u52a0\u4e86\uff0c\u4e5f\u800c\u76f8\u5f53\u4e8c\u3002<\/p>\n<p>\u6240\u4ee5\uff0c<strong>Silly Windows Syndrome\u8fd9\u4e2a\u73b0\u50cf\u5c31\u50cf\u662f\u4f60\u672c\u6765\u53ef\u4ee5\u5750200\u4eba\u7684\u98de\u673a\u91cc\u53ea\u505a\u4e86\u4e00\u4e24\u4e2a\u4eba<\/strong>\u3002 \u8981\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u4e5f\u4e0d\u96be\uff0c\u5c31\u662f\u907f\u514d\u5bf9\u5c0f\u7684window size\u505a\u51fa\u54cd\u5e94\uff0c\u76f4\u5230\u6709\u8db3\u591f\u5927\u7684window size\u518d\u54cd\u5e94\uff0c\u8fd9\u4e2a\u601d\u8def\u53ef\u4ee5\u540c\u65f6\u5b9e\u73b0\u5728sender\u548creceiver\u4e24\u7aef\u3002<\/p>\n<ul>\n<li>\u5982\u679c\u8fd9\u4e2a\u95ee\u9898\u662f\u7531Receiver\u7aef\u5f15\u8d77\u7684\uff0c\u90a3\u4e48\u5c31\u4f1a\u4f7f\u7528\u00a0David D Clark&#8217;s \u65b9\u6848\u3002\u5728receiver\u7aef\uff0c\u5982\u679c\u6536\u5230\u7684\u6570\u636e\u5bfc\u81f4window size\u5c0f\u4e8e\u67d0\u4e2a\u503c\uff0c\u53ef\u4ee5\u76f4\u63a5ack(0)\u56desender\uff0c\u8fd9\u6837\u5c31\u628awindow\u7ed9\u5173\u95ed\u4e86\uff0c\u4e5f\u963b\u6b62\u4e86sender\u518d\u53d1\u6570\u636e\u8fc7\u6765\uff0c\u7b49\u5230receiver\u7aef\u5904\u7406\u4e86\u4e00\u4e9b\u6570\u636e\u540ewindows size \u5927\u4e8e\u7b49\u4e8e\u4e86MSS\uff0c\u6216\u8005\uff0creceiver buffer\u6709\u4e00\u534a\u4e3a\u7a7a\uff0c\u5c31\u53ef\u4ee5\u628awindow\u6253\u5f00\u8ba9send \u53d1\u9001\u6570\u636e\u8fc7\u6765\u3002<\/li>\n<\/ul>\n<ul>\n<li>\u5982\u679c\u8fd9\u4e2a\u95ee\u9898\u662f\u7531Sender\u7aef\u5f15\u8d77\u7684\uff0c\u90a3\u4e48\u5c31\u4f1a\u4f7f\u7528\u8457\u540d\u7684<span style=\"color: #252525;\">\u00a0<\/span><a style=\"color: #0b0080;\" title=\"Nagle's algorithm\" href=\"http:\/\/en.wikipedia.org\/wiki\/Nagle%27s_algorithm\" target=\"_blank\">Nagle&#8217;s algorithm<\/a>\u3002\u8fd9\u4e2a\u7b97\u6cd5\u7684\u601d\u8def\u4e5f\u662f\u5ef6\u65f6\u5904\u7406\uff0c\u4ed6\u6709\u4e24\u4e2a\u4e3b\u8981\u7684\u6761\u4ef6\uff1a1\uff09\u8981\u7b49\u5230 Window Size&gt;=MSS \u6216\u662f Data Size &gt;=MSS\uff0c2\uff09\u6536\u5230\u4e4b\u524d\u53d1\u9001\u6570\u636e\u7684ack\u56de\u5305\uff0c\u4ed6\u624d\u4f1a\u53d1\u6570\u636e\uff0c\u5426\u5219\u5c31\u662f\u5728\u6512\u6570\u636e\u3002<\/li>\n<\/ul>\n<p>\u53e6\u5916\uff0cNagle\u7b97\u6cd5\u9ed8\u8ba4\u662f\u6253\u5f00\u7684\uff0c\u6240\u4ee5\uff0c\u5bf9\u4e8e\u4e00\u4e9b\u9700\u8981\u5c0f\u5305\u573a\u666f\u7684\u7a0b\u5e8f\u2014\u2014<strong>\u6bd4\u5982\u50cftelnet\u6216ssh\u8fd9\u6837\u7684\u4ea4\u4e92\u6027\u6bd4\u8f83\u5f3a\u7684\u7a0b\u5e8f\uff0c\u4f60\u9700\u8981\u5173\u95ed\u8fd9\u4e2a\u7b97\u6cd5<\/strong>\u3002\u4f60\u53ef\u4ee5\u5728Socket\u8bbe\u7f6eTCP_NODELAY\u9009\u9879\u6765\u5173\u95ed\u8fd9\u4e2a\u7b97\u6cd5\uff08\u5173\u95edNagle\u7b97\u6cd5\u6ca1\u6709\u5168\u5c40\u53c2\u6570\uff0c\u9700\u8981\u6839\u636e\u6bcf\u4e2a\u5e94\u7528\u81ea\u5df1\u7684\u7279\u70b9\u6765\u5173\u95ed\uff09<\/p>\n<p><code data-enlighter-language=\"c\" class=\"EnlighterJSRAW\">setsockopt(sock_fd, IPPROTO_TCP, TCP_NODELAY, (char *)&amp;value,sizeof(int));<\/code><\/p>\n<p>\u53e6\u5916\uff0c\u7f51\u4e0a\u6709\u4e9b\u6587\u7ae0\u8bf4<span style=\"color: #000000;\">TCP_CORK\u7684socket option\u662f\u4e5f\u5173\u95edNagle\u7b97\u6cd5\uff0c\u8fd9\u4e0d\u5bf9\u3002<strong>TCP_CORK\u5176\u5b9e\u662f\u66f4\u65b0\u6fc0\u8fdb\u7684Nagle\u7b97\u6c49\uff0c\u5b8c\u5168\u7981\u6b62\u5c0f\u5305\u53d1\u9001\uff0c\u800cNagle\u7b97\u6cd5\u6ca1\u6709\u7981\u6b62\u5c0f\u5305\u53d1\u9001\uff0c\u53ea\u662f\u7981\u6b62\u4e86\u5927\u91cf\u7684\u5c0f\u5305\u53d1\u9001<\/strong>\u3002\u6700\u597d\u4e0d\u8981\u4e24\u4e2a\u9009\u9879\u90fd\u8bbe\u7f6e\u3002<\/span><\/p>\n<h4><span class=\"ez-toc-section\" id=\"TCP%E7%9A%84%E6%8B%A5%E5%A1%9E%E5%A4%84%E7%90%86_%E2%80%93_Congestion_Handling\"><\/span>TCP\u7684\u62e5\u585e\u5904\u7406 &#8211;\u00a0Congestion Handling<span class=\"ez-toc-section-end\"><\/span><\/h4>\n<p>\u4e0a\u9762\u6211\u4eec\u77e5\u9053\u4e86\uff0cTCP\u901a\u8fc7Sliding Window\u6765\u505a\u6d41\u63a7\uff08Flow Control\uff09\uff0c\u4f46\u662fTCP\u89c9\u5f97\u8fd9\u8fd8\u4e0d\u591f\uff0c\u56e0\u4e3aSliding Window\u9700\u8981\u4f9d\u8d56\u4e8e\u8fde\u63a5\u7684\u53d1\u9001\u7aef\u548c\u63a5\u6536\u7aef\uff0c\u5176\u5e76\u4e0d\u77e5\u9053\u7f51\u7edc\u4e2d\u95f4\u53d1\u751f\u4e86\u4ec0\u4e48\u3002TCP\u7684\u8bbe\u8ba1\u8005\u89c9\u5f97\uff0c\u4e00\u4e2a\u4f1f\u5927\u800c\u725b\u903c\u7684\u534f\u8bae\u4ec5\u4ec5\u505a\u5230\u6d41\u63a7\u5e76\u4e0d\u591f\uff0c\u56e0\u4e3a\u6d41\u63a7\u53ea\u662f\u7f51\u7edc\u6a21\u578b4\u5c42\u4ee5\u4e0a\u7684\u4e8b\uff0cTCP\u7684\u8fd8\u5e94\u8be5\u66f4\u806a\u660e\u5730\u77e5\u9053\u6574\u4e2a\u7f51\u7edc\u4e0a\u7684\u4e8b\u3002<\/p>\n<p>\u5177\u4f53\u4e00\u70b9\uff0c\u6211\u4eec\u77e5\u9053TCP\u901a\u8fc7\u4e00\u4e2atimer\u91c7\u6837\u4e86RTT\u5e76\u8ba1\u7b97RTO\uff0c\u4f46\u662f\uff0c<strong>\u5982\u679c\u7f51\u7edc\u4e0a\u7684\u5ef6\u65f6\u7a81\u7136\u589e\u52a0\uff0c\u90a3\u4e48\uff0cTCP\u5bf9\u8fd9\u4e2a\u4e8b\u505a\u51fa\u7684\u5e94\u5bf9\u53ea\u6709\u91cd\u4f20\u6570\u636e\uff0c\u4f46\u662f\uff0c\u91cd\u4f20\u4f1a\u5bfc\u81f4\u7f51\u7edc\u7684\u8d1f\u62c5\u66f4\u91cd\uff0c\u4e8e\u662f\u4f1a\u5bfc\u81f4\u66f4\u5927\u7684\u5ef6\u8fdf\u4ee5\u53ca\u66f4\u591a\u7684\u4e22\u5305\uff0c\u4e8e\u662f\uff0c\u8fd9\u4e2a\u60c5\u51b5\u5c31\u4f1a\u8fdb\u5165\u6076\u6027\u5faa\u73af\u88ab\u4e0d\u65ad\u5730\u653e\u5927\u3002\u8bd5\u60f3\u4e00\u4e0b\uff0c\u5982\u679c\u4e00\u4e2a\u7f51\u7edc\u5185\u6709\u6210\u5343\u4e0a\u4e07\u7684TCP\u8fde\u63a5\u90fd\u8fd9\u4e48\u884c\u4e8b\uff0c\u90a3\u4e48\u9a6c\u4e0a\u5c31\u4f1a\u5f62\u6210\u201c\u7f51\u7edc\u98ce\u66b4\u201d\uff0cTCP\u8fd9\u4e2a\u534f\u8bae\u5c31\u4f1a\u62d6\u57ae\u6574\u4e2a\u7f51\u7edc\u3002<\/strong>\u8fd9\u662f\u4e00\u4e2a\u707e\u96be\u3002<\/p>\n<p>\u6240\u4ee5\uff0cTCP\u4e0d\u80fd\u5ffd\u7565\u7f51\u7edc\u4e0a\u53d1\u751f\u7684\u4e8b\u60c5\uff0c\u800c\u65e0\u8111\u5730\u4e00\u4e2a\u52b2\u5730\u91cd\u53d1\u6570\u636e\uff0c\u5bf9\u7f51\u7edc\u9020\u6210\u66f4\u5927\u7684\u4f24\u5bb3\u3002\u5bf9\u6b64TCP\u7684\u8bbe\u8ba1\u7406\u5ff5\u662f\uff1a<span style=\"color: #cc0000;\"><strong>TCP\u4e0d\u662f\u4e00\u4e2a\u81ea\u79c1\u7684\u534f\u8bae\uff0c\u5f53\u62e5\u585e\u53d1\u751f\u7684\u65f6\u5019\uff0c\u8981\u505a\u81ea\u6211\u727a\u7272\u3002\u5c31\u50cf\u4ea4\u901a\u963b\u585e\u4e00\u6837\uff0c\u6bcf\u4e2a\u8f66\u90fd\u5e94\u8be5\u628a\u8def\u8ba9\u51fa\u6765\uff0c\u800c\u4e0d\u8981\u518d\u53bb\u62a2\u8def\u4e86\u3002<\/strong><\/span><\/p>\n<p>\u5173\u4e8e\u62e5\u585e\u63a7\u5236\u7684\u8bba\u6587\u8bf7\u53c2\u770b\u300a<a href=\"http:\/\/ee.lbl.gov\/papers\/congavoid.pdf\" target=\"_blank\">Congestion Avoidance and Control<\/a>\u300b(PDF)<\/p>\n<p>\u62e5\u585e\u63a7\u5236\u4e3b\u8981\u662f\u56db\u4e2a\u7b97\u6cd5\uff1a<strong>1\uff09\u6162\u542f\u52a8<\/strong>\uff0c<strong>2\uff09\u62e5\u585e\u907f\u514d<\/strong>\uff0c<strong>3\uff09\u62e5\u585e\u53d1\u751f<\/strong>\uff0c<strong>4\uff09\u5feb\u901f\u6062\u590d<\/strong>\u3002\u8fd9\u56db\u4e2a\u7b97\u6cd5\u4e0d\u662f\u4e00\u5929\u90fd\u641e\u51fa\u6765\u7684\uff0c\u8fd9\u4e2a\u56db\u7b97\u6cd5\u7684\u53d1\u5c55\u7ecf\u5386\u4e86\u5f88\u591a\u65f6\u95f4\uff0c\u5230\u4eca\u5929\u90fd\u8fd8\u5728\u4f18\u5316\u4e2d\u3002 \u5907\u6ce8:<\/p>\n<ul>\n<li>1988\u5e74\uff0cTCP-Tahoe \u63d0\u51fa\u4e861\uff09\u6162\u542f\u52a8\uff0c2\uff09\u62e5\u585e\u907f\u514d\uff0c3\uff09\u62e5\u585e\u53d1\u751f\u65f6\u7684\u5feb\u901f\u91cd\u4f20<\/li>\n<li>1990\u5e74\uff0cTCP Reno \u5728Tahoe\u7684\u57fa\u7840\u4e0a\u589e\u52a0\u4e864\uff09\u5feb\u901f\u6062\u590d<\/li>\n<\/ul>\n<h5><span class=\"ez-toc-section\" id=\"%E6%85%A2%E7%83%AD%E5%90%AF%E5%8A%A8%E7%AE%97%E6%B3%95_%E2%80%93_Slow_Start\"><\/span>\u6162\u70ed\u542f\u52a8\u7b97\u6cd5 &#8211; Slow Start<span class=\"ez-toc-section-end\"><\/span><\/h5>\n<p>\u9996\u5148\uff0c\u6211\u4eec\u6765\u770b\u4e00\u4e0bTCP\u7684\u6162\u70ed\u542f\u52a8\u3002\u6162\u542f\u52a8\u7684\u610f\u601d\u662f\uff0c\u521a\u521a\u52a0\u5165\u7f51\u7edc\u7684\u8fde\u63a5\uff0c\u4e00\u70b9\u4e00\u70b9\u5730\u63d0\u901f\uff0c\u4e0d\u8981\u4e00\u4e0a\u6765\u5c31\u50cf\u90a3\u4e9b\u7279\u6743\u8f66\u4e00\u6837\u9738\u9053\u5730\u628a\u8def\u5360\u6ee1\u3002\u65b0\u540c\u5b66\u4e0a\u9ad8\u901f\u8fd8\u662f\u8981\u6162\u4e00\u70b9\uff0c\u4e0d\u8981\u628a\u5df2\u7ecf\u5728\u9ad8\u901f\u4e0a\u7684\u79e9\u5e8f\u7ed9\u641e\u4e71\u4e86\u3002<\/p>\n<p>\u6162\u542f\u52a8\u7684\u7b97\u6cd5\u5982\u4e0b(cwnd\u5168\u79f0Congestion Window)\uff1a<\/p>\n<p style=\"padding-left: 30px;\">1\uff09\u8fde\u63a5\u5efa\u597d\u7684\u5f00\u59cb\u5148\u521d\u59cb\u5316cwnd = 1\uff0c\u8868\u660e\u53ef\u4ee5\u4f20\u4e00\u4e2aMSS\u5927\u5c0f\u7684\u6570\u636e\u3002<\/p>\n<p style=\"padding-left: 30px;\">2\uff09\u6bcf\u5f53\u6536\u5230\u4e00\u4e2aACK\uff0ccwnd++; \u5448\u7ebf\u6027\u4e0a\u5347<\/p>\n<p style=\"padding-left: 30px;\">3\uff09\u6bcf\u5f53\u8fc7\u4e86\u4e00\u4e2aRTT\uff0ccwnd = cwnd*2; \u5448\u6307\u6570\u8ba9\u5347<\/p>\n<p style=\"padding-left: 30px;\">4\uff09\u8fd8\u6709\u4e00\u4e2assthresh\uff08slow start threshold\uff09\uff0c\u662f\u4e00\u4e2a\u4e0a\u9650\uff0c\u5f53cwnd &gt;= ssthresh\u65f6\uff0c\u5c31\u4f1a\u8fdb\u5165\u201c\u62e5\u585e\u907f\u514d\u7b97\u6cd5\u201d\uff08\u540e\u9762\u4f1a\u8bf4\u8fd9\u4e2a\u7b97\u6cd5\uff09<\/p>\n<p>\u6240\u4ee5\uff0c\u6211\u4eec\u53ef\u4ee5\u770b\u5230\uff0c\u5982\u679c\u7f51\u901f\u5f88\u5feb\u7684\u8bdd\uff0cACK\u4e5f\u4f1a\u8fd4\u56de\u5f97\u5feb\uff0cRTT\u4e5f\u4f1a\u77ed\uff0c\u90a3\u4e48\uff0c\u8fd9\u4e2a\u6162\u542f\u52a8\u5c31\u4e00\u70b9\u4e5f\u4e0d\u6162\u3002\u4e0b\u56fe\u8bf4\u660e\u4e86\u8fd9\u4e2a\u8fc7\u7a0b\u3002<\/p>\n<p><img decoding=\"async\" loading=\"lazy\" class=\"aligncenter size-full wp-image-11619\" src=\"https:\/\/coolshell.cn\/wp-content\/uploads\/2014\/05\/tcp.slow_.start_.jpg\" alt=\"\" width=\"662\" height=\"388\" srcset=\"https:\/\/coolshell.cn\/wp-content\/uploads\/2014\/05\/tcp.slow_.start_.jpg 662w, https:\/\/coolshell.cn\/wp-content\/uploads\/2014\/05\/tcp.slow_.start_-300x175.jpg 300w\" sizes=\"(max-width: 662px) 100vw, 662px\" \/><\/p>\n<p>\u8fd9\u91cc\uff0c\u6211\u9700\u8981\u63d0\u4e00\u4e0b\u7684\u662f\u4e00\u7bc7Google\u7684\u8bba\u6587<span style=\"color: #000000;\">\u300a<a href=\"http:\/\/static.googleusercontent.com\/media\/research.google.com\/zh-CN\/\/pubs\/archive\/36640.pdf\" target=\"_blank\">An Argument for Increasing TCP&#8217;s Initial Congestion Window<\/a>\u300bLinux 3.0\u540e\u91c7\u7528\u4e86\u8fd9\u7bc7\u8bba\u6587\u7684\u5efa\u8bae\u2014\u2014\u628acwnd \u521d\u59cb\u5316\u6210\u4e86 10\u4e2aMSS\u3002<\/span> <span style=\"color: #000000;\">\u800cLinux 3.0\u4ee5\u524d\uff0c\u6bd4\u59822.6\uff0cLinux\u91c7\u7528\u4e86<a href=\"http:\/\/www.rfc-editor.org\/rfc\/rfc3390.txt\" target=\"_blank\">RFC3390<\/a>\uff0ccwnd\u662f\u8ddfMSS\u7684\u503c\u6765\u53d8\u7684\uff0c\u5982\u679cMSS&lt; 1095\uff0c\u5219cwnd = 4\uff1b\u5982\u679cMSS&gt;2190\uff0c\u5219cwnd=2\uff1b\u5176\u5b83\u60c5\u51b5\u4e0b\uff0c\u5219\u662f3\u3002<\/span><\/p>\n<h5><span class=\"ez-toc-section\" id=\"_%E6%8B%A5%E5%A1%9E%E9%81%BF%E5%85%8D%E7%AE%97%E6%B3%95_%E2%80%93_Congestion_Avoidance\"><\/span>\u00a0\u62e5\u585e\u907f\u514d\u7b97\u6cd5 &#8211;\u00a0Congestion Avoidance<span class=\"ez-toc-section-end\"><\/span><\/h5>\n<p>\u524d\u9762\u8bf4\u8fc7\uff0c\u8fd8\u6709\u4e00\u4e2assthresh\uff08slow start threshold\uff09\uff0c\u662f\u4e00\u4e2a\u4e0a\u9650\uff0c\u5f53cwnd &gt;= ssthresh\u65f6\uff0c\u5c31\u4f1a\u8fdb\u5165\u201c\u62e5\u585e\u907f\u514d\u7b97\u6cd5\u201d\u3002\u4e00\u822c\u6765\u8bf4ssthresh\u7684\u503c\u662f65535\uff0c\u5355\u4f4d\u662f\u5b57\u8282\uff0c\u5f53cwnd\u8fbe\u5230\u8fd9\u4e2a\u503c\u65f6\u540e\uff0c\u7b97\u6cd5\u5982\u4e0b\uff1a<\/p>\n<p style=\"padding-left: 30px;\">1\uff09\u6536\u5230\u4e00\u4e2aACK\u65f6\uff0ccwnd = cwnd + 1\/cwnd<\/p>\n<p style=\"padding-left: 30px;\">2\uff09\u5f53\u6bcf\u8fc7\u4e00\u4e2aRTT\u65f6\uff0ccwnd = cwnd + 1<\/p>\n<p>\u8fd9\u6837\u5c31\u53ef\u4ee5\u907f\u514d\u589e\u957f\u8fc7\u5feb\u5bfc\u81f4\u7f51\u7edc\u62e5\u585e\uff0c\u6162\u6162\u7684\u589e\u52a0\u8c03\u6574\u5230\u7f51\u7edc\u7684\u6700\u4f73\u503c\u3002\u5f88\u660e\u663e\uff0c\u662f\u4e00\u4e2a\u7ebf\u6027\u4e0a\u5347\u7684\u7b97\u6cd5\u3002<\/p>\n<h5><span class=\"ez-toc-section\" id=\"%E6%8B%A5%E5%A1%9E%E7%8A%B6%E6%80%81%E6%97%B6%E7%9A%84%E7%AE%97%E6%B3%95\"><\/span>\u62e5\u585e\u72b6\u6001\u65f6\u7684\u7b97\u6cd5<span class=\"ez-toc-section-end\"><\/span><\/h5>\n<p>\u524d\u9762\u6211\u4eec\u8bf4\u8fc7\uff0c\u5f53\u4e22\u5305\u7684\u65f6\u5019\uff0c\u4f1a\u6709\u4e24\u79cd\u60c5\u51b5\uff1a<\/p>\n<p style=\"padding-left: 30px;\">1\uff09\u7b49\u5230RTO\u8d85\u65f6\uff0c\u91cd\u4f20\u6570\u636e\u5305\u3002TCP\u8ba4\u4e3a\u8fd9\u79cd\u60c5\u51b5\u592a\u7cdf\u7cd5\uff0c\u53cd\u5e94\u4e5f\u5f88\u5f3a\u70c8\u3002<\/p>\n<ul>\n<ul>\n<li>sshthresh = \u00a0cwnd \/2<\/li>\n<li>cwnd \u91cd\u7f6e\u4e3a 1<\/li>\n<li>\u8fdb\u5165\u6162\u542f\u52a8\u8fc7\u7a0b<\/li>\n<\/ul>\n<\/ul>\n<p style=\"padding-left: 30px;\">2\uff09Fast Retransmit\u7b97\u6cd5\uff0c\u4e5f\u5c31\u662f\u5728\u6536\u52303\u4e2aduplicate ACK\u65f6\u5c31\u5f00\u542f\u91cd\u4f20\uff0c\u800c\u4e0d\u7528\u7b49\u5230RTO\u8d85\u65f6\u3002<\/p>\n<ul>\n<ul>\n<li>TCP Tahoe\u7684\u5b9e\u73b0\u548cRTO\u8d85\u65f6\u4e00\u6837\u3002<\/li>\n<\/ul>\n<\/ul>\n<ul>\n<ul>\n<li>TCP Reno\u7684\u5b9e\u73b0\u662f\uff1a\n<ul>\n<li>cwnd = cwnd \/2<\/li>\n<li>sshthresh = cwnd<\/li>\n<li>\u8fdb\u5165\u5feb\u901f\u6062\u590d\u7b97\u6cd5\u2014\u2014Fast Recovery<\/li>\n<\/ul>\n<\/li>\n<\/ul>\n<\/ul>\n<p>\u4e0a\u9762\u6211\u4eec\u53ef\u4ee5\u770b\u5230RTO\u8d85\u65f6\u540e\uff0csshthresh\u4f1a\u53d8\u6210cwnd\u7684\u4e00\u534a\uff0c\u8fd9\u610f\u5473\u7740\uff0c\u5982\u679ccwnd&lt;=sshthresh\u65f6\u51fa\u73b0\u7684\u4e22\u5305\uff0c\u90a3\u4e48TCP\u7684sshthresh\u5c31\u4f1a\u51cf\u4e86\u4e00\u534a\uff0c\u7136\u540e\u7b49cwnd\u53c8\u5f88\u5feb\u5730\u4ee5\u6307\u6570\u7ea7\u589e\u6da8\u722c\u5230\u8fd9\u4e2a\u5730\u65b9\u65f6\uff0c\u5c31\u4f1a\u6210\u6162\u6162\u7684\u7ebf\u6027\u589e\u6da8\u3002\u6211\u4eec\u53ef\u4ee5\u770b\u5230\uff0cTCP\u662f\u600e\u4e48\u901a\u8fc7\u8fd9\u79cd\u5f3a\u70c8\u5730\u9707\u8361\u5feb\u901f\u800c\u5c0f\u5fc3\u5f97\u627e\u5230\u7f51\u7ad9\u6d41\u91cf\u7684\u5e73\u8861\u70b9\u7684\u3002<\/p>\n<h5><span class=\"ez-toc-section\" id=\"%E5%BF%AB%E9%80%9F%E6%81%A2%E5%A4%8D%E7%AE%97%E6%B3%95_%E2%80%93_Fast_Recovery\"><\/span>\u5feb\u901f\u6062\u590d\u7b97\u6cd5 &#8211; Fast Recovery<span class=\"ez-toc-section-end\"><\/span><\/h5>\n<p><span style=\"text-decoration: underline;\"><strong>TCP Reno<\/strong><\/span><\/p>\n<p><span style=\"color: #000000;\">\u8fd9\u4e2a\u7b97\u6cd5\u5b9a\u4e49\u5728<\/span><a title=\"&quot;TCP Congestion Control&quot;\" href=\"http:\/\/tools.ietf.org\/html\/rfc5681\">RFC5681<\/a>\u3002\u5feb\u901f\u91cd\u4f20\u548c\u5feb\u901f\u6062\u590d\u7b97\u6cd5\u4e00\u822c\u540c\u65f6\u4f7f\u7528\u3002\u5feb\u901f\u6062\u590d\u7b97\u6cd5\u662f\u8ba4\u4e3a\uff0c\u4f60\u8fd8\u67093\u4e2aDuplicated Acks\u8bf4\u660e\u7f51\u7edc\u4e5f\u4e0d\u90a3\u4e48\u7cdf\u7cd5\uff0c\u6240\u4ee5\u6ca1\u6709\u5fc5\u8981\u50cfRTO\u8d85\u65f6\u90a3\u4e48\u5f3a\u70c8\u3002 <span style=\"color: #000000;\">\u6ce8\u610f\uff0c\u6b63\u5982\u524d\u9762\u6240\u8bf4\uff0c\u8fdb\u5165Fast Recovery\u4e4b\u524d\uff0ccwnd \u548c sshthresh\u5df2\u88ab\u66f4\u65b0\uff1a<\/span><\/p>\n<ul>\n<li>cwnd = cwnd \/2<\/li>\n<li>sshthresh = cwnd<\/li>\n<\/ul>\n<p><span style=\"color: #000000;\">\u7136\u540e\uff0c\u771f\u6b63\u7684Fast Recovery\u7b97\u6cd5\u5982\u4e0b\uff1a<\/span><\/p>\n<ul>\n<li>cwnd = sshthresh \u00a0+ 3 * MSS \uff083\u7684\u610f\u601d\u662f\u786e\u8ba4\u67093\u4e2a\u6570\u636e\u5305\u88ab\u6536\u5230\u4e86\uff09<\/li>\n<li>\u91cd\u4f20Duplicated ACKs\u6307\u5b9a\u7684\u6570\u636e\u5305<\/li>\n<li>\u5982\u679c\u518d\u6536\u5230 duplicated Acks\uff0c\u90a3\u4e48cwnd = cwnd +1<\/li>\n<li>\u5982\u679c\u6536\u5230\u4e86\u65b0\u7684Ack\uff0c\u90a3\u4e48\uff0ccwnd = sshthresh \uff0c\u7136\u540e\u5c31\u8fdb\u5165\u4e86\u62e5\u585e\u907f\u514d\u7684\u7b97\u6cd5\u4e86\u3002<\/li>\n<\/ul>\n<p>\u5982\u679c\u4f60\u4ed4\u7ec6\u601d\u8003\u4e00\u4e0b\u4e0a\u9762\u7684\u8fd9\u4e2a\u7b97\u6cd5\uff0c\u4f60\u5c31\u4f1a\u77e5\u9053\uff0c<strong>\u4e0a\u9762\u8fd9\u4e2a\u7b97\u6cd5\u4e5f\u6709\u95ee\u9898\uff0c\u90a3\u5c31\u662f\u2014\u2014\u5b83\u4f9d\u8d56\u4e8e3\u4e2a\u91cd\u590d\u7684Acks<\/strong>\u3002\u6ce8\u610f\uff0c3\u4e2a\u91cd\u590d\u7684Acks\u5e76\u4e0d\u4ee3\u8868\u53ea\u4e22\u4e86\u4e00\u4e2a\u6570\u636e\u5305\uff0c\u5f88\u6709\u53ef\u80fd\u662f\u4e22\u4e86\u597d\u591a\u5305\u3002\u4f46\u8fd9\u4e2a\u7b97\u6cd5\u53ea\u4f1a\u91cd\u4f20\u4e00\u4e2a\uff0c\u800c\u5269\u4e0b\u7684\u90a3\u4e9b\u5305\u53ea\u80fd\u7b49\u5230RTO\u8d85\u65f6\uff0c\u4e8e\u662f\uff0c\u8fdb\u5165\u4e86\u6076\u68a6\u6a21\u5f0f\u2014\u2014\u8d85\u65f6\u4e00\u4e2a\u7a97\u53e3\u5c31\u51cf\u534a\u4e00\u4e0b\uff0c\u591a\u4e2a\u8d85\u65f6\u4f1a\u8d85\u6210TCP\u7684\u4f20\u8f93\u901f\u5ea6\u5448\u7ea7\u6570\u4e0b\u964d\uff0c\u800c\u4e14\u4e5f\u4e0d\u4f1a\u89e6\u53d1Fast Recovery\u7b97\u6cd5\u4e86\u3002<\/p>\n<p>\u901a\u5e38\u6765\u8bf4\uff0c\u6b63\u5982\u6211\u4eec\u524d\u9762\u6240\u8bf4\u7684\uff0cSACK\u6216D-SACK\u7684\u65b9\u6cd5\u53ef\u4ee5\u8ba9Fast Recovery\u6216Sender\u5728\u505a\u51b3\u5b9a\u65f6\u66f4\u806a\u660e\u4e00\u4e9b\uff0c\u4f46\u662f\u5e76\u4e0d\u662f\u6240\u6709\u7684TCP\u7684\u5b9e\u73b0\u90fd\u652f\u6301SACK\uff08SACK\u9700\u8981\u4e24\u7aef\u90fd\u652f\u6301\uff09\uff0c\u6240\u4ee5\uff0c\u9700\u8981\u4e00\u4e2a\u6ca1\u6709SACK\u7684\u89e3\u51b3\u65b9\u6848\u3002\u800c\u901a\u8fc7SACK\u8fdb\u884c\u62e5\u585e\u63a7\u5236\u7684\u7b97\u6cd5\u662fFACK\uff08\u540e\u9762\u4f1a\u8bb2\uff09<\/p>\n<p><span style=\"text-decoration: underline;\"><strong>TCP New Reno<\/strong><\/span><\/p>\n<p><span style=\"color: #252525;\">\u4e8e\u662f\uff0c1995\u5e74\uff0cTCP New Reno\uff08\u53c2\u89c1\u00a0<\/span><a class=\"external mw-magiclink-rfc\" style=\"color: #663366;\" href=\"http:\/\/tools.ietf.org\/html\/rfc6582\" rel=\"nofollow\">RFC 6582<\/a>\u00a0\uff09\u7b97\u6cd5\u63d0\u51fa\u6765\uff0c\u4e3b\u8981\u5c31\u662f\u5728\u6ca1\u6709SACK\u7684\u652f\u6301\u4e0b\u6539\u8fdbFast Recovery\u7b97\u6cd5\u7684\u2014\u2014<\/p>\n<ul>\n<li>\u5f53sender\u8fd9\u8fb9\u6536\u5230\u4e863\u4e2aDuplicated Acks\uff0c\u8fdb\u5165Fast Retransimit\u6a21\u5f0f\uff0c\u5f00\u53d1\u91cd\u4f20\u91cd\u590dAcks\u6307\u793a\u7684\u90a3\u4e2a\u5305\u3002\u5982\u679c\u53ea\u6709\u8fd9\u4e00\u4e2a\u5305\u4e22\u4e86\uff0c\u90a3\u4e48\uff0c\u91cd\u4f20\u8fd9\u4e2a\u5305\u540e\u56de\u6765\u7684Ack\u4f1a\u628a\u6574\u4e2a\u5df2\u7ecf\u88absender\u4f20\u8f93\u51fa\u53bb\u7684\u6570\u636eack\u56de\u6765\u3002\u5982\u679c\u6ca1\u6709\u7684\u8bdd\uff0c\u8bf4\u660e\u6709\u591a\u4e2a\u5305\u4e22\u4e86\u3002\u6211\u4eec\u53eb\u8fd9\u4e2aACK\u4e3aPartial ACK\u3002<\/li>\n<\/ul>\n<ul>\n<li>\u4e00\u65e6Sender\u8fd9\u8fb9\u53d1\u73b0\u4e86Partial ACK\u51fa\u73b0\uff0c\u90a3\u4e48\uff0csender\u5c31\u53ef\u4ee5\u63a8\u7406\u51fa\u6765\u6709\u591a\u4e2a\u5305\u88ab\u4e22\u4e86\uff0c\u4e8e\u662f\u4e4e\u7ee7\u7eed\u91cd\u4f20sliding window\u91cc\u672a\u88aback\u7684\u7b2c\u4e00\u4e2a\u5305\u3002\u76f4\u5230\u518d\u4e5f\u6536\u4e0d\u5230\u4e86Partial Ack\uff0c\u624d\u771f\u6b63\u7ed3\u675fFast Recovery\u8fd9\u4e2a\u8fc7\u7a0b<\/li>\n<\/ul>\n<p>\u6211\u4eec\u53ef\u4ee5\u770b\u5230\uff0c\u8fd9\u4e2a\u201cFast Recovery\u7684\u53d8\u66f4\u201d\u662f\u4e00\u4e2a\u975e\u5e38\u6fc0\u8fdb\u7684\u73a9\u6cd5\uff0c\u4ed6\u540c\u65f6\u5ef6\u957f\u4e86Fast Retransmit\u548cFast Recovery\u7684\u8fc7\u7a0b\u3002<\/p>\n<h5><span class=\"ez-toc-section\" id=\"%E7%AE%97%E6%B3%95%E7%A4%BA%E6%84%8F%E5%9B%BE\"><\/span>\u7b97\u6cd5\u793a\u610f\u56fe<span class=\"ez-toc-section-end\"><\/span><\/h5>\n<p>\u4e0b\u9762\u6211\u4eec\u6765\u770b\u4e00\u4e2a\u7b80\u5355\u7684\u56fe\u793a\u4ee5\u540c\u65f6\u770b\u4e00\u4e0b\u4e0a\u9762\u7684\u5404\u79cd\u7b97\u6cd5\u7684\u6837\u5b50\uff1a<\/p>\n<p><img decoding=\"async\" loading=\"lazy\" class=\"aligncenter wp-image-11621\" src=\"https:\/\/coolshell.cn\/wp-content\/uploads\/2014\/05\/tcp.fr_-1024x359.jpg\" alt=\"\" width=\"680\" height=\"239\" srcset=\"https:\/\/coolshell.cn\/wp-content\/uploads\/2014\/05\/tcp.fr_-1024x359.jpg 1024w, https:\/\/coolshell.cn\/wp-content\/uploads\/2014\/05\/tcp.fr_-300x105.jpg 300w, https:\/\/coolshell.cn\/wp-content\/uploads\/2014\/05\/tcp.fr_-900x315.jpg 900w, https:\/\/coolshell.cn\/wp-content\/uploads\/2014\/05\/tcp.fr_.jpg 1410w\" sizes=\"(max-width: 680px) 100vw, 680px\" \/><\/p>\n<p>&nbsp;<\/p>\n<h5><span class=\"ez-toc-section\" id=\"FACK%E7%AE%97%E6%B3%95\"><\/span>FACK\u7b97\u6cd5<span class=\"ez-toc-section-end\"><\/span><\/h5>\n<p>FACK\u5168\u79f0Forward Acknowledgment \u7b97\u6cd5\uff0c\u8bba\u6587\u5730\u5740\u5728\u8fd9\u91cc\uff08PDF\uff09<a href=\"http:\/\/conferences.sigcomm.org\/sigcomm\/1996\/papers\/mathis.pdf\" target=\"_blank\">Forward Acknowledgement: Refining TCP Congestion Control<\/a> \u8fd9\u4e2a\u7b97\u6cd5\u662f\u5176\u4e8eSACK\u7684\uff0c\u524d\u9762\u6211\u4eec\u8bf4\u8fc7SACK\u662f\u4f7f\u7528\u4e86TCP\u6269\u5c55\u5b57\u6bb5Ack\u4e86\u6709\u54ea\u4e9b\u6570\u636e\u6536\u5230\uff0c\u54ea\u4e9b\u6570\u636e\u6ca1\u6709\u6536\u5230\uff0c\u4ed6\u6bd4Fast Retransmit\u76843 \u4e2aduplicated acks\u597d\u5904\u5728\u4e8e\uff0c\u524d\u8005\u53ea\u77e5\u9053\u6709\u5305\u4e22\u4e86\uff0c\u4e0d\u77e5\u9053\u662f\u4e00\u4e2a\u8fd8\u662f\u591a\u4e2a\uff0c\u800cSACK\u53ef\u4ee5\u51c6\u786e\u7684\u77e5\u9053\u6709\u54ea\u4e9b\u5305\u4e22\u4e86\u3002 \u6240\u4ee5\uff0cSACK\u53ef\u4ee5\u8ba9\u53d1\u9001\u7aef\u8fd9\u8fb9\u5728\u91cd\u4f20\u8fc7\u7a0b\u4e2d\uff0c\u628a\u90a3\u4e9b\u4e22\u6389\u7684\u5305\u91cd\u4f20\uff0c\u800c\u4e0d\u662f\u4e00\u4e2a\u4e00\u4e2a\u7684\u4f20\uff0c\u4f46\u8fd9\u6837\u7684\u4e00\u6765\uff0c\u5982\u679c\u91cd\u4f20\u7684\u5305\u6570\u636e\u6bd4\u8f83\u591a\u7684\u8bdd\uff0c\u53c8\u4f1a\u5bfc\u81f4\u672c\u6765\u5c31\u5f88\u5fd9\u7684\u7f51\u7edc\u5c31\u66f4\u5fd9\u4e86\u3002\u6240\u4ee5\uff0cFACK\u7528\u6765\u505a\u91cd\u4f20\u8fc7\u7a0b\u4e2d\u7684\u62e5\u585e\u6d41\u63a7\u3002<\/p>\n<ul>\n<li>\u8fd9\u4e2a\u7b97\u6cd5\u4f1a\u628aSACK\u4e2d\u6700\u5927\u7684Sequence Number \u4fdd\u5b58\u5728<strong>snd.fack<\/strong>\u8fd9\u4e2a\u53d8\u91cf\u4e2d\uff0csnd.fack\u7684\u66f4\u65b0\u7531ack\u5e26\u79cb\uff0c\u5982\u679c\u7f51\u7edc\u4e00\u5207\u5b89\u597d\u5219\u548csnd.una\u4e00\u6837\uff08snd.una\u5c31\u662f\u8fd8\u6ca1\u6709\u6536\u5230ack\u7684\u5730\u65b9\uff0c\u4e5f\u5c31\u662f\u524d\u9762sliding window\u91cc\u7684category #2\u7684\u7b2c\u4e00\u4e2a\u5730\u65b9\uff09<\/li>\n<\/ul>\n<ul>\n<li>\u7136\u540e\u5b9a\u4e49\u4e00\u4e2a<strong>awnd = snd.nxt &#8211; snd.fack<\/strong>\uff08snd.nxt\u6307\u5411\u53d1\u9001\u7aefsliding window\u4e2d\u6b63\u5728\u8981\u88ab\u53d1\u9001\u7684\u5730\u65b9\u2014\u2014\u524d\u9762sliding windows\u56fe\u793a\u7684category#3\u7b2c\u4e00\u4e2a\u4f4d\u7f6e\uff09\uff0c\u8fd9\u6837awnd\u7684\u610f\u601d\u5c31\u662f\u5728\u7f51\u7edc\u4e0a\u7684\u6570\u636e\u3002\uff08\u6240\u8c13awnd\u610f\u4e3a\uff1aactual quantity of data outstanding in the network\uff09<\/li>\n<\/ul>\n<ul>\n<li>\u5982\u679c\u9700\u8981\u91cd\u4f20\u6570\u636e\uff0c\u90a3\u4e48\uff0c<strong>awnd =\u00a0snd.nxt &#8211; snd.fack + retran_data<\/strong>\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0cawnd\u662f\u4f20\u51fa\u53bb\u7684\u6570\u636e + \u91cd\u4f20\u7684\u6570\u636e\u3002<\/li>\n<\/ul>\n<ul>\n<li>\u7136\u540e\u89e6\u53d1Fast Recovery \u7684\u6761\u4ef6\u662f\uff1a\u00a0(<strong>\u00a0( snd.fack &#8211; snd.una ) &gt; (3*MSS)\u00a0<\/strong>) || (dupacks == 3) ) \u3002\u8fd9\u6837\u4e00\u6765\uff0c\u5c31\u4e0d\u9700\u8981\u7b49\u52303\u4e2aduplicated acks\u624d\u91cd\u4f20\uff0c\u800c\u662f\u53ea\u8981sack\u4e2d\u7684\u6700\u5927\u7684\u4e00\u4e2a\u6570\u636e\u548cack\u7684\u6570\u636e\u6bd4\u8f83\u957f\u4e86\uff083\u4e2aMSS\uff09\uff0c\u90a3\u5c31\u89e6\u53d1\u91cd\u4f20\u3002\u5728\u6574\u4e2a\u91cd\u4f20\u8fc7\u7a0b\u4e2dcwnd\u4e0d\u53d8\u3002\u76f4\u5230\u5f53\u7b2c\u4e00\u6b21\u4e22\u5305\u7684snd.nxt&lt;=snd.una\uff08\u4e5f\u5c31\u662f\u91cd\u4f20\u7684\u6570\u636e\u90fd\u88ab\u786e\u8ba4\u4e86\uff09\uff0c\u7136\u540e\u8fdb\u6765\u62e5\u585e\u907f\u514d\u673a\u5236\u2014\u2014cwnd\u7ebf\u6027\u4e0a\u6da8\u3002<\/li>\n<\/ul>\n<p>\u6211\u4eec\u53ef\u4ee5\u770b\u5230\u5982\u679c\u6ca1\u6709FACK\u5728\uff0c\u90a3\u4e48\u5728\u4e22\u5305\u6bd4\u8f83\u591a\u7684\u60c5\u51b5\u4e0b\uff0c\u539f\u6765\u4fdd\u5b88\u7684\u7b97\u6cd5\u4f1a\u4f4e\u4f30\u4e86\u9700\u8981\u4f7f\u7528\u7684window\u7684\u5927\u5c0f\uff0c\u800c\u9700\u8981\u51e0\u4e2aRTT\u7684\u65f6\u95f4\u624d\u4f1a\u5b8c\u6210\u6062\u590d\uff0c\u800cFACK\u4f1a\u6bd4\u8f83\u6fc0\u8fdb\u5730\u6765\u5e72\u8fd9\u4e8b\u3002 \u4f46\u662f\uff0cFACK\u5982\u679c\u5728\u4e00\u4e2a\u7f51\u7edc\u5305\u4f1a\u88ab reordering\u7684\u7f51\u7edc\u91cc\u4f1a\u6709\u5f88\u5927\u7684\u95ee\u9898\u3002<\/p>\n<h4><span class=\"ez-toc-section\" id=\"%E5%85%B6%E5%AE%83%E6%8B%A5%E5%A1%9E%E6%8E%A7%E5%88%B6%E7%AE%97%E6%B3%95%E7%AE%80%E4%BB%8B\"><\/span>\u5176\u5b83\u62e5\u585e\u63a7\u5236\u7b97\u6cd5\u7b80\u4ecb<span class=\"ez-toc-section-end\"><\/span><\/h4>\n<h5><span class=\"ez-toc-section\" id=\"TCP_Vegas_%E6%8B%A5%E5%A1%9E%E6%8E%A7%E5%88%B6%E7%AE%97%E6%B3%95\"><\/span><strong>TCP Vegas \u62e5\u585e\u63a7\u5236\u7b97\u6cd5<\/strong><span class=\"ez-toc-section-end\"><\/span><\/h5>\n<p>\u8fd9\u4e2a\u7b97\u6cd51994\u5e74\u88ab\u63d0\u51fa\uff0c\u5b83\u4e3b\u8981\u5bf9TCP Reno \u505a\u4e86\u4e9b\u4fee\u6539\u3002\u8fd9\u4e2a\u7b97\u6cd5\u901a\u8fc7\u5bf9RTT\u7684\u975e\u5e38\u91cd\u7684\u76d1\u63a7\u6765\u8ba1\u7b97\u4e00\u4e2a\u57fa\u51c6RTT\u3002\u7136\u540e\u901a\u8fc7\u8fd9\u4e2a\u57fa\u51c6RTT\u6765\u4f30\u8ba1\u5f53\u524d\u7684\u7f51\u7edc\u5b9e\u9645\u5e26\u5bbd\uff0c\u5982\u679c\u5b9e\u9645\u5e26\u5bbd\u6bd4\u6211\u4eec\u7684\u671f\u671b\u7684\u5e26\u5bbd\u8981\u5c0f\u6216\u662f\u8981\u591a\u7684\u6d3b\uff0c\u90a3\u4e48\u5c31\u5f00\u59cb\u7ebf\u6027\u5730\u51cf\u5c11\u6216\u589e\u52a0cwnd\u7684\u5927\u5c0f\u3002\u5982\u679c\u8fd9\u4e2a\u8ba1\u7b97\u51fa\u6765\u7684RTT\u5927\u4e8e\u4e86Timeout\u540e\uff0c\u90a3\u4e48\uff0c\u4e0d\u7b49ack\u8d85\u65f6\u5c31\u76f4\u63a5\u91cd\u4f20\u3002\uff08Vegas \u7684\u6838\u5fc3\u601d\u60f3\u662f\u7528RTT\u7684\u503c\u6765\u5f71\u54cd\u62e5\u585e\u7a97\u53e3\uff0c\u800c\u4e0d\u662f\u901a\u8fc7\u4e22\u5305\uff09 \u8fd9\u4e2a\u7b97\u6cd5\u7684\u8bba\u6587\u662f\u300a<a class=\"external text\" style=\"color: #663366;\" href=\"http:\/\/www.cs.cmu.edu\/~srini\/15-744\/F02\/readings\/BP95.pdf\" target=\"_blank\" rel=\"nofollow\">TCP Vegas: End to End Congestion Avoidance on a Global Internet<\/a>\u300b\u8fd9\u7bc7\u8bba\u6587\u7ed9\u4e86Vegas\u548c New Reno\u7684\u5bf9\u6bd4\uff1a<\/p>\n<p><img decoding=\"async\" loading=\"lazy\" class=\"aligncenter wp-image-11626\" src=\"https:\/\/coolshell.cn\/wp-content\/uploads\/2014\/05\/tcp_vegas_newreno-1024x555.jpg\" alt=\"\" width=\"680\" height=\"369\" srcset=\"https:\/\/coolshell.cn\/wp-content\/uploads\/2014\/05\/tcp_vegas_newreno-1024x555.jpg 1024w, https:\/\/coolshell.cn\/wp-content\/uploads\/2014\/05\/tcp_vegas_newreno-300x162.jpg 300w, https:\/\/coolshell.cn\/wp-content\/uploads\/2014\/05\/tcp_vegas_newreno-900x487.jpg 900w, https:\/\/coolshell.cn\/wp-content\/uploads\/2014\/05\/tcp_vegas_newreno.jpg 1500w\" sizes=\"(max-width: 680px) 100vw, 680px\" \/><\/p>\n<p>\u5173\u4e8e\u8fd9\u4e2a\u7b97\u6cd5\u5b9e\u73b0\uff0c\u4f60\u53ef\u4ee5\u53c2\u770bLinux\u6e90\u7801\uff1a<a href=\"http:\/\/lxr.free-electrons.com\/source\/net\/ipv4\/tcp_vegas.h\" target=\"_blank\">\/net\/ipv4\/tcp_vegas.h<\/a>\uff0c\u00a0<a href=\"http:\/\/lxr.free-electrons.com\/source\/net\/ipv4\/tcp_vegas.c\" target=\"_blank\">\/net\/ipv4\/tcp_vegas.c<\/a><\/p>\n<h5><\/h5>\n<h5 style=\"color: #000000;\"><span class=\"ez-toc-section\" id=\"HSTCPHigh_Speed_TCP_%E7%AE%97%E6%B3%95\"><\/span>HSTCP(High Speed TCP) \u7b97\u6cd5<span class=\"ez-toc-section-end\"><\/span><\/h5>\n<p>\u8fd9\u4e2a\u7b97\u6cd5\u6765\u81ea<a href=\"http:\/\/tools.ietf.org\/html\/rfc3649\" target=\"_blank\">RFC 3649<\/a>\uff08<a href=\"http:\/\/en.wikipedia.org\/wiki\/HSTCP\" target=\"_blank\">Wikipedia\u8bcd\u6761<\/a>\uff09\u3002\u5176\u5bf9\u6700\u57fa\u7840\u7684\u7b97\u6cd5\u8fdb\u884c\u4e86\u66f4\u6539\uff0c\u4ed6\u4f7f\u5f97Congestion Window\u6da8\u5f97\u5feb\uff0c\u51cf\u5f97\u6162\u3002\u5176\u4e2d\uff1a<\/p>\n<ul>\n<li>\u62e5\u585e\u907f\u514d\u65f6\u7684\u7a97\u53e3\u589e\u957f\u65b9\u5f0f\uff1a cwnd = cwnd + \u03b1(cwnd) \/ cwnd<\/li>\n<li>\u4e22\u5305\u540e\u7a97\u53e3\u4e0b\u964d\u65b9\u5f0f\uff1acwnd = (1- \u03b2(cwnd))*cwnd<\/li>\n<\/ul>\n<p>\u6ce8\uff1a\u03b1(cwnd)\u548c\u03b2(cwnd)\u90fd\u662f\u51fd\u6570\uff0c\u5982\u679c\u4f60\u8981\u8ba9\u4ed6\u4eec\u548c\u6807\u51c6\u7684TCP\u4e00\u6837\uff0c\u90a3\u4e48\u8ba9\u03b1(cwnd)=1\uff0c\u03b2(cwnd)=0.5\u5c31\u53ef\u4ee5\u4e86\u3002 \u5bf9\u4e8e\u03b1(cwnd)\u548c\u03b2(cwnd)\u7684\u503c\u662f\u4e2a\u52a8\u6001\u7684\u53d8\u6362\u7684\u4e1c\u897f\u3002 \u5173\u4e8e\u8fd9\u4e2a\u7b97\u6cd5\u7684\u5b9e\u73b0\uff0c\u4f60\u53ef\u4ee5\u53c2\u770bLinux\u6e90\u7801\uff1a<a href=\"http:\/\/lxr.free-electrons.com\/source\/net\/ipv4\/tcp_highspeed.c\" target=\"_blank\">\/net\/ipv4\/tcp_highspeed.c<\/a><\/p>\n<h5><span class=\"ez-toc-section\" id=\"_TCP_BIC_%E7%AE%97%E6%B3%95\"><\/span>\u00a0TCP BIC \u7b97\u6cd5<span class=\"ez-toc-section-end\"><\/span><\/h5>\n<p>2004\u5e74\uff0c\u4ea7\u5185\u51faBIC\u7b97\u6cd5\u3002\u73b0\u5728\u4f60\u8fd8\u53ef\u4ee5\u67e5\u5f97\u5230\u76f8\u5173\u7684\u65b0\u95fb\u300aGoogle\uff1a<a href=\"https:\/\/www.google.com\/search?lr=lang_zh-CN%7Clang_zh-TW&amp;newwindow=1&amp;biw=1366&amp;bih=597&amp;tbs=lr%3Alang_1zh-CN%7Clang_1zh-TW&amp;q=%E7%BE%8E%E7%A7%91%E5%AD%A6%E5%AE%B6%E7%A0%94%E5%8F%91BIC-TCP%E5%8D%8F%E8%AE%AE+%E9%80%9F%E5%BA%A6%E6%98%AFDSL%E5%85%AD%E5%8D%83%E5%80%8D&amp;oq=%E7%BE%8E%E7%A7%91%E5%AD%A6%E5%AE%B6%E7%A0%94%E5%8F%91BIC-TCP%E5%8D%8F%E8%AE%AE+%E9%80%9F%E5%BA%A6%E6%98%AFDSL%E5%85%AD%E5%8D%83%E5%80%8D\" target=\"_blank\">\u7f8e\u79d1\u5b66\u5bb6\u7814\u53d1BIC-TCP\u534f\u8bae \u901f\u5ea6\u662fDSL\u516d\u5343\u500d<\/a>\u300b BIC\u5168\u79f0<a href=\"http:\/\/research.csc.ncsu.edu\/netsrv\/?q=content\/bic-and-cubic\" target=\"_blank\">Binary Increase Congestion control<\/a>\uff0c\u5728Linux 2.6.8\u4e2d\u662f\u9ed8\u8ba4\u62e5\u585e\u63a7\u5236\u7b97\u6cd5\u3002BIC\u7684\u53d1\u660e\u8005\u53d1\u8fd9\u4e48\u591a\u7684\u62e5\u585e\u63a7\u5236\u7b97\u6cd5\u90fd\u5728\u52aa\u529b\u627e\u4e00\u4e2a\u5408\u9002\u7684cwnd &#8211; Congestion Window\uff0c\u800c\u4e14BIC-TCP\u7684\u63d0\u51fa\u8005\u4eec\u770b\u7a7f\u4e86\u4e8b\u60c5\u7684\u672c\u8d28\uff0c\u5176\u5b9e\u8fd9\u5c31\u662f\u4e00\u4e2a\u641c\u7d22\u7684\u8fc7\u7a0b\uff0c\u6240\u4ee5BIC\u8fd9\u4e2a\u7b97\u6cd5\u4e3b\u8981\u7528\u7684\u662fBinary Search\u2014\u2014\u4e8c\u5206\u67e5\u627e\u6765\u5e72\u8fd9\u4e2a\u4e8b\u3002 \u5173\u4e8e\u8fd9\u4e2a\u7b97\u6cd5\u5b9e\u73b0\uff0c\u4f60\u53ef\u4ee5\u53c2\u770bLinux\u6e90\u7801\uff1a<a href=\"http:\/\/lxr.free-electrons.com\/source\/net\/ipv4\/tcp_bic.c\" target=\"_blank\">\/net\/ipv4\/tcp_bic.c<\/a><\/p>\n<h5><span class=\"ez-toc-section\" id=\"TCP_WestWood%E7%AE%97%E6%B3%95\"><\/span>TCP WestWood\u7b97\u6cd5<span class=\"ez-toc-section-end\"><\/span><\/h5>\n<p><span style=\"color: #000000;\">westwood\u91c7\u7528\u548cReno\u76f8\u540c\u7684\u6162\u542f\u52a8\u7b97\u6cd5\u3001\u62e5\u585e\u907f\u514d\u7b97\u6cd5\u3002<\/span><span style=\"color: #000000;\">westwood\u7684\u4e3b\u8981\u6539\u8fdb\u65b9\u9762\uff1a\u5728\u53d1\u9001\u7aef\u505a\u5e26\u5bbd\u4f30\u8ba1\uff0c\u5f53\u63a2\u6d4b\u5230\u4e22\u5305\u65f6\uff0c\u6839\u636e\u5e26\u5bbd\u503c\u6765\u8bbe\u7f6e\u62e5\u585e\u7a97\u53e3\u3001<\/span><span style=\"color: #000000;\">\u6162\u542f\u52a8\u9608\u503c\u3002<\/span> \u90a3\u4e48\uff0c\u8fd9\u4e2a\u7b97\u6cd5\u662f\u600e\u4e48\u6d4b\u91cf\u5e26\u5bbd\u7684\uff1f\u6bcf\u4e2aRTT\u65f6\u95f4\uff0c\u4f1a\u6d4b\u91cf\u4e00\u6b21\u5e26\u5bbd\uff0c\u6d4b\u91cf\u5e26\u5bbd\u7684\u516c\u5f0f\u5f88\u7b80\u5355\uff0c\u5c31\u662f\u8fd9\u6bb5RTT\u5185\u6210\u529f\u88aback\u4e86\u591a\u5c11\u5b57\u8282\u3002\u56e0\u4e3a\uff0c\u8fd9\u4e2a\u5e26\u5bbd\u548c\u7528RTT\u8ba1\u7b97RTO\u4e00\u6837\uff0c\u4e5f\u662f\u9700\u8981\u4ece\u6bcf\u4e2a\u6837\u672c\u6765\u5e73\u6ed1\u5230\u4e00\u4e2a\u503c\u7684\u2014\u2014\u4e5f\u662f\u7528\u4e00\u4e2a\u52a0\u6743\u79fb\u5e73\u5747\u7684\u516c\u5f0f\u3002 \u53e6\u5916\uff0c\u6211\u4eec\u77e5\u9053\uff0c\u5982\u679c\u4e00\u4e2a\u7f51\u7edc\u7684\u5e26\u5bbd\u662f\u6bcf\u79d2\u53ef\u4ee5\u53d1\u9001X\u4e2a\u5b57\u8282\uff0c\u800cRTT\u662f\u4e00\u4e2a\u6570\u636e\u53d1\u51fa\u53bb\u540e\u786e\u8ba4\u9700\u8981\u7684\u65f6\u5019\uff0c\u6240\u4ee5\uff0cX * RTT\u5e94\u8be5\u662f\u6211\u4eec\u7f13\u51b2\u533a\u5927\u5c0f\u3002\u6240\u4ee5\uff0c\u5728\u8fd9\u4e2a\u7b97\u6cd5\u4e2d\uff0cssthresh\u7684\u503c\u5c31\u662fest_BD * min-RTT(\u6700\u5c0f\u7684RTT\u503c)\uff0c\u5982\u679c\u4e22\u5305\u662fDuplicated ACKs\u5f15\u8d77\u7684\uff0c\u90a3\u4e48\u5982\u679ccwnd &gt; ssthresh\uff0c\u5219 cwin = ssthresh\u3002\u5982\u679c\u662fRTO\u5f15\u8d77\u7684\uff0ccwnd = 1\uff0c\u8fdb\u5165\u6162\u542f\u52a8\u3002 \u00a0 \u5173\u4e8e\u8fd9\u4e2a\u7b97\u6cd5\u5b9e\u73b0\uff0c\u4f60\u53ef\u4ee5\u53c2\u770bLinux\u6e90\u7801\uff1a\u00a0<a href=\"http:\/\/lxr.free-electrons.com\/source\/net\/ipv4\/tcp_westwood.c\" target=\"_blank\">\/net\/ipv4\/tcp_westwood.c<\/a><\/p>\n<h5><span class=\"ez-toc-section\" id=\"%E5%85%B6%E5%AE%83\"><\/span>\u5176\u5b83<span class=\"ez-toc-section-end\"><\/span><\/h5>\n<p>\u66f4\u591a\u7684\u7b97\u6cd5\uff0c\u4f60\u53ef\u4ee5\u4eceWikipedia\u7684\u00a0<a href=\"http:\/\/en.wikipedia.org\/wiki\/TCP_congestion-avoidance_algorithm\" target=\"_blank\">TCP Congestion Avoidance Algorithm<\/a> \u8bcd\u6761\u4e2d\u627e\u5230\u76f8\u5173\u7684\u7ebf\u7d22<\/p>\n<h4><span class=\"ez-toc-section\" id=\"_%E5%90%8E%E8%AE%B0\"><\/span>\u00a0\u540e\u8bb0<span class=\"ez-toc-section-end\"><\/span><\/h4>\n<p>\u597d\u4e86\uff0c\u5230\u8fd9\u91cc\u6211\u60f3\u53ef\u4ee5\u7ed3\u675f\u4e86\uff0cTCP\u53d1\u5c55\u5230\u4eca\u5929\uff0c\u91cc\u9762\u7684\u4e1c\u897f\u53ef\u4ee5\u5199\u4e0a\u597d\u51e0\u672c\u4e66\u3002\u672c\u6587\u4e3b\u8981\u76ee\u7684\uff0c\u8fd8\u662f\u628a\u4f60\u5e26\u5165\u8fd9\u4e9b\u53e4\u5178\u7684\u57fa\u7840\u6280\u672f\u548c\u77e5\u8bc6\u4e2d\uff0c\u5e0c\u671b\u672c\u6587\u80fd\u8ba9\u4f60\u4e86\u89e3TCP\uff0c\u66f4\u5e0c\u671b\u672c\u6587\u80fd\u8ba9\u4f60\u5f00\u59cb\u6709\u5b66\u4e60\u8fd9\u4e9b\u57fa\u7840\u6216\u5e95\u5c42\u77e5\u8bc6\u7684\u5174\u8da3\u548c\u4fe1\u5fc3\u3002<\/p>\n<p>\u5f53\u7136\uff0cTCP\u4e1c\u897f\u592a\u591a\u4e86\uff0c\u4e0d\u540c\u7684\u4eba\u53ef\u80fd\u6709\u4e0d\u540c\u7684\u7406\u89e3\uff0c\u800c\u4e14\u672c\u6587\u53ef\u80fd\u4e5f\u4f1a\u6709\u4e00\u4e9b\u8352\u8c2c\u4e4b\u8a00\u751a\u81f3\u9519\u8bef\uff0c\u8fd8\u5e0c\u671b\u5f97\u5230\u60a8\u7684\u53cd\u9988\u548c\u6279\u8bc4\u3002<\/p>\n<p style=\"text-align: left;\">\uff08\u5168\u6587\u5b8c\uff09<\/p>\n<p>&nbsp;<\/p>\n","raw":"","protected":false},"excerpt":{"rendered":"<p>\u8fd9\u7bc7\u6587\u7ae0\u662f\u4e0b\u7bc7\uff0c\u6240\u4ee5\u5982\u679c\u4f60\u5bf9TCP\u4e0d\u719f\u6089\u7684\u8bdd\uff0c\u8fd8\u8bf7\u4f60\u5148\u770b\u770b\u4e0a\u7bc7\u300aTCP\u7684\u90a3\u4e9b\u4e8b\u513f\uff08\u4e0a\uff09\u300b \u4e0a\u7bc7\u4e2d\uff0c\u6211\u4eec\u4ecb\u7ecd\u4e86TCP\u7684\u534f\u8bae\u5934\u3001\u72b6\u6001\u673a\u3001\u6570\u636e\u91cd\u4f20\u4e2d\u7684\u4e1c\u897f\u3002\u4f46\u662fTCP&#8230;<\/p>\n<p class=\"read-more\"><a class=\"btn btn-default\" href=\"https:\/\/coolshell.cn\/articles\/11609.html\"> Read More<span class=\"screen-reader-text\">  Read More<\/span><\/a><\/p>\n","protected":false},"author":2,"featured_media":0,"comment_status":"open","ping_status":"open","sticky":false,"template":"","format":"standard","meta":[],"categories":[23,3,6],"tags":[736,737,734,733,199,735],"series":[],"aioseo_notices":[],"views":284560,"post_thumbnail_image":"https:\/\/coolshell.cn\/wp-content\/uploads\/2014\/05\/xin_2001040422167711230318.jpg","content_first_image":"https:\/\/coolshell.cn\/wp-content\/uploads\/2014\/05\/xin_2001040422167711230318.jpg","post_medium_image_300":"https:\/\/coolshell.cn\/wp-content\/uploads\/2014\/05\/xin_2001040422167711230318.jpg","post_thumbnail_image_624":"https:\/\/coolshell.cn\/wp-content\/uploads\/2014\/05\/xin_2001040422167711230318.jpg","post_frist_image":"https:\/\/coolshell.cn\/wp-content\/uploads\/2014\/05\/xin_2001040422167711230318.jpg","post_medium_image":"https:\/\/coolshell.cn\/wp-content\/uploads\/2014\/05\/xin_2001040422167711230318.jpg","post_large_image":"https:\/\/coolshell.cn\/wp-content\/uploads\/2014\/05\/xin_2001040422167711230318.jpg","post_full_image":"https:\/\/coolshell.cn\/wp-content\/uploads\/2014\/05\/xin_2001040422167711230318.jpg","post_all_images":[{"imagesurl":"https:\/\/coolshell.cn\/wp-content\/uploads\/2014\/05\/xin_2001040422167711230318.jpg","id":"image0"},{"imagesurl":"https:\/\/coolshell.cn\/wp-content\/uploads\/2014\/05\/Karn-Partridge-Algorithm.jpg","id":"image1"},{"imagesurl":"https:\/\/coolshell.cn\/wp-content\/uploads\/2014\/05\/sliding_window.jpg","id":"image2"},{"imagesurl":"https:\/\/coolshell.cn\/wp-content\/uploads\/2014\/05\/tcpswwindows.png","id":"image3"},{"imagesurl":"https:\/\/coolshell.cn\/wp-content\/uploads\/2014\/05\/tcpswslide.png","id":"image4"},{"imagesurl":"https:\/\/coolshell.cn\/wp-content\/uploads\/2014\/05\/tcpswflow.png","id":"image5"},{"imagesurl":"https:\/\/coolshell.cn\/wp-content\/uploads\/2014\/05\/tcp.slow_.start_.jpg","id":"image6"},{"imagesurl":"https:\/\/coolshell.cn\/wp-content\/uploads\/2014\/05\/tcp.fr_-1024x359.jpg","id":"image7"},{"imagesurl":"https:\/\/coolshell.cn\/wp-content\/uploads\/2014\/05\/tcp_vegas_newreno-1024x555.jpg","id":"image8"}],"videoAdId":"","listAd":"0","listAdId":"","listAdEvery":5,"total_comments":162,"category_name":"\u7a0b\u5e8f\u8bbe\u8ba1","post_date":"2014-05-28","like_count":"0","praiseWord":"\u9f13\u52b1","excitationAd":"0","rewardedVideoAdId":"","detailAdId":"","detailAd":"0","enterpriseMinapp":"0","audios":[],"postImageUrl":"http:\/\/coolshell.cn\/wp-content\/uploads\/2016\/09\/coolshell-360x200.jpg","avatarurls":[],"related_posts":[{"ID":"22263","post_title":"\u4ece\u4e00\u6b21\u7ecf\u5386\u8c08 TIME_WAIT \u7684\u90a3\u4e9b\u4e8b"}],"pageviews":284561,"pageviews_wl":219118,"ratings_average":4,"ratings_total":484,"ratings_users":102,"next_post_id":11973,"next_post_title":"bash\u4ee3\u7801\u6ce8\u5165\u7684\u5b89\u5168\u6f0f\u6d1e","previous_post_id":11564,"previous_post_title":"TCP \u7684\u90a3\u4e9b\u4e8b\u513f\uff08\u4e0a\uff09"}