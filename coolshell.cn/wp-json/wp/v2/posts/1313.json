{"id":1313,"date":"2009-08-24T22:30:49","date_gmt":"2009-08-24T14:30:49","guid":{"rendered":"http:\/\/coolshell.cn\/?p=1313"},"modified":"2009-11-11T00:36:05","modified_gmt":"2009-11-10T16:36:05","slug":"erlang%e5%92%8cpython%e4%ba%92%e9%80%9a","status":"publish","type":"post","link":"https:\/\/coolshell.cn\/articles\/1313.html","title":{"rendered":"Erlang\u548cPython\u4e92\u901a"},"content":{"rendered":"<p>\u6700\u8fd1\u5f00\u53d1 Erlang ,\u5bf9\u5176\u5b57\u7b26\u4e32\u5904\u7406\u80fd\u529b\u65e0\u8a00\u81f3\u6781,\u4e8e\u662f\u51b3\u5b9a\u628a\u5b83\u548cpython\u8054\u5408\u8d77\u6765,\u6253\u9020\u4e00\u4e2a\u5f3a\u529b\u7684\u5206\u5e03\u5f0f\u7cfb\u7edf,\u7b49\u5c06\u6765\u9700\u8981\u7cfb\u7edf\u7ea7\u5f00\u53d1\u65f6,\u6211\u518d\u628a C++\/C\u7ec4\u5408\u8fdb\u6765.<\/p>\n<p>\u9996\u5148\u53c2\u8003\u4e86 Erlang \u5b98\u65b9\u6587\u6863\u548c\u00a0<a href=\"http:\/\/www.zend2.com\/DoIt.php?u=Oi8vd3d3LmJsb2dnZXIuY29tL2Jsb2cuZGV2ZWxvcGVycy5hcGkuc2luYS5jb20uY24vP3RhZz1lcmxhbmc%3D&amp;b=5\">http:\/\/<cite>blog.developers.api.sina.com.cn\/?tag=<strong>erlang<\/strong><\/cite><\/a> \u4ee5\u53ca<a href=\"http:\/\/www.zend2.com\/DoIt.php?u=Oi8va2F6bWllci5uZXQvY29tcHV0ZXIvcG9ydC1ob3d0by8%3D&amp;b=5\"> http:\/\/kazmier.net\/computer\/port-howto\/<\/a> .<\/p>\n<p>\u7814\u8bfb\u4e86\u5c06\u8fd124\u4e2a\u5c0f\u65f6, \u624d\u7ec8\u4e8e\u5b8c\u5168\u628a\u95ee\u9898\u89e3\u51b3. \u00a0\u8d77\u540d\u4e3atown\uff0ctown\u5728\u82f1\u6587\u91cc\u8868\u793a\u96c6\u5e02\uff0c\u4e5f\u5c31\u662f\u4ee3\u8868\u5404\u79cd\u8bed\u8a00\u5728\u8fd9\u91cc\u7684\u4ea4\u6d41\u4e0e\u4e92\u52a8\u3002) )<br \/>\n<!--more--><br \/>\n[erl]-module(town).<br \/>\n-behaviour(gen_server).<\/p>\n<p>%% API<br \/>\n-export([start\/0,combine\/1]).<\/p>\n<p>%% gen_server callbacks<br \/>\n-export([init\/1, handle_call\/3, handle_cast\/2, handle_info\/2,<br \/>\nterminate\/2, code_change\/3]).<br \/>\n-record(state, {port}).<\/p>\n<p>start() -&amp;gt;<br \/>\n  gen_server:start_link({global, ?MODULE}, ?MODULE, [], []).<br \/>\nstop() -&amp;gt;<br \/>\n  gen_server:cast(?SERVER, stop).<br \/>\ninit([]) -&amp;gt;<br \/>\n  process_flag(trap_exit, true),<br \/>\n  Port = open_port({spawn, &quot;python -u \/home\/freefis\/Desktop\/town.py&quot;},[stream,{line, 1024}]),<br \/>\n  {ok, #state{port = Port}}.<\/p>\n<p>handle_call({combine,String}, _From, #state{port = Port} = State) -&amp;gt;<br \/>\n  port_command(Port,String),<br \/>\n  receive<br \/>\n    {Port,{data,{_Flag,Data}}} -&amp;gt;<br \/>\n      io:format(&quot;receiving:~p~n&quot;,[Data]),<br \/>\n      sleep(2000),<br \/>\n      {reply, Data, Port}<br \/>\n  end.<br \/>\nhandle_cast(stop, State) -&amp;gt;<br \/>\n  {stop, normal, State};<br \/>\nhandle_cast(_Msg, State) -&amp;gt;<br \/>\n  {noreply, State}.<\/p>\n<p>handle_info(Info, State) -&amp;gt;<br \/>\n  {noreply,State}.<\/p>\n<p>terminate(_Reason, Port) -&amp;gt;<br \/>\n  ok.<\/p>\n<p>code_change(_OldVsn, State, _Extra) -&amp;gt;<br \/>\n  {ok, State}.<\/p>\n<p>%%&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8211;<br \/>\n%%% Internal &#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;&#8212;<br \/>\ncombine(_String) -&amp;gt;<br \/>\n  start(),<br \/>\n  String = list_to_binary(&quot;combine|&quot;++_String++&quot;\\n&quot;),<br \/>\n  gen_server:call(?SERVER,{combine,String},infinity),<br \/>\n  stop().[\/erl]<br \/>\n\u8fd9\u6bb5\u662fPython\u7684\u811a\u672c \u5f53erlang\u4e2dtown:combine(&#8220;sentence1+sentence2&#8221;)\u6267\u884c\u65f6\uff0c\u4f1a\u5728\u540e\u53f0\u542f\u52a8python\u7684\u811a\u672c\uff0c\u5904\u7406\u5b8c\u6bd5\u540e\u8fd4\u56de\u7ed9Erlang\u7ed3\u679c:sentence1sentence2\uff0c\u7136\u540e\u9000\u51fa\u3002 <\/p>\n<pre data-enlighter-language=\"python\" class=\"EnlighterJSRAW\">\r\nimport sys\r\ndef handle(_string):\r\n    if _string.startswith(&quot;combine|&quot;):\r\n        string = &quot;&quot;.join( _string[8:].split(&quot;,&quot;))\r\n        return string\r\n\r\n&quot;&quot;&quot;waiting for input &quot;&quot;&quot;\r\nwhile 1:\r\n    # Recv. Binary Stream as Standard IN\r\n    _stream = sys.stdin.readline()\r\n\r\nif not _stream: break\r\n    # Scheme, Turn into  Formal String\r\n    inString  = _stream.strip(&quot;\\r\\n&quot;)\r\n    # handle String\r\n    outString = handle(inString)\r\n    # send to port as Standart OUT\r\n    sys.stdout.write(&quot;%s\\n&quot; % (outString,))\r\n    sys.exit(0)<\/pre>\n","raw":"","protected":false},"excerpt":{"rendered":"<p>\u6700\u8fd1\u5f00\u53d1 Erlang ,\u5bf9\u5176\u5b57\u7b26\u4e32\u5904\u7406\u80fd\u529b\u65e0\u8a00\u81f3\u6781,\u4e8e\u662f\u51b3\u5b9a\u628a\u5b83\u548cpython\u8054\u5408\u8d77\u6765,\u6253\u9020\u4e00\u4e2a\u5f3a\u529b\u7684\u5206\u5e03\u5f0f\u7cfb\u7edf,\u7b49\u5c06\u6765\u9700\u8981\u7cfb\u7edf\u7ea7\u5f00\u53d1\u65f6,\u6211\u518d\u628a C++\/C\u7ec4&#8230;<\/p>\n<p class=\"read-more\"><a class=\"btn btn-default\" href=\"https:\/\/coolshell.cn\/articles\/1313.html\"> Read More<span class=\"screen-reader-text\">  Read More<\/span><\/a><\/p>\n","protected":false},"author":51,"featured_media":0,"comment_status":"open","ping_status":"open","sticky":false,"template":"","format":"standard","meta":[],"categories":[186,33,3],"tags":[792,791],"series":[],"aioseo_notices":[],"views":16320,"post_thumbnail_image":"","content_first_image":"","post_medium_image_300":"","post_thumbnail_image_624":"","post_frist_image":"","post_medium_image":"","post_large_image":"","post_full_image":"","post_all_images":[],"videoAdId":"","listAd":"0","listAdId":"","listAdEvery":5,"total_comments":5,"category_name":"Erlang","post_date":"2009-08-24","like_count":"0","praiseWord":"\u9f13\u52b1","excitationAd":"0","rewardedVideoAdId":"","detailAdId":"","detailAd":"0","enterpriseMinapp":"0","audios":[],"postImageUrl":"http:\/\/coolshell.cn\/wp-content\/uploads\/2016\/09\/coolshell-360x200.jpg","avatarurls":[],"related_posts":[],"pageviews":16321,"pageviews_wl":13998,"ratings_average":2,"ratings_total":25,"ratings_users":9,"next_post_id":1375,"next_post_title":"\u521d\u5b66C#\u7f16\u7a0b\u7684\u6ce8\u610f\u4e8b\u9879","previous_post_id":1252,"previous_post_title":"G1\u65b0\u578b\u5783\u573e\u56de\u6536\u5668\u4e00\u77a5"}