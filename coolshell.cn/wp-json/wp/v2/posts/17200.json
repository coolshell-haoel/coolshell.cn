{"id":17200,"date":"2015-08-26T08:21:09","date_gmt":"2015-08-26T00:21:09","guid":{"rendered":"http:\/\/coolshell.cn\/?p=17200"},"modified":"2015-08-27T09:21:11","modified_gmt":"2015-08-27T01:21:11","slug":"docker%e5%9f%ba%e7%a1%80%e6%8a%80%e6%9c%af%ef%bc%9adevicemapper","status":"publish","type":"post","link":"https:\/\/coolshell.cn\/articles\/17200.html","title":{"rendered":"Docker\u57fa\u7840\u6280\u672f\uff1aDeviceMapper"},"content":{"rendered":"<p><img decoding=\"async\" loading=\"lazy\" class=\"alignright size-medium wp-image-17217\" src=\"https:\/\/coolshell.cn\/wp-content\/uploads\/2015\/08\/how_to_set_up_an_iSCSI_LUN_with_thin-300x150.jpg\" alt=\"how_to_set_up_an_iSCSI_LUN_with_thin\" width=\"300\" height=\"150\" srcset=\"https:\/\/coolshell.cn\/wp-content\/uploads\/2015\/08\/how_to_set_up_an_iSCSI_LUN_with_thin-300x150.jpg 300w, https:\/\/coolshell.cn\/wp-content\/uploads\/2015\/08\/how_to_set_up_an_iSCSI_LUN_with_thin-540x270.jpg 540w, https:\/\/coolshell.cn\/wp-content\/uploads\/2015\/08\/how_to_set_up_an_iSCSI_LUN_with_thin.jpg 600w\" sizes=\"(max-width: 300px) 100vw, 300px\" \/>\u5728\u4e0a\u4e00\u7bc7<a href=\"https:\/\/coolshell.cn\/articles\/17061.html\" target=\"_blank\">\u4ecb\u7ecdAUFS\u7684\u6587\u7ae0<\/a>\u4e2d\uff0c\u5927\u5bb6\u53ef\u4ee5\u770b\u5230\uff0cDocker\u7684\u5206\u5c42\u955c\u50cf\u662f\u600e\u4e48\u901a\u8fc7UnionFS\u8fd9\u79cd\u6587\u4ef6\u7cfb\u7edf\u505a\u5230\u7684\uff0c\u4f46\u662f\uff0c\u56e0\u4e3aDocker\u9996\u9009\u7684AUFS\u5e76\u4e0d\u5728Linux\u7684\u5185\u6838\u4e3b\u5e72\u91cc\uff0c\u6240\u4ee5\uff0c\u5bf9\u4e8e\u975eUbuntu\u7684Linux\u5206\u53d1\u5305\uff0c\u6bd4\u5982CentOS\uff0c\u5c31\u65e0\u6cd5\u4f7f\u7528AUFS\u4f5c\u4e3aDocker\u7684\u6587\u4ef6\u7cfb\u7edf\u4e86\u3002\u4e8e\u662f\u4f5c\u4e3a\u7b2c\u4e8c\u4f18\u5148\u7ea7\u7684DeviceMapper\u5c31\u88ab\u62ff\u51fa\u6765\u505a\u5206\u5c42\u955c\u50cf\u7684\u4e00\u4e2a\u5b9e\u73b0\u3002<\/p>\n<div id=\"ez-toc-container\" class=\"ez-toc-v2_0_48 counter-hierarchy ez-toc-counter ez-toc-grey ez-toc-container-direction\">\n<div class=\"ez-toc-title-container\">\n<p class=\"ez-toc-title\">\u76ee\u5f55<\/p>\n<span class=\"ez-toc-title-toggle\"><\/span><\/div>\n<nav><ul class='ez-toc-list ez-toc-list-level-1 ' ><li class='ez-toc-page-1 ez-toc-heading-level-4'><a class=\"ez-toc-link ez-toc-heading-1\" href=\"https:\/\/coolshell.cn\/articles\/17200.html\/#Device_Mapper_%E7%AE%80%E4%BB%8B\" title=\"Device Mapper \u7b80\u4ecb\">Device Mapper \u7b80\u4ecb<\/a><\/li><li class='ez-toc-page-1 ez-toc-heading-level-4'><a class=\"ez-toc-link ez-toc-heading-2\" href=\"https:\/\/coolshell.cn\/articles\/17200.html\/#Thin_Provisioning_%E7%AE%80%E4%BB%8B\" title=\"Thin Provisioning \u7b80\u4ecb\">Thin Provisioning \u7b80\u4ecb<\/a><\/li><li class='ez-toc-page-1 ez-toc-heading-level-4'><a class=\"ez-toc-link ez-toc-heading-3\" href=\"https:\/\/coolshell.cn\/articles\/17200.html\/#Thin_Provisioning_Snapshot_%E6%BC%94%E7%A4%BA\" title=\"Thin Provisioning Snapshot \u6f14\u793a\">Thin Provisioning Snapshot \u6f14\u793a<\/a><\/li><li class='ez-toc-page-1 ez-toc-heading-level-4'><a class=\"ez-toc-link ez-toc-heading-4\" href=\"https:\/\/coolshell.cn\/articles\/17200.html\/#Docker%E7%9A%84DeviceMapper\" title=\"Docker\u7684DeviceMapper\">Docker\u7684DeviceMapper<\/a><\/li><li class='ez-toc-page-1 ez-toc-heading-level-4'><a class=\"ez-toc-link ez-toc-heading-5\" href=\"https:\/\/coolshell.cn\/articles\/17200.html\/#Device_Mapper_%E8%A1%8C%E4%B8%8D%E8%A1%8C%EF%BC%9F\" title=\"Device Mapper\u00a0\u884c\u4e0d\u884c\uff1f\">Device Mapper\u00a0\u884c\u4e0d\u884c\uff1f<\/a><\/li><\/ul><\/nav><\/div>\n<h4><span class=\"ez-toc-section\" id=\"Device_Mapper_%E7%AE%80%E4%BB%8B\"><\/span>Device Mapper \u7b80\u4ecb<span class=\"ez-toc-section-end\"><\/span><\/h4>\n<p>DeviceMapper\u81eaLinux 2.6\u88ab\u5f15\u5165\u6210\u4e3a\u4e86Linux\u6700\u91cd\u8981\u7684\u4e00\u4e2a\u6280\u672f\u3002\u5b83\u5728\u5185\u6838\u4e2d\u652f\u6301\u903b\u8f91\u5377\u7ba1\u7406\u7684\u901a\u7528\u8bbe\u5907\u6620\u5c04\u673a\u5236\uff0c\u5b83\u4e3a\u5b9e\u73b0\u7528\u4e8e\u5b58\u50a8\u8d44\u6e90\u7ba1\u7406\u7684\u5757\u8bbe\u5907\u9a71\u52a8\u63d0\u4f9b\u4e86\u4e00\u4e2a\u9ad8\u5ea6\u6a21\u5757\u5316\u7684\u5185\u6838\u67b6\u6784\uff0c\u5b83\u5305\u542b\u4e09\u4e2a\u91cd\u8981\u7684\u5bf9\u8c61\u6982\u5ff5\uff0cMapped Device\u3001Mapping Table\u3001Target device\u3002<\/p>\n<p>Mapped Device \u662f\u4e00\u4e2a\u903b\u8f91\u62bd\u8c61\uff0c\u53ef\u4ee5\u7406\u89e3\u6210\u4e3a\u5185\u6838\u5411\u5916\u63d0\u4f9b\u7684\u903b\u8f91\u8bbe\u5907\uff0c\u5b83\u901a\u8fc7Mapping Table\u63cf\u8ff0\u7684\u6620\u5c04\u5173\u7cfb\u548c Target Device \u5efa\u7acb\u6620\u5c04\u3002Target device \u8868\u793a\u7684\u662f Mapped Device \u6240\u6620\u5c04\u7684\u7269\u7406\u7a7a\u95f4\u6bb5\uff0c\u5bf9 Mapped Device \u6240\u8868\u793a\u7684\u903b\u8f91\u8bbe\u5907\u6765\u8bf4\uff0c\u5c31\u662f\u8be5\u903b\u8f91\u8bbe\u5907\u6620\u5c04\u5230\u7684\u4e00\u4e2a\u7269\u7406\u8bbe\u5907\u3002<\/p>\n<p>Mapping Table\u91cc\u6709\u00a0Mapped Device \u903b\u8f91\u7684\u8d77\u59cb\u5730\u5740\u3001\u8303\u56f4\u3001\u548c\u8868\u793a\u5728 Target Device \u6240\u5728\u7269\u7406\u8bbe\u5907\u7684\u5730\u5740\u504f\u79fb\u91cf\u4ee5\u53caTarget \u7c7b\u578b\u7b49\u4fe1\u606f\uff08\u6ce8\uff1a\u8fd9\u4e9b\u5730\u5740\u548c\u504f\u79fb\u91cf\u90fd\u662f\u4ee5\u78c1\u76d8\u7684\u6247\u533a\u4e3a\u5355\u4f4d\u7684\uff0c\u5373 512 \u4e2a\u5b57\u8282\u5927\u5c0f\uff0c\u6240\u4ee5\uff0c\u5f53\u4f60\u770b\u5230128\u7684\u65f6\u5019\uff0c\u5176\u5b9e\u8868\u793a\u7684\u662f128*512=64K\uff09\u3002<\/p>\n<p><!--more--><\/p>\n<p>DeviceMapper \u4e2d\u7684\u903b\u8f91\u8bbe\u5907Mapped Device\u4e0d\u4f46\u53ef\u4ee5\u6620\u5c04\u4e00\u4e2a\u6216\u591a\u4e2a\u7269\u7406\u8bbe\u5907Target Device\uff0c\u8fd8\u53ef\u4ee5\u6620\u5c04\u53e6\u4e00\u4e2aMapped Device\uff0c\u4e8e\u662f\uff0c\u5c31\u662f\u6784\u6210\u4e86\u4e00\u4e2a\u8fed\u4ee3\u6216\u9012\u5f52\u7684\u60c5\u51b5\uff0c\u5c31\u50cf\u6587\u4ef6\u7cfb\u7edf\u4e2d\u7684\u76ee\u5f55\u91cc\u9664\u4e86\u6587\u4ef6\u8fd8\u53ef\u4ee5\u6709\u76ee\u5f55\uff0c\u7406\u8bba\u4e0a\u53ef\u4ee5\u65e0\u9650\u5d4c\u5957\u4e0b\u53bb\u3002<\/p>\n<p>DeviceMapper\u5728\u5185\u6838\u4e2d\u901a\u8fc7\u4e00\u4e2a\u4e00\u4e2a\u6a21\u5757\u5316\u7684 Target Driver \u63d2\u4ef6\u5b9e\u73b0\u5bf9 IO \u8bf7\u6c42\u7684\u8fc7\u6ee4\u6216\u8005\u91cd\u65b0\u5b9a\u5411\u7b49\u5de5\u4f5c\uff0c\u5f53\u524d\u5df2\u7ecf\u5b9e\u73b0\u7684\u63d2\u4ef6\u5305\u62ec\u8f6f Raid\u3001\u52a0\u5bc6\u3001\u591a\u8def\u5f84\u3001\u955c\u50cf\u3001\u5feb\u7167\u7b49\uff0c\u8fd9\u4f53\u73b0\u4e86\u5728 Linux \u5185\u6838\u8bbe\u8ba1\u4e2d\u7b56\u7565\u548c\u673a\u5236\u5206\u79bb\u7684\u539f\u5219\u3002\u5982\u4e0b\u56fe\u6240\u793a\u3002\u4ece\u56fe\u4e2d\uff0c\u6211\u4eec\u53ef\u4ee5<strong>\u770b\u5230DeviceMapper\u53ea\u662f\u4e00\u4e2a\u6846\u67b6\uff0c\u5728\u8fd9\u4e2a\u6846\u67b6\u4e0a\uff0c\u6211\u4eec\u53ef\u4ee5\u63d2\u5165\u5404\u79cd\u5404\u6837\u7684\u7b56\u7565<\/strong>\uff08\u8ba9\u6211\u4e0d\u81ea\u7136\u5730\u60f3\u5230\u4e86\u9762\u5411\u5bf9\u8c61\u4e2d\u7684\u7b56\u7565\u6a21\u5f0f\uff09\uff0c\u5728\u8fd9\u8bf8\u591a\u201c\u63d2\u4ef6\u201d\u4e2d\uff0c<strong>\u6709\u4e00\u4e2a\u4e1c\u897f\u53ebThin Provisioning Snapshot\uff0c\u8fd9\u662fDocker\u4f7f\u7528DeviceMapper\u4e2d\u6700\u91cd\u8981\u7684\u6a21\u5757<\/strong>\u3002<\/p>\n<figure id=\"attachment_17204\" aria-describedby=\"caption-attachment-17204\" style=\"width: 640px\" class=\"wp-caption aligncenter\"><img decoding=\"async\" loading=\"lazy\" class=\"size-full wp-image-17204\" src=\"https:\/\/coolshell.cn\/wp-content\/uploads\/2015\/08\/device.mapper.2.gif\" alt=\"\u56fe\u7247\u6765\u6e90\uff1ahttp:\/\/people.redhat.com\/agk\/talks\/FOSDEM_2005\/\" width=\"640\" height=\"494\" \/><figcaption id=\"caption-attachment-17204\" class=\"wp-caption-text\">\u56fe\u7247\u6765\u6e90\uff1a<a href=\"http:\/\/people.redhat.com\/agk\/talks\/FOSDEM_2005\/\" target=\"_blank\">http:\/\/people.redhat.com\/agk\/talks\/FOSDEM_2005\/<\/a><\/figcaption><\/figure>\n<h4><span class=\"ez-toc-section\" id=\"Thin_Provisioning_%E7%AE%80%E4%BB%8B\"><\/span><strong>Thin Provisioning \u7b80\u4ecb<\/strong><span class=\"ez-toc-section-end\"><\/span><\/h4>\n<p>Thin Provisioning\u8981\u600e\u4e48\u7ffb\u8bd1\u6210\u4e2d\u6587\uff0c\u771f\u662f\u4e00\u4ef6\u4ee4\u4eba\u5934\u75db\u7684\u4e8b\uff0c\u6211\u5c31\u4e0d\u7ffb\u8bd1\u4e86\u3002\u8fd9\u4e2a\u6280\u672f\u662f\u865a\u62df\u5316\u6280\u672f\u4e2d\u7684\u4e00\u79cd\u3002\u5b83\u662f\u4ec0\u4e48\u610f\u601d\u5462\uff1f<strong>\u4f60\u53ef\u4ee5\u8054\u60f3\u4e00\u4e0b\u6211\u4eec\u8ba1\u7b97\u673a\u4e2d\u7684\u5185\u5b58\u7ba1\u7406\u4e2d\u7528\u5230\u7684\u2014\u2014\u201c\u865a\u62df\u5185\u5b58\u6280\u672f\u201d<\/strong>\u2014\u2014\u64cd\u4f5c\u7cfb\u7edf\u7ed9\u6bcf\u4e2a\u8fdb\u7a0bN\u591aN\u591a\u7528\u4e0d\u5b8c\u7684\u5185\u5740\u5730\u5740\uff0832\u4f4d\u4e0b\uff0c\u6bcf\u4e2a\u8fdb\u7a0b\u53ef\u4ee5\u6709\u6700\u591a2GB\u7684\u5185\u5b58\u7a7a\u95f4\uff09\uff0c\u4f46\u662f\u5462\uff0c\u6211\u4eec\u77e5\u9053\uff0c\u7269\u7406\u5185\u5b58\u662f\u6ca1\u6709\u90a3\u4e48\u591a\u7684\uff0c\u5982\u679c\u6309\u7167\u8fdb\u7a0b\u5185\u5b58\u548c\u7269\u7406\u5185\u5b58\u4e00\u4e00\u6620\u5c04\u6765\u73a9\u7684\u8bdd\uff0c\u90a3\u4e48\uff0c\u6211\u4eec\u5f97\u8981\u591a\u5c11\u7684\u7269\u7406\u5185\u5b58\u554a\u3002\u6240\u4ee5\uff0c\u64cd\u4f5c\u7cfb\u7edf\u5f15\u5165\u4e86\u865a\u62df\u5185\u5b58\u7684\u8bbe\u8ba1\uff0c<strong>\u610f\u601d\u662f\uff0c\u6211\u903b\u8f91\u4e0a\u7ed9\u4f60\u65e0\u9650\u591a\u7684\u5185\u5b58\uff0c\u4f46\u662f\u5b9e\u9645\u4e0a\u662f\u5b9e\u62a5\u5b9e\u9500<\/strong>\uff0c\u56e0\u4e3a\u6211\u77e5\u9053\u4f60\u4e00\u5b9a\u7528\u4e0d\u4e86\u90a3\u4e48\u591a\uff0c\u4e8e\u662f\uff0c\u8fbe\u5230\u4e86\u5185\u5b58\u4f7f\u7528\u7387\u63d0\u9ad8\u7684\u6548\u679c\u3002\uff08\u4eca\u5929\u4e91\u8ba1\u7b97\u4e2d\u5f88\u591a\u6240\u8c13\u7684\u865a\u62df\u5316\u5176\u5b9e\u5b8c\u5168\u90fd\u662f\u5728\u7528\u548c\u201c\u865a\u62df\u5185\u5b58\u201d\u76f8\u4f3c\u7684Thin Provisioning\u7684\u6280\u672f\uff0c\u6240\u8c13\u7684\u8d85\u914d\uff0c\u6216\u662f\u8d85\u5356\uff09<\/p>\n<p>&nbsp;<\/p>\n<p>\u597d\u4e86\uff0c\u8bdd\u9898\u62c9\u56de\u6765\uff0c\u6211\u4eec\u8fd9\u91cc\u8bf4\u7684\u662f\u5b58\u50a8\u3002\u770b\u4e0b\u9762\u4e24\u4e2a\u56fe\uff08<a href=\"http:\/\/www.architecting.it\/2009\/06\/04\/enterprise-computing-why-thin-provisioning-is-not-the-holy-grail-for-utilisation\/\" target=\"_blank\">\u56fe\u7247\u6765\u6e90<\/a>\uff09\uff0c\u7b2c\u4e00\u4e2a\u662fFat Provisioning\uff0c\u7b2c\u4e8c\u4e2a\u662fThin Provisioning\uff0c\u5176\u5f88\u597d\u7684\u8bf4\u660e\u4e86\u662f\u4e2a\u600e\u4e48\u4e00\u56de\u4e8b\uff08\u548c\u865a\u62df\u5185\u5b58\u662f\u4e00\u4e2a\u6982\u5ff5\uff09<\/p>\n<p><img decoding=\"async\" loading=\"lazy\" class=\"aligncenter size-full wp-image-17206\" src=\"https:\/\/coolshell.cn\/wp-content\/uploads\/2015\/08\/thin-provisioning-1.jpg\" alt=\"thin-provisioning-1\" width=\"606\" height=\"399\" srcset=\"https:\/\/coolshell.cn\/wp-content\/uploads\/2015\/08\/thin-provisioning-1.jpg 606w, https:\/\/coolshell.cn\/wp-content\/uploads\/2015\/08\/thin-provisioning-1-300x198.jpg 300w\" sizes=\"(max-width: 606px) 100vw, 606px\" \/> <img decoding=\"async\" loading=\"lazy\" class=\"aligncenter size-full wp-image-17207\" src=\"https:\/\/coolshell.cn\/wp-content\/uploads\/2015\/08\/thin-provisioning-2.jpg\" alt=\"thin-provisioning-2\" width=\"606\" height=\"389\" srcset=\"https:\/\/coolshell.cn\/wp-content\/uploads\/2015\/08\/thin-provisioning-2.jpg 606w, https:\/\/coolshell.cn\/wp-content\/uploads\/2015\/08\/thin-provisioning-2-300x193.jpg 300w\" sizes=\"(max-width: 606px) 100vw, 606px\" \/><\/p>\n<p>\u90a3\u4e48\uff0cDocker\u662f\u600e\u4e48\u4f7f\u7528Thin Provisioning\u8fd9\u4e2a\u6280\u672f\u505a\u5230\u50cfUnionFS\u90a3\u6837\u7684\u5206\u5c42\u955c\u50cf\u7684\u5462\uff1f\u7b54\u6848\u662f\uff0cDocker\u4f7f\u7528\u4e86Thin Provisioning\u7684Snapshot\u7684\u6280\u672f\u3002\u4e0b\u9762\u6211\u4eec\u6765\u4ecb\u7ecd\u4e00\u4e0bThin Provisioning\u7684Snapshot\u3002<\/p>\n<h4><span class=\"ez-toc-section\" id=\"Thin_Provisioning_Snapshot_%E6%BC%94%E7%A4%BA\"><\/span>Thin Provisioning Snapshot \u6f14\u793a<span class=\"ez-toc-section-end\"><\/span><\/h4>\n<p>\u4e0b\u9762\uff0c\u6211\u4eec\u7528\u4e00\u7cfb\u5217\u7684\u547d\u4ee4\u6765\u6f14\u793a\u4e00\u4e0bDevice Mapper\u7684Thin Provisioning Snapshot\u662f\u600e\u4e48\u73a9\u7684\u3002<\/p>\n<p>\u9996\u5148\uff0c\u6211\u4eec\u9700\u8981\u5148\u5efa\u4e24\u4e2a\u6587\u4ef6\uff0c\u4e00\u4e2a\u662fdata.img\uff0c\u4e00\u4e2a\u662fmeta.data.img\uff1a<\/p>\n<pre data-enlighter-language=\"shell\" class=\"EnlighterJSRAW\">~hchen$ sudo dd if=\/dev\/zero of=\/tmp\/data.img bs=1K count=1 seek=10M\r\n1+0 records in\r\n1+0 records out\r\n1024 bytes (1.0 kB) copied, 0.000621428 s, 1.6 MB\/s\r\n\r\n~hchen$ sudo dd if=\/dev\/zero of=\/tmp\/meta.data.img bs=1K count=1 seek=1G\r\n1+0 records in\r\n1+0 records out\r\n1024 bytes (1.0 kB) copied, 0.000140858 s, 7.3 MB\/s<\/pre>\n<p>\u6ce8\u610f\u547d\u4ee4\u4e2d<code>seek<\/code>\u9009\u9879\uff0c\u5176\u8868\u793a\u4e3a\u7565\u8fc7<code>of<\/code>\u9009\u9879\u6307\u5b9a\u7684\u8f93\u51fa\u6587\u4ef6\u7684\u524d10G\u4e2aoutput\u7684bloksize\u7684\u7a7a\u95f4\u540e\u518d\u5199\u5165\u5185\u5bb9\u3002\u56e0\u4e3abs\u662f1\u4e2a\u5b57\u8282\uff0c\u6240\u4ee5\u4e5f\u5c31\u662f10G\u7684\u5c3a\u5bf8\uff0c\u4f46\u5176\u5b9e\u5728\u786c\u76d8\u4e0a\u662f\u6ca1\u6709\u5360\u6709\u7a7a\u95f4\u7684\uff0c\u5360\u6709\u7a7a\u95f4\u53ea\u67091k\u7684\u5185\u5bb9\u3002\u5f53\u5411\u5176\u5199\u5165\u5185\u5bb9\u65f6\uff0c\u624d\u4f1a\u5728\u786c\u76d8\u4e0a\u4e3a\u5176\u5206\u914d\u7a7a\u95f4\u3002\u6211\u4eec\u53ef\u4ee5\u7528ls\u547d\u4ee4\u770b\u4e00\u4e0b\uff0c\u5b9e\u9645\u5206\u914d\u4e8612K\u548c4K\u3002<\/p>\n<pre data-enlighter-language=\"shell\" class=\"EnlighterJSRAW\">~hchen$ sudo ls -lsh \/tmp\/data.img\r\n12K -rw-r--r--. 1 root root 11G Aug 25 23:01 \/tmp\/data.img\r\n\r\n~hchen$ sudo ls -slh \/tmp\/meta.data.img\r\n4.0K -rw-r--r--. 1 root root 101M Aug 25 23:17 \/tmp\/meta.data.img<\/pre>\n<p>\u7136\u540e\uff0c\u6211\u4eec\u4e3a\u8fd9\u4e2a\u6587\u4ef6\u521b\u5efa\u4e00\u4e2aloopback\u8bbe\u5907\u3002\uff08loop2015\u548cloop2016\u662f\u6211\u4e71\u53d6\u7684\u4e24\u4e2a\u540d\u5b57\uff09<\/p>\n<pre data-enlighter-language=\"shell\" class=\"EnlighterJSRAW\">~hchen$ sudo losetup \/dev\/loop2015 \/tmp\/data.img\r\n~hchen$ sudo losetup \/dev\/loop2016 \/tmp\/meta.data.img\r\n\r\n~hchen$ sudo losetup -a\r\n\/dev\/loop2015: [64768]:103991768 (\/tmp\/data.img)\r\n\/dev\/loop2016: [64768]:103991765 (\/tmp\/meta.data.img)<\/pre>\n<p>\u73b0\u5728\uff0c\u6211\u4eec\u4e3a\u8fd9\u4e2a\u8bbe\u5907\u5efa\u4e00\u4e2aThin Provisioning\u7684Pool\uff0c\u7528dmsetup\u547d\u4ee4\uff1a<\/p>\n<pre data-enlighter-language=\"shell\" class=\"EnlighterJSRAW\">~hchen$ sudo dmsetup create hchen-thin-pool \\\r\n                  --table &quot;0 20971522 thin-pool \/dev\/loop2016 \/dev\/loop2015 \\\r\n                           128 65536 1 skip_block_zeroing&quot;<\/pre>\n<p>\u5176\u4e2d\u7684\u53c2\u6570\u89e3\u91ca\u5982\u4e0b\uff08\u66f4\u591a\u4fe1\u606f\u53ef\u53c2\u770b<a href=\"https:\/\/github.com\/torvalds\/linux\/blob\/master\/Documentation\/device-mapper\/thin-provisioning.txt\" target=\"_blank\">Thin Provisioning\u7684man page<\/a>\uff09\uff1a<\/p>\n<ul>\n<li>dmsetup create\u662f\u7528\u6765\u521b\u5efathin pool\u7684\u547d\u4ee4<\/li>\n<li>hchen-thin-pool \u662f\u81ea\u5b9a\u4e49\u7684\u4e00\u4e2apool\u540d\uff0c\u4e0d\u51b2\u7a81\u5c31\u597d\u3002<\/li>\n<li>&#8211;table\u662f\u8fd9\u4e2apool\u7684\u53c2\u6570\u8bbe\u7f6e\n<ul>\n<li>0\u4ee3\u8868\u8d77\u7684sector\u4f4d\u7f6e<\/li>\n<li>20971522\u4ee3\u7801\u7ed3\u53e5\u7684sector\u53f7\uff0c\u524d\u9762\u8bf4\u8fc7\uff0c\u4e00\u4e2asector\u662f512\u5b57\u8282\uff0c\u6240\u4ee5\uff0c20971522\u4e2a\u6b63\u597d\u662f10GB<\/li>\n<li>\/dev\/loop2016\u662fmeta\u6587\u4ef6\u7684\u8bbe\u5907\uff08\u524d\u9762\u6211\u4eec\u5efa\u597d\u4e86\uff09<\/li>\n<li>\/dev\/loop2015\u662fdata\u6587\u4ef6\u7684\u8bbe\u5907\uff08\u524d\u9762\u6211\u4eec\u5efa\u597d\u4e86\uff09<\/li>\n<li>128\u662f\u6700\u5c0f\u7684\u53ef\u5206\u914d\u7684sector\u6570<\/li>\n<li>65536\u662f\u6700\u5c11\u53ef\u7528sector\u7684water mark\uff0c\u4e5f\u5c31\u662f\u4e00\u4e2athreshold<\/li>\n<li>1 \u4ee3\u8868\u6709\u4e00\u4e2a\u9644\u52a0\u53c2\u6570<\/li>\n<li>skip_block_zeroing\u662f\u4e2a\u9644\u52a0\u53c2\u6570\uff0c\u8868\u793a\u7565\u8fc7\u75280\u586b\u5145\u7684\u5757<\/li>\n<\/ul>\n<\/li>\n<\/ul>\n<p>\u7136\u540e\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u770b\u5230\u4e00\u4e2aDevice Mapper\u7684\u8bbe\u5907\u4e86\uff1a<\/p>\n<pre data-enlighter-language=\"shell\" class=\"EnlighterJSRAW\">~hchen$ sudo ll \/dev\/mapper\/hchen-thin-pool\r\nlrwxrwxrwx. 1 root root 7 Aug 25 23:24 \/dev\/mapper\/hchen-thin-pool -&gt; ..\/dm-4<\/pre>\n<p>\u63a5\u4e0b\u6765\uff0c\u6211\u4eec\u7684\u521d\u59cb\u8fd8\u6ca1\u6709\u5b8c\u6210\uff0c\u8fd8\u8981\u521b\u5efa\u4e00\u4e2aThin Provisioning \u7684 Volume\uff1a<\/p>\n<pre data-enlighter-language=\"shell\" class=\"EnlighterJSRAW\">~hchen$ sudo dmsetup message \/dev\/mapper\/hchen-thin-pool 0 &quot;create_thin 0&quot;\r\n~hchen$ sudo dmsetup create hchen-thin-volumn-001 \\\r\n            --table &quot;0 2097152 thin \/dev\/mapper\/hchen-thin-pool 0&quot;<\/pre>\n<p>\u5176\u4e2d\uff1a<\/p>\n<ul>\n<li>\u7b2c\u4e00\u4e2a\u547d\u4ee4\u4e2d\u7684create_thin\u662f\u5173\u952e\u5b57\uff0c\u540e\u9762\u76840\u8868\u793a\u8fd9\u4e2aVolume\u7684device \u7684 id<\/li>\n<li>\u7b2c\u4e8c\u4e2a\u547d\u4ee4\uff0c\u662f\u771f\u6b63\u7684\u4e3a\u8fd9\u4e2aVolumn\u521b\u5efa\u4e00\u4e2a\u53ef\u4ee5mount\u7684\u8bbe\u5907\uff0c\u540d\u5b57\u53ebhchen-thin-volumn-001\u30022097152\u53ea\u67091GB<\/li>\n<\/ul>\n<p>\u597d\u4e86\uff0c\u5728mount\u524d\uff0c\u6211\u4eec\u8fd8\u8981\u683c\u5f0f\u5316\u4e00\u4e0b\uff1a<\/p>\n<pre data-enlighter-language=\"shell\" class=\"EnlighterJSRAW\">~hchen$ sudo mkfs.ext4 \/dev\/mapper\/hchen-thin-volumn-001\r\nmke2fs 1.42.9 (28-Dec-2013)\r\nDiscarding device blocks: done\r\nFilesystem label=\r\nOS type: Linux\r\nBlock size=4096 (log=2)\r\nFragment size=4096 (log=2)\r\nStride=16 blocks, Stripe width=16 blocks\r\n65536 inodes, 262144 blocks\r\n13107 blocks (5.00%) reserved for the super user\r\nFirst data block=0\r\nMaximum filesystem blocks=268435456\r\n8 block groups\r\n32768 blocks per group, 32768 fragments per group\r\n8192 inodes per group\r\nSuperblock backups stored on blocks:\r\n32768, 98304, 163840, 229376\r\n\r\nAllocating group tables: done\r\nWriting inode tables: done\r\nCreating journal (8192 blocks): done\r\nWriting superblocks and filesystem accounting information: done<\/pre>\n<p>\u597d\u4e86\uff0c\u6211\u4eec\u53ef\u4ee5mount\u4e86\uff08\u4e0b\u9762\u7684\u547d\u4ee4\u4e2d\uff0c\u6211\u8fd8\u521b\u5efa\u4e86\u4e00\u4e2a\u6587\u4ef6\uff09<\/p>\n<pre data-enlighter-language=\"shell\" class=\"EnlighterJSRAW\">~hchen$ sudo mkdir -p \/mnt\/base\r\n~hchen$ sudo mount \/dev\/mapper\/hchen-thin-volumn-001 \/mnt\/base\r\n~hchen$ sudo echo &quot;hello world, I am a base&quot; &gt; \/mnt\/base\/id.txt\r\n~hchen$ sudo cat \/mnt\/base\/id.txt\r\nhello world, I am a base<\/pre>\n<p>\u597d\u4e86\uff0c\u63a5\u4e0b\u6765\uff0c\u6211\u4eec\u6765\u770b\u770bsnapshot\u600e\u4e48\u641e\uff1a<\/p>\n<pre data-enlighter-language=\"shell\" class=\"EnlighterJSRAW\">~hchen$ sudo dmsetup message \/dev\/mapper\/hchen-thin-pool 0 &quot;create_snap 1 0&quot;\r\n~hchen$ sudo dmsetup create mysnap1 \\\r\n                   --table &quot;0 2097152 thin \/dev\/mapper\/hchen-thin-pool 1&quot;\r\n\r\n~hchen$ sudo ll \/dev\/mapper\/mysnap1\r\nlrwxrwxrwx. 1 root root 7 Aug 25 23:49 \/dev\/mapper\/mysnap1 -&gt; ..\/dm-5<\/pre>\n<p>\u4e0a\u9762\u7684\u547d\u4ee4\u4e2d\uff1a<\/p>\n<ul>\n<li>\u7b2c\u4e00\u6761\u547d\u4ee4\u662f\u5411hchen-thin-pool\u53d1\u4e00\u4e2acreate_snap\u7684\u6d88\u606f\uff0c\u540e\u9762\u8ddf\u4e24\u4e2aid\uff0c\u7b2c\u4e00\u4e2a\u662f\u65b0\u7684dev id\uff0c\u7b2c\u4e8c\u4e2a\u662f\u8981\u4ece\u54ea\u4e2a\u5df2\u6709\u7684dev id\u4e0a\u505asnapshot\uff080\u8fd9\u4e2adev id\u662f\u6211\u4eec\u524d\u9762\u5c31\u521b\u5efa\u4e86\u4e86\uff09<\/li>\n<\/ul>\n<ul>\n<li>\u7b2c\u4e8c\u6761\u547d\u4ee4\u662f\u521b\u5efa\u4e00\u4e2amysnap1\u7684device\uff0c\u5e76\u53ef\u4ee5\u88abmount\u3002<\/li>\n<\/ul>\n<p>\u4e0b\u9762\u6211\u4eec\u6765\u770b\u770b\uff1a<\/p>\n<pre data-enlighter-language=\"shell\" class=\"EnlighterJSRAW\">~hchen$ sudo mkdir -p \/mnt\/mysnap1\r\n~hchen$ sudo mount \/dev\/mapper\/mysnap1 \/mnt\/mysnap1\r\n\r\n~hchen$ sudo ll \/mnt\/mysnap1\/\r\ntotal 20\r\n-rw-r--r--. 1 root root 25 Aug 25 23:46 id.txt\r\ndrwx------. 2 root root 16384 Aug 25 23:43 lost+found\r\n\r\n~hchen$ sudo cat \/mnt\/mysnap1\/id.txt\r\nhello world, I am a base<\/pre>\n<p>\u6211\u4eec\u6765\u4fee\u6539\u4e00\u4e0b\/mnt\/mysnap1\/id.txt\uff0c\u5e76\u52a0\u4e0a\u4e00\u4e2asnap1.txt\u7684\u6587\u4ef6\uff1a<\/p>\n<pre data-enlighter-language=\"shell\" class=\"EnlighterJSRAW\">~hchen$ sudo echo &quot;I am snap1&quot; &gt;&gt; \/mnt\/mysnap1\/id.txt\r\n~hchen$ sudo echo &quot;I am snap1&quot; &gt; \/mnt\/mysnap1\/snap1.txt\r\n\r\n~hchen$ sudo cat \/mnt\/mysnap1\/id.txt\r\nhello world, I am a base\r\nI am snap1\r\n\r\n~hchen$ sudo cat \/mnt\/mysnap1\/snap1.txt\r\nI am snap1<\/pre>\n<p>\u6211\u4eec\u518d\u770b\u4e00\u4e0b\/mnt\/base\uff0c\u4f60\u4f1a\u53d1\u73b0\u6ca1\u6709\u4ec0\u4e48\u53d8\u5316\uff1a<\/p>\n<pre data-enlighter-language=\"shell\" class=\"EnlighterJSRAW\">~hchen$ sudo ls \/mnt\/base\r\nid.txt      lost+found\r\n~hchen$ sudo cat \/mnt\/base\/id.txt\r\nhello world, I am a base<\/pre>\n<p>\u4f60\u662f\u4e0d\u662f\u5df2\u7ecf\u770b\u5230\u4e86\u5206\u5c42\u955c\u50cf\u7684\u6837\u5b50\u4e86\uff1f<\/p>\n<p>\u4f60\u8fd8\u8981\u5427\u7ee7\u7eed\u5728\u521a\u624d\u7684snapshot\u4e0a\u518d\u5efa\u4e00\u4e2asnapshot<\/p>\n<pre data-enlighter-language=\"shell\" class=\"EnlighterJSRAW\">~hchen$ sudo dmsetup message \/dev\/mapper\/hchen-thin-pool 0 &quot;create_snap 2 1&quot;\r\n~hchen$ sudo dmsetup create mysnap2 \\\r\n                   --table &quot;0 2097152 thin \/dev\/mapper\/hchen-thin-pool 2&quot;\r\n\r\n~hchen$ sudo ll \/dev\/mapper\/mysnap2\r\nlrwxrwxrwx. 1 root root 7 Aug 25 23:52 \/dev\/mapper\/mysnap1 -&gt; ..\/dm-7\r\n\r\n~hchen$ sudo mkdir -p \/mnt\/mysnap2\r\n~hchen$ sudo mount \/dev\/mapper\/mysnap2 \/mnt\/mysnap2\r\n~hchen$ sudo  ls \/mnt\/mysnap2\r\nid.txt  lost+found  snap1.txt <\/pre>\n<p>\u597d\u4e86\uff0c\u6211\u76f8\u4fe1\u4f60\u770b\u5230\u4e86\u5206\u5c42\u955c\u50cf\u7684\u6837\u5b50\u4e86\u3002<\/p>\n<p>\u770b\u5b8c\u6f14\u793a\uff0c\u6211\u4eec\u518d\u6765\u8865\u70b9\u7406\u8bba\u77e5\u8bc6\u5427\uff1a<\/p>\n<ul>\n<li>Snapshot\u6765\u81eaLVM\uff08Logic Volumn Manager\uff09\uff0c\u5b83\u53ef\u4ee5\u5728\u4e0d\u4e2d\u65ad\u670d\u52a1\u7684\u60c5\u51b5\u4e0b\u4e3a\u67d0\u4e2adevice\u6253\u4e00\u4e2a\u5feb\u7167\u3002<\/li>\n<li>Snapshot\u662fCopy-On-Write\u7684\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0c\u53ea\u6709\u53d1\u751f\u4e86\u4fee\u6539\uff0c\u624d\u4f1a\u5bf9\u5bf9\u5e94\u7684\u5185\u5b58\u8fdb\u884c\u62f7\u8d1d\u3002<\/li>\n<\/ul>\n<p>\u53e6\u5916\uff0c\u8fd9\u91cc\u6709\u7bc7\u6587\u7ae0<a href=\"http:\/\/searchstorage.techtarget.com\/tip\/Storage-thin-provisioning-benefits-and-challenges\" target=\"_blank\">Storage thin provisioning benefits and challenges<\/a>\u53ef\u4ee5\u524d\u5f80\u4e00\u8bfb\u3002<\/p>\n<h4><span class=\"ez-toc-section\" id=\"Docker%E7%9A%84DeviceMapper\"><\/span>Docker\u7684DeviceMapper<span class=\"ez-toc-section-end\"><\/span><\/h4>\n<p>\u4e0a\u9762\u57fa\u672c\u4e0a\u5c31\u662fDocker\u7684\u73a9\u6cd5\u4e86\uff0c\u6211\u4eec\u53ef\u4ee5\u770b\u4e00\u4e0bdocker\u7684loopback\u8bbe\u5907\uff1a<\/p>\n<pre data-enlighter-language=\"shell\" class=\"EnlighterJSRAW\">~hchen $ sudo losetup -a\r\n\/dev\/loop0: [64768]:38050288 (\/var\/lib\/docker\/devicemapper\/devicemapper\/data)\r\n\/dev\/loop1: [64768]:38050289 (\/var\/lib\/docker\/devicemapper\/devicemapper\/metadata)<\/pre>\n<p>\u5176\u4e2ddata 100GB\uff0cmetadata 2.0GB<\/p>\n<pre data-enlighter-language=\"shell\" class=\"EnlighterJSRAW\">~hchen $ sudo ls -alhs \/var\/lib\/docker\/devicemapper\/devicemapper\r\n506M -rw-------. 1 root root 100G Sep 10 20:15 data\r\n1.1M -rw-------. 1 root root 2.0G Sep 10 20:15 metadata <\/pre>\n<p>\u4e0b\u9762\u662f\u76f8\u5173\u7684thin-pool\u3002\u5176\u4e2d\uff0c\u6709\u4e2a\u5f53\u4e00\u5927\u4e32hash\u4e32\u7684device\u662f\u6b63\u5728\u542f\u52a8\u7684\u5bb9\u5668\uff1a<\/p>\n<pre data-enlighter-language=\"shell\" class=\"EnlighterJSRAW\">~hchen $ sudo ll \/dev\/mapper\/dock*\r\nlrwxrwxrwx. 1 root root 7 Aug 25 07:57 \/dev\/mapper\/docker-253:0-104108535-pool -&gt; ..\/dm-2\r\nlrwxrwxrwx. 1 root root 7 Aug 25 11:13 \/dev\/mapper\/docker-253:0-104108535-deefcd630a60aa5ad3e69249f58a68e717324be4258296653406ff062f605edf -&gt; ..\/dm-3<\/pre>\n<p>\u6211\u4eec\u53ef\u4ee5\u770b\u4e00\u4e0b\u5b83\u7684device id\uff08Docker\u90fd\u628a\u5b83\u4eec\u8bb0\u4e0b\u6765\u4e86\uff09\uff1a<\/p>\n<pre data-enlighter-language=\"shell\" class=\"EnlighterJSRAW\">~hchen $ sudo cat \/var\/lib\/docker\/devicemapper\/metadata\/deefcd630a60aa5ad3e69249f58a68e717324be4258296653406ff062f605edf\r\n{&quot;device_id&quot;:24,&quot;size&quot;:10737418240,&quot;transaction_id&quot;:26,&quot;initialized&quot;:false}<\/pre>\n<p>device_id\u662f24\uff0csize\u662f10737418240\uff0c\u9664\u4ee5512\uff0c\u5c31\u662f20971520 \u4e2a sector\uff0c\u6211\u4eec\u7528\u8fd9\u4e9b\u4fe1\u606f\u6765\u505a\u4e2asnapshot\u770b\u770b\uff08\u6ce8\uff1a\u6211\u7528\u4e86\u4e00\u4e2a\u6bd4\u8f83\u5927\u7684dev id &#8211; 1024\uff09\uff1a<\/p>\n<pre data-enlighter-language=\"shell\" class=\"EnlighterJSRAW\">~hchen$ sudo dmsetup message &quot;\/dev\/mapper\/docker-253:0-104108535-pool&quot; 0 \\\r\n                                    &quot;create_snap 1024 24&quot;\r\n~hchen$ sudo dmsetup create dockersnap --table \\\r\n                    &quot;0 20971520 thin \/dev\/mapper\/docker-253:0-104108535-pool 1024&quot;\r\n~hchen$ sudo mkdir \/mnt\/docker\r\n~hchen$ sudo mount \/dev\/mapper\/dockersnap \/mnt\/docker\/\r\n~hchen$ sudo ls \/mnt\/docker\/\r\nid lost+found rootfs\r\n~hchen$ sudo ls \/mnt\/docker\/rootfs\/\r\nbin dev etc home lib lib64 lost+found media mnt opt proc root run sbin srv sys tmp usr var<\/pre>\n<p>\u6211\u4eec\u5728docker\u7684\u5bb9\u5668\u91cc\u7528findmnt\u547d\u4ee4\u4e5f\u53ef\u4ee5\u770b\u5230\u76f8\u5173\u7684mount\u7684\u60c5\u51b5\uff08\u56e0\u4e3a\u592a\u957f\uff0c\u4e0b\u9762\u53ea\u662f\u6458\u8981\uff09\uff1a<\/p>\n<pre data-enlighter-language=\"shell\" class=\"EnlighterJSRAW\"># findmnt\r\nTARGET                SOURCE               \r\n\/                 \/dev\/mapper\/docker-253:0-104108535-deefcd630a60[\/rootfs]\r\n\/etc\/resolv.conf  \/dev\/mapper\/centos-root[\/var\/lib\/docker\/containers\/deefcd630a60\/resolv.conf]\r\n\/etc\/hostname     \/dev\/mapper\/centos-root[\/var\/lib\/docker\/containers\/deefcd630a60\/hostname]\r\n\/etc\/hosts        \/dev\/mapper\/centos-root[\/var\/lib\/docker\/containers\/deefcd630a60\/hosts]<\/pre>\n<h4><span class=\"ez-toc-section\" id=\"Device_Mapper_%E8%A1%8C%E4%B8%8D%E8%A1%8C%EF%BC%9F\"><\/span>Device Mapper\u00a0\u884c\u4e0d\u884c\uff1f<span class=\"ez-toc-section-end\"><\/span><\/h4>\n<p>Thin Provisioning\u7684\u6587\u6863\u4e2d\u8bf4\uff0c\u8fd9\u8fd8\u5904\u7406\u5b9e\u9a8c\u9636\u6bb5\uff0c\u4e0d\u8981\u4e0aProduction.<\/p>\n<blockquote><p>These targets are very much still in the EXPERIMENTAL state. Please do not yet rely on them in production.<\/p><\/blockquote>\n<p>\u53e6\u5916\uff0cJeff Atwood\u5728Twitter\u4e0a\u53d1\u8fc7\u8fd9\u6837\u7684\u4e00\u63a8<\/p>\n<p><a href=\"https:\/\/twitter.com\/codinghorror\/status\/604096348682485760\"><img decoding=\"async\" loading=\"lazy\" class=\"aligncenter size-full wp-image-17214\" src=\"https:\/\/coolshell.cn\/wp-content\/uploads\/2015\/08\/Jeff.Atwood.DeviceMapper.png\" alt=\"Jeff.Atwood.DeviceMapper\" width=\"607\" height=\"311\" srcset=\"https:\/\/coolshell.cn\/wp-content\/uploads\/2015\/08\/Jeff.Atwood.DeviceMapper.png 607w, https:\/\/coolshell.cn\/wp-content\/uploads\/2015\/08\/Jeff.Atwood.DeviceMapper-300x154.png 300w\" sizes=\"(max-width: 607px) 100vw, 607px\" \/><\/a><\/p>\n<p>\u8fd9\u4e2a\u63a8\u6307\u5411\u7684<a href=\"https:\/\/forums.docker.com\/t\/rmi-not-freeing-disk-space-in-devicemapper-sparse-file-centos-6-6\/1640\/3\" target=\"_blank\">\u8fd9\u4e2a\u8ba8\u8bba<\/a>\u4e2d\uff0c\u5176\u4e2d\u6307\u5411\u4e86\u8fd9\u4e2a<a href=\"https:\/\/github.com\/discourse\/discourse_docker\/commit\/48f22d14f39496c8df446cbc65ee04b258c5a1a0\" target=\"_blank\">code diff<\/a>\uff0c\u57fa\u672c\u4e0a\u5c31\u662f\u8bf4\uff0cDeviceMapper\u8fd9\u79cd\u4e1c\u897f\u95ee\u9898\u592a\u591a\u4e86\uff0c\u6211\u4eec\u5e94\u8be5\u628a\u5176\u52a0\u5165\u9ed1\u540d\u5355\u3002Doker\u7684Founder\u4e5f\u8fd9\u6837\u56de\u590d\u5230\uff1a<\/p>\n<p><a href=\"https:\/\/twitter.com\/solomonstre\/status\/604055267303636992\"><img decoding=\"async\" loading=\"lazy\" class=\"aligncenter size-full wp-image-17215\" src=\"https:\/\/coolshell.cn\/wp-content\/uploads\/2015\/08\/Solomon.Hykeys.DeviceMapper.png\" alt=\"\" width=\"620\" height=\"229\" srcset=\"https:\/\/coolshell.cn\/wp-content\/uploads\/2015\/08\/Solomon.Hykeys.DeviceMapper.png 620w, https:\/\/coolshell.cn\/wp-content\/uploads\/2015\/08\/Solomon.Hykeys.DeviceMapper-300x111.png 300w\" sizes=\"(max-width: 620px) 100vw, 620px\" \/><\/a><\/p>\n<p>\u6240\u4ee5\uff0c\u5982\u679c\u4f60\u5728\u4f7f\u7528loopback\u7684devicemapper\u7684\u8bdd\uff0c\u5f53\u4f60\u7684\u5b58\u50a8\u51fa\u73b0\u4e86\u95ee\u9898\u540e\uff0c\u6b63\u786e\u7684\u89e3\u51b3\u65b9\u6848\u662f\uff1a<\/p>\n<p style=\"text-align: center;\">rm -rf \/var\/lib\/docker<\/p>\n<p>\uff08\u5168\u6587\u5b8c\uff09<\/p>\n","raw":"","protected":false},"excerpt":{"rendered":"<p>\u5728\u4e0a\u4e00\u7bc7\u4ecb\u7ecdAUFS\u7684\u6587\u7ae0\u4e2d\uff0c\u5927\u5bb6\u53ef\u4ee5\u770b\u5230\uff0cDocker\u7684\u5206\u5c42\u955c\u50cf\u662f\u600e\u4e48\u901a\u8fc7UnionFS\u8fd9\u79cd\u6587\u4ef6\u7cfb\u7edf\u505a\u5230\u7684\uff0c\u4f46\u662f\uff0c\u56e0\u4e3aDocker\u9996\u9009\u7684AUFS\u5e76\u4e0d\u5728Linu&#8230;<\/p>\n<p class=\"read-more\"><a class=\"btn btn-default\" href=\"https:\/\/coolshell.cn\/articles\/17200.html\"> Read More<span class=\"screen-reader-text\">  Read More<\/span><\/a><\/p>\n","protected":false},"author":2,"featured_media":0,"comment_status":"open","ping_status":"open","sticky":false,"template":"","format":"standard","meta":[],"categories":[20,18,10],"tags":[793,781,37,794],"series":[],"aioseo_notices":[],"views":73875,"post_thumbnail_image":"https:\/\/coolshell.cn\/wp-content\/uploads\/2015\/08\/how_to_set_up_an_iSCSI_LUN_with_thin.jpg","content_first_image":"https:\/\/coolshell.cn\/wp-content\/uploads\/2015\/08\/how_to_set_up_an_iSCSI_LUN_with_thin.jpg","post_medium_image_300":"https:\/\/coolshell.cn\/wp-content\/uploads\/2015\/08\/how_to_set_up_an_iSCSI_LUN_with_thin.jpg","post_thumbnail_image_624":"https:\/\/coolshell.cn\/wp-content\/uploads\/2015\/08\/how_to_set_up_an_iSCSI_LUN_with_thin.jpg","post_frist_image":"https:\/\/coolshell.cn\/wp-content\/uploads\/2015\/08\/how_to_set_up_an_iSCSI_LUN_with_thin.jpg","post_medium_image":"https:\/\/coolshell.cn\/wp-content\/uploads\/2015\/08\/how_to_set_up_an_iSCSI_LUN_with_thin.jpg","post_large_image":"https:\/\/coolshell.cn\/wp-content\/uploads\/2015\/08\/how_to_set_up_an_iSCSI_LUN_with_thin.jpg","post_full_image":"https:\/\/coolshell.cn\/wp-content\/uploads\/2015\/08\/how_to_set_up_an_iSCSI_LUN_with_thin.jpg","post_all_images":[{"imagesurl":"https:\/\/coolshell.cn\/wp-content\/uploads\/2015\/08\/how_to_set_up_an_iSCSI_LUN_with_thin-300x150.jpg","id":"image0"},{"imagesurl":"https:\/\/coolshell.cn\/wp-content\/uploads\/2015\/08\/device.mapper.2.gif","id":"image1"},{"imagesurl":"https:\/\/coolshell.cn\/wp-content\/uploads\/2015\/08\/thin-provisioning-1.jpg","id":"image2"},{"imagesurl":"https:\/\/coolshell.cn\/wp-content\/uploads\/2015\/08\/thin-provisioning-2.jpg","id":"image3"},{"imagesurl":"https:\/\/coolshell.cn\/wp-content\/uploads\/2015\/08\/Jeff.Atwood.DeviceMapper.png","id":"image4"},{"imagesurl":"https:\/\/coolshell.cn\/wp-content\/uploads\/2015\/08\/Solomon.Hykeys.DeviceMapper.png","id":"image5"}],"videoAdId":"","listAd":"0","listAdId":"","listAdEvery":5,"total_comments":25,"category_name":"Unix\/Linux","post_date":"2015-08-26","like_count":"0","praiseWord":"\u9f13\u52b1","excitationAd":"0","rewardedVideoAdId":"","detailAdId":"","detailAd":"0","enterpriseMinapp":"0","audios":[],"postImageUrl":"http:\/\/coolshell.cn\/wp-content\/uploads\/2016\/09\/coolshell-360x200.jpg","avatarurls":[],"related_posts":[{"ID":"22320","post_title":"eBPF \u4ecb\u7ecd"}],"pageviews":73876,"pageviews_wl":58565,"ratings_average":3,"ratings_total":158,"ratings_users":40,"next_post_id":17295,"next_post_title":"\u8ba9\u6211\u4eec\u6765\u8c08\u8c08\u5206\u5de5","previous_post_id":17061,"previous_post_title":"Docker\u57fa\u7840\u6280\u672f\uff1aAUFS"}