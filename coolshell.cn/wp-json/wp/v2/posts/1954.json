{"id":1954,"date":"2009-12-15T09:36:21","date_gmt":"2009-12-15T01:36:21","guid":{"rendered":"http:\/\/coolshell.cn\/?p=1954"},"modified":"2009-12-14T22:50:04","modified_gmt":"2009-12-14T14:50:04","slug":"java%e8%af%bb%e5%86%99excel","status":"publish","type":"post","link":"https:\/\/coolshell.cn\/articles\/1954.html","title":{"rendered":"Java\u8bfb\u5199Excel"},"content":{"rendered":"<p>\u672c\u6587\u4e3b\u8981\u5411\u4f60\u6f14\u793a\u5982\u4f55\u4f7f\u7528JavaExcel API\u6765\u8bfb\u5199Excel\u6587\u4ef6\u3002\u5173\u4e8eJavaExcel API\uff0c\u8fd9\u662f\u4e00\u4e2a\u5f00\u6e90\u7684lib\u5e93\u3002\u5176\u76f8\u5173\u7684feature\u5982\u4e0b\uff1a<\/p>\n<li>\u652f\u6301Excel 95, 97, 2000, <span style=\"color: #ff0000;\">XP, 2003<\/span> \u7684\u5236\u8868\u9875\u3002<\/li>\n<li>\u53ef\u4ee5\u8bfb\u5199\u76f8\u5173\u7684Excel\u516c\u5f0f\u00a0\uff08\u4ec5\u652f\u6301Excel 97 \u53ca\u4ee5\u540e\u7248\u672c\uff09<\/li>\n<li>\u53ef\u4ee5\u751f\u6210\u00a0Excel 2000 \u683c\u5f0f\u7684xls\u6587\u4ef6\u3002<\/li>\n<li>\u652f\u6301\u5b57\u4f53\uff0c\u6570\u5b57\u548c\u65e5\u671f\u683c\u5f0f\u3002<\/li>\n<li>\u652f\u6301\u5355\u5143\u683c\u7684\u9634\u5f71\uff0c\u8fb9\u6846\u548c\u989c\u8272\u3002<\/li>\n<li>\u53ef\u4ee5\u4fee\u6539\u5df2\u5b58\u5728\u7684\u5236\u8868\u9875\u3002<\/li>\n<li>\u56fd\u9645\u5316\u591a\u8bed\u8a00\u96c6\u3002(\u516c\u5f0f\u76ee\u524d\u652f\u6301\uff0c\u82f1\u6587\uff0c\u6cd5\u6587\uff0c\u897f\u73ed\u7259\u6587\u548c\u5fb7\u6587\uff09<\/li>\n<li>\u652f\u6301\u56fe\u8868\u62f7\u8d1d\u3002<\/li>\n<li><span style=\"color: #ff0000;\">\u652f\u6301\u56fe\u7247\u7684\u63d2\u5165\u548c\u590d\u5236\u3002<\/span><\/li>\n<li>\u65e5\u5fd7\u751f\u6210\u53ef\u4ee5\u4f7f\u7528Jakarta Commons Logging, log4j, JDK 1.4 Logger, \u7b49\u3002<\/li>\n<li>\u66f4\u591a\u2026\u2026<\/li>\n<p>\u4f60\u53ef\u4ee5\u5728\u8fd9\u91cc\u4e0b\u8f7d\uff1a<a href=\"http:\/\/jexcelapi.sourceforge.net\/\">http:\/\/jexcelapi.sourceforge.net\/<\/a>\uff0c\u7136\u540e\uff0c\u628ajxl.jar\u52a0\u5230\u4f60\u7684Java\u7684classpath\u4e2d\u3002<\/p>\n<p>\u4e0b\u9762\u662f\u4e24\u6bb5\u4f8b\u7a0b\uff0c\u4e00\u6bb5\u662f\u5982\u4f55\u521b\u5efaExcel\uff0c\u4e00\u6bb5\u662f\u5982\u4f55\u8bfb\u53d6Excel\u3002<\/p>\n<p><!--more--><\/p>\n<p><strong>\u521b\u5efaExcel<\/strong><\/p>\n<pre data-enlighter-language=\"java\" class=\"EnlighterJSRAW\">package writer;\r\n\r\nimport java.io.File;\r\nimport java.io.IOException;\r\nimport java.util.Locale;\r\n\r\nimport jxl.CellView;\r\nimport jxl.Workbook;\r\nimport jxl.WorkbookSettings;\r\nimport jxl.format.UnderlineStyle;\r\nimport jxl.write.Formula;\r\nimport jxl.write.Label;\r\nimport jxl.write.Number;\r\nimport jxl.write.WritableCellFormat;\r\nimport jxl.write.WritableFont;\r\nimport jxl.write.WritableSheet;\r\nimport jxl.write.WritableWorkbook;\r\nimport jxl.write.WriteException;\r\nimport jxl.write.biff.RowsExceededException;\r\n\r\n\r\npublic class WriteExcel {\r\n\r\n\tprivate WritableCellFormat timesBoldUnderline;\r\n\tprivate WritableCellFormat times;\r\n\tprivate String inputFile;\r\n\t\r\npublic void setOutputFile(String inputFile) {\r\n\tthis.inputFile = inputFile;\r\n\t}\r\n\r\n\tpublic void write() throws IOException, WriteException {\r\n\t\tFile file = new File(inputFile);\r\n\t\tWorkbookSettings wbSettings = new WorkbookSettings();\r\n\r\n\t\twbSettings.setLocale(new Locale(&quot;en&quot;, &quot;EN&quot;));\r\n\r\n\t\tWritableWorkbook workbook = Workbook.createWorkbook(file, wbSettings);\r\n\t\tworkbook.createSheet(&quot;Report&quot;, 0);\r\n\t\tWritableSheet excelSheet = workbook.getSheet(0);\r\n\t\tcreateLabel(excelSheet);\r\n\t\tcreateContent(excelSheet);\r\n\r\n\t\tworkbook.write();\r\n\t\tworkbook.close();\r\n\t}\r\n\r\n\tprivate void createLabel(WritableSheet sheet)\r\n\t\t\tthrows WriteException {\r\n\t\t\/\/ Lets create a times font\r\n\t\tWritableFont times10pt = new WritableFont(WritableFont.TIMES, 10);\r\n\t\t\/\/ Define the cell format\r\n\t\ttimes = new WritableCellFormat(times10pt);\r\n\t\t\/\/ Lets automatically wrap the cells\r\n\t\ttimes.setWrap(true);\r\n\r\n\t\t\/\/ Create create a bold font with unterlines\r\n\t\tWritableFont times10ptBoldUnderline = new WritableFont(\r\n\t\t\t\tWritableFont.TIMES, 10, WritableFont.BOLD, false,\r\n\t\t\t\tUnderlineStyle.SINGLE);\r\n\t\ttimesBoldUnderline = new WritableCellFormat(times10ptBoldUnderline);\r\n\t\t\/\/ Lets automatically wrap the cells\r\n\t\ttimesBoldUnderline.setWrap(true);\r\n\r\n\t\tCellView cv = new CellView();\r\n\t\tcv.setFormat(times);\r\n\t\tcv.setFormat(timesBoldUnderline);\r\n\t\tcv.setAutosize(true);\r\n\r\n\t\t\/\/ Write a few headers\r\n\t\taddCaption(sheet, 0, 0, &quot;Header 1&quot;);\r\n\t\taddCaption(sheet, 1, 0, &quot;This is another header&quot;);\r\n\t\t\r\n\r\n\t}\r\n\r\n\tprivate void createContent(WritableSheet sheet) throws WriteException,\r\n\t\t\tRowsExceededException {\r\n\t\t\/\/ Write a few number\r\n\t\tfor (int i = 1; i &lt; 10; i++) {\r\n\t\t\t\/\/ First column\r\n\t\t\taddNumber(sheet, 0, i, i + 10);\r\n\t\t\t\/\/ Second column\r\n\t\t\taddNumber(sheet, 1, i, i * i);\r\n\t\t}\r\n\t\t\/\/ Lets calculate the sum of it\r\n\t\tStringBuffer buf = new StringBuffer();\r\n\t\tbuf.append(&quot;SUM(A2:A10)&quot;);\r\n\t\tFormula f = new Formula(0, 10, buf.toString());\r\n\t\tsheet.addCell(f);\r\n\t\tbuf = new StringBuffer();\r\n\t\tbuf.append(&quot;SUM(B2:B10)&quot;);\r\n\t\tf = new Formula(1, 10, buf.toString());\r\n\t\tsheet.addCell(f);\r\n\r\n\t\t\/\/ Now a bit of text\r\n\t\tfor (int i = 12; i &lt; 20; i++) {\r\n\t\t\t\/\/ First column\r\n\t\t\taddLabel(sheet, 0, i, &quot;Boring text &quot; + i);\r\n\t\t\t\/\/ Second column\r\n\t\t\taddLabel(sheet, 1, i, &quot;Another text&quot;);\r\n\t\t}\r\n\t}\r\n\r\n\tprivate void addCaption(WritableSheet sheet, int column, int row, String s)\r\n\t\t\tthrows RowsExceededException, WriteException {\r\n\t\tLabel label;\r\n\t\tlabel = new Label(column, row, s, timesBoldUnderline);\r\n\t\tsheet.addCell(label);\r\n\t}\r\n\r\n\tprivate void addNumber(WritableSheet sheet, int column, int row,\r\n\t\t\tInteger integer) throws WriteException, RowsExceededException {\r\n\t\tNumber number;\r\n\t\tnumber = new Number(column, row, integer, times);\r\n\t\tsheet.addCell(number);\r\n\t}\r\n\r\n\tprivate void addLabel(WritableSheet sheet, int column, int row, String s)\r\n\t\t\tthrows WriteException, RowsExceededException {\r\n\t\tLabel label;\r\n\t\tlabel = new Label(column, row, s, times);\r\n\t\tsheet.addCell(label);\r\n\t}\r\n\r\n\tpublic static void main(String[] args) throws WriteException, IOException {\r\n\t\tWriteExcel test = new WriteExcel();\r\n\t\ttest.setOutputFile(&quot;c:\/temp\/lars.xls&quot;);\r\n\t\ttest.write();\r\n\t\tSystem.out\r\n\t\t\t\t.println(&quot;Please check the result file under c:\/temp\/lars.xls &quot;);\r\n\t}\r\n}\r\n<\/pre>\n<\/p>\n<p><strong>\u8bfb\u53d6Excel<\/strong><br \/>\n\u00a0<\/p>\n<pre data-enlighter-language=\"java\" class=\"EnlighterJSRAW\">package reader;\r\n\r\nimport java.io.File;\r\nimport java.io.IOException;\r\n\r\nimport jxl.Cell;\r\nimport jxl.CellType;\r\nimport jxl.Sheet;\r\nimport jxl.Workbook;\r\nimport jxl.read.biff.BiffException;\r\n\r\npublic class ReadExcel {\r\n\r\n\tprivate String inputFile;\r\n\r\n\tpublic void setInputFile(String inputFile) {\r\n\t\tthis.inputFile = inputFile;\r\n\t}\r\n\r\n\tpublic void read() throws IOException  {\r\n\t\tFile inputWorkbook = new File(inputFile);\r\n\t\tWorkbook w;\r\n\t\ttry {\r\n\t\t\tw = Workbook.getWorkbook(inputWorkbook);\r\n\t\t\t\/\/ Get the first sheet\r\n\t\t\tSheet sheet = w.getSheet(0);\r\n\t\t\t\/\/ Loop over first 10 column and lines\r\n\r\n\t\t\tfor (int j = 0; j &lt; sheet.getColumns(); j++) {\r\n\t\t\t\tfor (int i = 0; i &lt; sheet.getRows(); i++) {\r\n\t\t\t\t\tCell cell = sheet.getCell(j, i);\r\n\t\t\t\t\tCellType type = cell.getType();\r\n\t\t\t\t\tif (cell.getType() == CellType.LABEL) {\r\n\t\t\t\t\t\tSystem.out.println(&quot;I got a label &quot;\r\n\t\t\t\t\t\t\t\t+ cell.getContents());\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (cell.getType() == CellType.NUMBER) {\r\n\t\t\t\t\t\tSystem.out.println(&quot;I got a number &quot;\r\n\t\t\t\t\t\t\t\t+ cell.getContents());\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} catch (BiffException e) {\r\n\t\t\te.printStackTrace();\r\n\t\t}\r\n\t}\r\n\r\n\tpublic static void main(String[] args) throws IOException {\r\n\t\tReadExcel test = new ReadExcel();\r\n\t\ttest.setInputFile(&quot;c:\/temp\/lars.xls&quot;);\r\n\t\ttest.read();\r\n\t}\r\n\r\n}\r\n<\/pre>\n","raw":"","protected":false},"excerpt":{"rendered":"<p>\u672c\u6587\u4e3b\u8981\u5411\u4f60\u6f14\u793a\u5982\u4f55\u4f7f\u7528JavaExcel API\u6765\u8bfb\u5199Excel\u6587\u4ef6\u3002\u5173\u4e8eJavaExcel API\uff0c\u8fd9\u662f\u4e00\u4e2a\u5f00\u6e90\u7684lib\u5e93\u3002\u5176\u76f8\u5173\u7684feature\u5982\u4e0b\uff1a \u652f&#8230;<\/p>\n<p class=\"read-more\"><a class=\"btn btn-default\" href=\"https:\/\/coolshell.cn\/articles\/1954.html\"> Read More<span class=\"screen-reader-text\">  Read More<\/span><\/a><\/p>\n","protected":false},"author":2,"featured_media":0,"comment_status":"open","ping_status":"open","sticky":false,"template":"","format":"standard","meta":[],"categories":[4,3],"tags":[266,13,267],"series":[],"aioseo_notices":[],"views":10351,"post_thumbnail_image":"","content_first_image":"","post_medium_image_300":"","post_thumbnail_image_624":"","post_frist_image":"","post_medium_image":"","post_large_image":"","post_full_image":"","post_all_images":[],"videoAdId":"","listAd":"0","listAdId":"","listAdEvery":5,"total_comments":5,"category_name":"Java\u8bed\u8a00","post_date":"2009-12-15","like_count":"0","praiseWord":"\u9f13\u52b1","excitationAd":"0","rewardedVideoAdId":"","detailAdId":"","detailAd":"0","enterpriseMinapp":"0","audios":[],"postImageUrl":"http:\/\/coolshell.cn\/wp-content\/uploads\/2016\/09\/coolshell-360x200.jpg","avatarurls":[],"related_posts":[],"pageviews":10352,"pageviews_wl":3663,"ratings_average":2,"ratings_total":21,"ratings_users":8,"next_post_id":1957,"next_post_title":"Web\u7a0b\u5e8f\u7684\u6700\u4f73\u6d4b\u8bd5\u6570\u636e","previous_post_id":1949,"previous_post_title":"Web\u4e2d\u7684\u7701\u7565\u53f7"}