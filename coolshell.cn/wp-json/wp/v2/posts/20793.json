{"id":20793,"date":"2020-03-01T19:43:41","date_gmt":"2020-03-01T11:43:41","guid":{"rendered":"https:\/\/coolshell.cn\/?p=20793"},"modified":"2020-12-22T13:02:17","modified_gmt":"2020-12-22T05:02:17","slug":"%e7%a8%8b%e5%ba%8f%e5%91%98%e5%ba%94%e8%af%a5%e7%9f%a5%e9%81%93%e7%9a%84cpu%e7%bc%93%e5%ad%98%e7%9a%84%e4%ba%8b","status":"publish","type":"post","link":"https:\/\/coolshell.cn\/articles\/20793.html","title":{"rendered":"\u4e0e\u7a0b\u5e8f\u5458\u76f8\u5173\u7684CPU\u7f13\u5b58\u77e5\u8bc6"},"content":{"rendered":"<p><img decoding=\"async\" loading=\"lazy\" class=\"alignright size-medium wp-image-20817\" src=\"https:\/\/coolshell.cn\/wp-content\/uploads\/2020\/03\/cpu_512x512-300x300.png\" alt=\"\" width=\"300\" height=\"300\" srcset=\"https:\/\/coolshell.cn\/wp-content\/uploads\/2020\/03\/cpu_512x512-300x300.png 300w, https:\/\/coolshell.cn\/wp-content\/uploads\/2020\/03\/cpu_512x512-150x150.png 150w, https:\/\/coolshell.cn\/wp-content\/uploads\/2020\/03\/cpu_512x512-200x200.png 200w, https:\/\/coolshell.cn\/wp-content\/uploads\/2020\/03\/cpu_512x512-270x270.png 270w, https:\/\/coolshell.cn\/wp-content\/uploads\/2020\/03\/cpu_512x512.png 512w\" sizes=\"(max-width: 300px) 100vw, 300px\" \/>\u597d\u4e45\u6ca1\u6709\u5199\u4e00\u4e9b\u5fae\u89c2\u65b9\u9762\u7684\u6587\u7ae0\u4e86\uff0c\u4eca\u5929\u5199\u4e00\u7bc7\u5173\u4e8eCPU Cache\u76f8\u5173\u7684\u6587\u7ae0\uff0c\u8fd9\u7bc7\u6587\u7ae0\u6bd4\u8f83\u957f\uff0c\u4e3b\u8981\u5206\u6210\u8fd9\u4e48\u51e0\u4e2a\u90e8\u5206\uff1a\u57fa\u7840\u77e5\u8bc6\u3001\u7f13\u5b58\u7684\u547d\u4e2d\u3001\u7f13\u5b58\u7684\u4e00\u81f4\u6027\u3001\u76f8\u5173\u7684\u4ee3\u7801\u793a\u4f8b\u548c\u5ef6\u4f38\u9605\u8bfb\u3002\u5176\u4e2d\u4f1a\u8bb2\u8ff0\u4e00\u4e9b\u591a\u6838 CPU \u7684\u7cfb\u7edf\u67b6\u6784\u4ee5\u53ca\u5176\u539f\u7406\uff0c\u5305\u62ec\u5bf9\u7a0b\u5e8f\u6027\u80fd\u4e0a\u7684\u5f71\u54cd\uff0c\u4ee5\u53ca\u5728\u8fdb\u884c\u5e76\u53d1\u7f16\u7a0b\u7684\u65f6\u5019\u9700\u8981\u6ce8\u610f\u5230\u7684\u4e00\u4e9b\u95ee\u9898\u3002\u8fd9\u7bc7\u6587\u7ae0\u6211\u4f1a\u5c3d\u91cf\u5730\u5199\u7b80\u5355\u548c\u901a\u4fd7\u6613\u61c2\u4e00\u4e9b\uff0c\u4e3b\u8981\u662f\u8bb2\u6e05\u695a\u76f8\u5173\u7684\u539f\u7406\u548c\u95ee\u9898\uff0c\u800c\u5bf9\u4e8e\u4e00\u4e9b\u7ec6\u8282\u548c\u5ef6\u4f38\u9605\u8bfb\u6211\u4f1a\u5728\u6587\u7ae0\u6700\u540e\u4f1a\u7ed9\u51fa\u76f8\u5173\u7684\u8d44\u6e90\u3002<\/p>\n<p>\u56e0\u4e3a\u65e0\u8bba\u4f60\u5199\u4ec0\u4e48\u6837\u7684\u4ee3\u7801\u90fd\u4f1a\u4ea4\u7ed9CPU\u6765\u6267\u884c\uff0c\u6240\u4ee5\uff0c\u5982\u679c\u4f60\u60f3\u5199\u51fa\u6027\u80fd\u6bd4\u8f83\u9ad8\u7684\u4ee3\u7801\uff0c\u8fd9\u7bc7\u6587\u7ae0\u4e2d\u63d0\u5230\u7684\u6280\u672f\u8fd8\u662f\u503c\u5f97\u8ba4\u771f\u5b66\u4e60\u7684\u3002\u53e6\u5916\uff0c\u5343\u4e07\u522b\u89c9\u5f97\u8fd9\u4e9b\u4e1c\u897f\u6ca1\u7528\uff0c\u8fd9\u4e9b\u4e1c\u897f\u975e\u5e38\u6709\u7528\uff0c\u5341\u591a\u5e74\u524d\u5c31\u662f\u8fd9\u4e9b\u77e5\u8bc6\u5728\u6027\u80fd\u8c03\u4f18\u4e0a\u5e2e\u4e86\u6211\u7684\u5f88\u591a\u5927\u5fd9\uff0c\u4ece\u800c\u8ddf\u5f88\u591a\u4eba\u62c9\u5f00\u4e86\u5dee\u8ddd\u2026\u2026<\/p>\n<div id=\"ez-toc-container\" class=\"ez-toc-v2_0_48 counter-hierarchy ez-toc-counter ez-toc-grey ez-toc-container-direction\">\n<div class=\"ez-toc-title-container\">\n<p class=\"ez-toc-title\">\u76ee\u5f55<\/p>\n<span class=\"ez-toc-title-toggle\"><\/span><\/div>\n<nav><ul class='ez-toc-list ez-toc-list-level-1 ' ><li class='ez-toc-page-1 ez-toc-heading-level-4'><a class=\"ez-toc-link ez-toc-heading-1\" href=\"https:\/\/coolshell.cn\/articles\/20793.html\/#%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86\" title=\"\u57fa\u7840\u77e5\u8bc6\">\u57fa\u7840\u77e5\u8bc6<\/a><\/li><li class='ez-toc-page-1 ez-toc-heading-level-4'><a class=\"ez-toc-link ez-toc-heading-2\" href=\"https:\/\/coolshell.cn\/articles\/20793.html\/#%E7%BC%93%E5%AD%98%E7%9A%84%E5%91%BD%E4%B8%AD\" title=\"\u7f13\u5b58\u7684\u547d\u4e2d\">\u7f13\u5b58\u7684\u547d\u4e2d<\/a><\/li><li class='ez-toc-page-1 ez-toc-heading-level-4'><a class=\"ez-toc-link ez-toc-heading-3\" href=\"https:\/\/coolshell.cn\/articles\/20793.html\/#%E7%BC%93%E5%AD%98%E7%9A%84%E4%B8%80%E8%87%B4%E6%80%A7\" title=\"\u7f13\u5b58\u7684\u4e00\u81f4\u6027\">\u7f13\u5b58\u7684\u4e00\u81f4\u6027<\/a><\/li><li class='ez-toc-page-1 ez-toc-heading-level-4'><a class=\"ez-toc-link ez-toc-heading-4\" href=\"https:\/\/coolshell.cn\/articles\/20793.html\/#%E7%A8%8B%E5%BA%8F%E6%80%A7%E8%83%BD\" title=\"\u7a0b\u5e8f\u6027\u80fd\">\u7a0b\u5e8f\u6027\u80fd<\/a><ul class='ez-toc-list-level-5'><li class='ez-toc-heading-level-5'><a class=\"ez-toc-link ez-toc-heading-5\" href=\"https:\/\/coolshell.cn\/articles\/20793.html\/#%E7%A4%BA%E4%BE%8B%E4%B8%80\" title=\"\u793a\u4f8b\u4e00\">\u793a\u4f8b\u4e00<\/a><\/li><li class='ez-toc-page-1 ez-toc-heading-level-5'><a class=\"ez-toc-link ez-toc-heading-6\" href=\"https:\/\/coolshell.cn\/articles\/20793.html\/#%E7%A4%BA%E4%BE%8B%E4%BA%8C\" title=\"\u793a\u4f8b\u4e8c\">\u793a\u4f8b\u4e8c<\/a><\/li><li class='ez-toc-page-1 ez-toc-heading-level-5'><a class=\"ez-toc-link ez-toc-heading-7\" href=\"https:\/\/coolshell.cn\/articles\/20793.html\/#%E7%A4%BA%E4%BE%8B%E4%B8%89\" title=\"\u793a\u4f8b\u4e09\">\u793a\u4f8b\u4e09<\/a><\/li><li class='ez-toc-page-1 ez-toc-heading-level-5'><a class=\"ez-toc-link ez-toc-heading-8\" href=\"https:\/\/coolshell.cn\/articles\/20793.html\/#%E7%A4%BA%E4%BE%8B%E5%9B%9B\" title=\"\u793a\u4f8b\u56db\">\u793a\u4f8b\u56db<\/a><\/li><li class='ez-toc-page-1 ez-toc-heading-level-5'><a class=\"ez-toc-link ez-toc-heading-9\" href=\"https:\/\/coolshell.cn\/articles\/20793.html\/#%E7%A4%BA%E4%BE%8B%E4%BA%94\" title=\"\u793a\u4f8b\u4e94\">\u793a\u4f8b\u4e94<\/a><\/li><\/ul><\/li><li class='ez-toc-page-1 ez-toc-heading-level-4'><a class=\"ez-toc-link ez-toc-heading-10\" href=\"https:\/\/coolshell.cn\/articles\/20793.html\/#%E5%BB%B6%E4%BC%B8%E9%98%85%E8%AF%BB\" title=\"\u5ef6\u4f38\u9605\u8bfb\">\u5ef6\u4f38\u9605\u8bfb<\/a><\/li><\/ul><\/nav><\/div>\n<h4><span class=\"ez-toc-section\" id=\"%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86\"><\/span>\u57fa\u7840\u77e5\u8bc6<span class=\"ez-toc-section-end\"><\/span><\/h4>\n<p>\u9996\u5148\uff0c\u6211\u4eec\u90fd\u77e5\u9053\u73b0\u5728\u7684CPU\u591a\u6838\u6280\u672f\uff0c\u90fd\u4f1a\u6709\u51e0\u7ea7\u7f13\u5b58\uff0c\u8001\u7684CPU\u4f1a\u6709\u4e24\u7ea7\u5185\u5b58\uff08L1\u548cL2\uff09\uff0c\u65b0\u7684CPU\u4f1a\u6709\u4e09\u7ea7\u5185\u5b58\uff08L1\uff0cL2\uff0cL3 \uff09\uff0c\u5982\u4e0b\u56fe\u6240\u793a\uff1a<\/p>\n<p><img decoding=\"async\" loading=\"lazy\" class=\"aligncenter size-full wp-image-20794\" src=\"https:\/\/coolshell.cn\/wp-content\/uploads\/2020\/02\/cache.architecture.png\" alt=\"\" width=\"729\" height=\"371\" srcset=\"https:\/\/coolshell.cn\/wp-content\/uploads\/2020\/02\/cache.architecture.png 729w, https:\/\/coolshell.cn\/wp-content\/uploads\/2020\/02\/cache.architecture-300x153.png 300w, https:\/\/coolshell.cn\/wp-content\/uploads\/2020\/02\/cache.architecture-531x270.png 531w\" sizes=\"(max-width: 729px) 100vw, 729px\" \/><!--more--><\/p>\n<p>\u5176\u4e2d\uff1a<\/p>\n<ul>\n<li>L1\u7f13\u5b58\u5206\u6210\u4e24\u79cd\uff0c\u4e00\u79cd\u662f\u6307\u4ee4\u7f13\u5b58\uff0c\u4e00\u79cd\u662f\u6570\u636e\u7f13\u5b58\u3002L2\u7f13\u5b58\u548cL3\u7f13\u5b58\u4e0d\u5206\u6307\u4ee4\u548c\u6570\u636e\u3002<\/li>\n<li>L1\u548cL2\u7f13\u5b58\u5728\u6bcf\u4e00\u4e2aCPU\u6838\u4e2d\uff0cL3\u5219\u662f\u6240\u6709CPU\u6838\u5fc3\u5171\u4eab\u7684\u5185\u5b58\u3002<\/li>\n<li>L1\u3001L2\u3001L3\u7684\u8d8a\u79bbCPU\u8fd1\u5c31\u8d8a\u5c0f\uff0c\u901f\u5ea6\u4e5f\u8d8a\u5feb\uff0c\u8d8a\u79bbCPU\u8fdc\uff0c\u901f\u5ea6\u4e5f\u8d8a\u6162\u3002<\/li>\n<\/ul>\n<p>\u518d\u5f80\u540e\u9762\u5c31\u662f\u5185\u5b58\uff0c\u5185\u5b58\u7684\u540e\u9762\u5c31\u662f\u786c\u76d8\u3002\u6211\u4eec\u6765\u770b\u4e00\u4e9b\u4ed6\u4eec\u7684\u901f\u5ea6\uff1a<\/p>\n<ul class=\"\">\n<li>L1 \u7684\u5b58\u53d6\u901f\u5ea6\uff1a<strong class=\"hd jp\">4 \u4e2aCPU\u65f6\u949f\u5468\u671f<\/strong><\/li>\n<li>L2 \u7684\u5b58\u53d6\u901f\u5ea6\uff1a <strong class=\"hd jp\">11 \u4e2aCPU\u65f6\u949f\u5468\u671f<\/strong><\/li>\n<li>L3 \u7684\u5b58\u53d6\u901f\u5ea6\uff1a<strong class=\"hd jp\">39 \u4e2aCPU\u65f6\u949f\u5468\u671f<\/strong><\/li>\n<li>RAM\u5185\u5b58\u7684\u5b58\u53d6\u901f\u5ea6<strong class=\"hd jp\">\uff1a107 \u4e2aCPU\u65f6\u949f\u5468\u671f<\/strong><\/li>\n<\/ul>\n<p>\u6211\u4eec\u53ef\u4ee5\u770b\u5230\uff0cL1\u7684\u901f\u5ea6\u662fRAM\u768427\u500d\uff0c\u4f46\u662fL1\/L2\u7684\u5927\u5c0f\u57fa\u672c\u4e0a\u4e5f\u5c31\u662fKB\u7ea7\u522b\u7684\uff0cL3\u4f1a\u662fMB\u7ea7\u522b\u7684\u3002\u4f8b\u5982\uff1a<a href=\"https:\/\/en.wikichip.org\/wiki\/intel\/core_i7\/i7-8700k\" target=\"_blank\" rel=\"noopener noreferrer\">Intel Core i7-8700K<\/a> \uff0c\u662f\u4e00\u4e2a6\u6838\u7684CPU\uff0c\u6bcf\u6838\u4e0a\u7684L1\u662f64KB\uff08\u6570\u636e\u548c\u6307\u4ee4\u540432KB\uff09\uff0cL2 \u662f 256K\uff0cL3\u67092MB\uff08\u6211\u7684\u82f9\u679c\u7535\u8111\u662f<a href=\"https:\/\/en.wikichip.org\/wiki\/intel\/core_i9\/i9-8950hk\" target=\"_blank\" rel=\"noopener noreferrer\"> Intel Core i9-8950HK<\/a>\uff0c\u548cCore i7-8700K\u7684Cache\u5927\u5c0f\u4e00\u6837\uff09\u3002<\/p>\n<p>\u6211\u4eec\u7684\u6570\u636e\u5c31\u4ece\u5185\u5b58\u5411\u4e0a\uff0c\u5148\u5230L3\uff0c\u518d\u5230L2\uff0c\u518d\u5230L1\uff0c\u6700\u540e\u5230\u5bc4\u5b58\u5668\u8fdb\u884cCPU\u8ba1\u7b97\u3002\u4e3a\u4ec0\u4e48\u4f1a\u8bbe\u8ba1\u6210\u4e09\u5c42\uff1f\u8fd9\u91cc\u6709\u4e0b\u9762\u51e0\u4e2a\u65b9\u9762\u7684\u8003\u8651\uff1a<\/p>\n<ul>\n<li>\u4e00\u4e2a\u65b9\u9762\u662f\u7269\u7406\u901f\u5ea6\uff0c\u5982\u679c\u8981\u66f4\u5927\u7684\u5bb9\u91cf\u5c31\u9700\u8981\u66f4\u591a\u7684\u6676\u4f53\u7ba1\uff0c\u9664\u4e86\u82af\u7247\u7684\u4f53\u79ef\u4f1a\u53d8\u5927\uff0c\u66f4\u91cd\u8981\u7684\u662f\u5927\u91cf\u7684\u6676\u4f53\u7ba1\u4f1a\u5bfc\u81f4\u901f\u5ea6\u4e0b\u964d\uff0c\u56e0\u4e3a\u8bbf\u95ee\u901f\u5ea6\u548c\u8981\u8bbf\u95ee\u7684\u6676\u4f53\u7ba1\u6240\u5728\u7684\u4f4d\u7f6e\u6210\u53cd\u6bd4\uff0c\u4e5f\u5c31\u662f\u5f53\u4fe1\u53f7\u8def\u5f84\u53d8\u957f\u65f6\uff0c\u901a\u4fe1\u901f\u5ea6\u4f1a\u53d8\u6162\u3002\u8fd9\u90e8\u5206\u662f\u7269\u7406\u95ee\u9898\u3002<\/li>\n<li>\u53e6\u5916\u4e00\u4e2a\u95ee\u9898\u662f\uff0c\u591a\u6838\u6280\u672f\u4e2d\uff0c\u6570\u636e\u7684\u72b6\u6001\u9700\u8981\u5728\u591a\u4e2aCPU\u4e2d\u8fdb\u884c\u540c\u6b65\uff0c\u5e76\u4e14\uff0c\u6211\u4eec\u53ef\u4ee5\u770b\u5230\uff0ccache\u548cRAM\u7684\u901f\u5ea6\u5dee\u8ddd\u592a\u5927\uff0c\u6240\u4ee5\uff0c\u591a\u7ea7\u4e0d\u540c\u5c3a\u5bf8\u7684\u7f13\u5b58\u6709\u5229\u4e8e\u63d0\u9ad8\u6574\u4f53\u7684\u6027\u80fd\u3002<\/li>\n<\/ul>\n<p>\u8fd9\u4e2a\u4e16\u754c\u6c38\u8fdc\u662f\u5e73\u8861\u7684\uff0c\u4e00\u9762\u53d8\u5f97\u6709\u591a\u5149\u9c9c\uff0c\u53e6\u4e00\u9762\u4e5f\u4f1a\u53d8\u5f97\u6709\u591a\u9ed1\u6697\u3002\u5efa\u7acb\u8fd9\u4e48\u591a\u7ea7\u7684\u7f13\u5b58\uff0c\u4e00\u5b9a\u5c31\u4f1a\u5f15\u5165\u5176\u5b83\u7684\u95ee\u9898\uff0c\u8fd9\u91cc\u6709\u4e24\u4e2a\u6bd4\u8f83\u91cd\u8981\u7684\u95ee\u9898\uff0c<\/p>\n<ul>\n<li>\u4e00\u4e2a\u662f\u6bd4\u8f83\u7b80\u5355\u7684\u7f13\u5b58\u7684\u547d\u4e2d\u7387\u7684\u95ee\u9898\u3002<\/li>\n<li>\u53e6\u4e00\u4e2a\u662f\u6bd4\u8f83\u590d\u6742\u7684\u7f13\u5b58\u66f4\u65b0\u7684\u4e00\u81f4\u6027\u95ee\u9898\u3002<\/li>\n<\/ul>\n<p>\u5c24\u5176\u662f\u7b2c\u4e8c\u4e2a\u95ee\u9898\uff0c\u5728\u591a\u6838\u6280\u672f\u4e0b\uff0c\u8fd9\u5c31\u5f88\u50cf\u5206\u5e03\u5f0f\u7684\u7cfb\u7edf\u4e86\uff0c\u8981\u5bf9\u591a\u4e2a\u5730\u65b9\u8fdb\u884c\u66f4\u65b0\u3002<\/p>\n<h4><span class=\"ez-toc-section\" id=\"%E7%BC%93%E5%AD%98%E7%9A%84%E5%91%BD%E4%B8%AD\"><\/span>\u7f13\u5b58\u7684\u547d\u4e2d<span class=\"ez-toc-section-end\"><\/span><\/h4>\n<p>\u5728\u8bf4\u660e\u8fd9\u4e24\u4e2a\u95ee\u9898\u4e4b\u524d\u3002\u6211\u4eec\u9700\u8981\u8981\u89e3\u4e00\u4e2a\u672f\u8bed Cache Line\u3002\u7f13\u5b58\u57fa\u672c\u4e0a\u6765\u8bf4\u5c31\u662f\u628a\u540e\u9762\u7684\u6570\u636e\u52a0\u8f7d\u5230\u79bb\u81ea\u5df1\u8fd1\u7684\u5730\u65b9\uff0c\u5bf9\u4e8eCPU\u6765\u8bf4\uff0c\u5b83\u662f\u4e0d\u4f1a\u4e00\u4e2a\u5b57\u8282\u4e00\u4e2a\u5b57\u8282\u7684\u52a0\u8f7d\u7684\uff0c\u56e0\u4e3a\u8fd9\u975e\u5e38\u6ca1\u6709\u6548\u7387\uff0c\u4e00\u822c\u6765\u8bf4\u90fd\u662f\u8981\u4e00\u5757\u4e00\u5757\u7684\u52a0\u8f7d\u7684\uff0c\u5bf9\u4e8e\u8fd9\u6837\u7684\u4e00\u5757\u4e00\u5757\u7684\u6570\u636e\u5355\u4f4d\uff0c\u672f\u8bed\u53eb\u201cCache Line\u201d\uff0c\u4e00\u822c\u6765\u8bf4\uff0c\u4e00\u4e2a\u4e3b\u6d41\u7684CPU\u7684Cache Line \u662f 64 Bytes\uff08\u4e5f\u6709\u7684CPU\u752832Bytes\u548c128Bytes\uff09\uff0c64Bytes\u4e5f\u5c31\u662f16\u4e2a32\u4f4d\u7684\u6574\u578b\uff0c\u8fd9\u5c31\u662fCPU\u4ece\u5185\u5b58\u4e2d\u635e\u6570\u636e\u4e0a\u6765\u7684\u6700\u5c0f\u6570\u636e\u5355\u4f4d\u3002<\/p>\n<p>\u6bd4\u5982\uff1aCache Line\u662f\u6700\u5c0f\u5355\u4f4d\uff0864Bytes\uff09\uff0c\u6240\u4ee5\u5148\u628aCache\u5206\u5e03\u591a\u4e2aCache Line\uff0c\u6bd4\u5982\uff1aL1\u670932KB\uff0c\u90a3\u4e48\uff0c32KB\/64B = 512 \u4e2a Cache Line\u3002<\/p>\n<p>\u4e00\u65b9\u9762\uff0c\u7f13\u5b58\u9700\u8981\u628a\u5185\u5b58\u91cc\u7684\u6570\u636e\u653e\u5230\u653e\u8fdb\u6765\uff0c\u82f1\u6587\u53eb CPU Associativity\u3002Cache\u7684\u6570\u636e\u653e\u7f6e\u7684\u7b56\u7565\u51b3\u5b9a\u4e86\u5185\u5b58\u4e2d\u7684\u6570\u636e\u5757\u4f1a\u62f7\u8d1d\u5230CPU Cache\u4e2d\u7684\u54ea\u4e2a\u4f4d\u7f6e\u4e0a\uff0c\u56e0\u4e3aCache\u7684\u5927\u5c0f\u8fdc\u8fdc\u5c0f\u4e8e\u5185\u5b58\uff0c\u6240\u4ee5\uff0c\u9700\u8981\u6709\u4e00\u79cd\u5730\u5740\u5173\u8054\u7684\u7b97\u6cd5\uff0c\u80fd\u591f\u8ba9\u5185\u5b58\u4e2d\u7684\u6570\u636e\u53ef\u4ee5\u88ab\u6620\u5c04\u5230Cache\u4e2d\u6765\u3002\u8fd9\u4e2a\u6709\u70b9\u50cf\u5185\u5b58\u5730\u5740\u4ece\u903b\u8f91\u5730\u5740\u5411\u7269\u7406\u5730\u5740\u6620\u5c04\u7684\u65b9\u6cd5\uff0c\u4f46\u4e0d\u5b8c\u5168\u4e00\u6837\u3002<\/p>\n<p>\u57fa\u672c\u4e0a\u6765\u8bf4\uff0c\u6211\u4eec\u4f1a\u6709\u5982\u4e0b\u7684\u4e00\u4e9b\u65b9\u6cd5\u3002<\/p>\n<ul>\n<li>\u4e00\u79cd\u65b9\u6cd5\u662f\uff0c\u4efb\u4f55\u4e00\u4e2a\u5185\u5b58\u5730\u5740\u7684\u6570\u636e\u53ef\u4ee5\u88ab\u7f13\u5b58\u5728\u4efb\u4f55\u4e00\u4e2aCache Line\u91cc\uff0c\u8fd9\u79cd\u65b9\u6cd5\u662f\u6700\u7075\u6d3b\u7684\uff0c\u4f46\u662f\uff0c\u5982\u679c\u6211\u4eec\u8981\u77e5\u9053\u4e00\u4e2a\u5185\u5b58\u662f\u5426\u5b58\u5728\u4e8eCache\u4e2d\uff0c\u6211\u4eec\u5c31\u9700\u8981\u8fdb\u884cO(n)\u590d\u6742\u5ea6\u7684Cache\u904d\u5386\uff0c\u8fd9\u662f\u5f88\u6ca1\u6709\u6548\u7387\u7684\u3002<\/li>\n<li>\u53e6\u4e00\u79cd\u65b9\u6cd5\uff0c\u4e3a\u4e86\u964d\u4f4e\u7f13\u5b58\u641c\u7d22\u7b97\u6cd5\uff0c\u6211\u4eec\u9700\u8981\u4f7f\u7528\u50cfHash Table\u8fd9\u6837\u7684\u6570\u636e\u7ed3\u6784\uff0c\u6700\u7b80\u5355\u7684hash table\u5c31\u662f\u505a\u201c\u6c42\u6a21\u8fd0\u7b97\u201d\uff0c\u6bd4\u5982\uff1a\u6211\u4eec\u7684L1 Cache\u6709512\u4e2aCache Line\uff0c\u90a3\u4e48\uff0c\u516c\u5f0f\uff1a<code>\uff08\u5185\u5b58\u5730\u5740 mod 512\uff09* 64<\/code> \u5c31\u53ef\u4ee5\u76f4\u63a5\u627e\u5230\u6240\u5728\u7684Cache\u5730\u5740\u7684\u504f\u79fb\u4e86\u3002\u4f46\u662f\uff0c\u8fd9\u6837\u7684\u65b9\u5f0f\u9700\u8981\u6211\u4eec\u7684\u7a0b\u5e8f\u5bf9\u5185\u5b58\u5730\u5740\u7684\u8bbf\u95ee\u8981\u975e\u5e38\u5730\u5e73\u5747\uff0c\u4e0d\u7136\u51b2\u7a81\u5c31\u4f1a\u975e\u5e38\u4e25\u91cd\u3002\u8fd9\u6210\u4e86\u4e00\u79cd\u975e\u5e38\u7406\u60f3\u7684\u60c5\u51b5\u4e86\u3002<\/li>\n<li>\u4e3a\u4e86\u907f\u514d\u4e0a\u8ff0\u7684\u4e24\u79cd\u65b9\u6848\u7684\u95ee\u9898\uff0c\u4e8e\u662f\u5c31\u8981\u5bb9\u5fcd\u4e00\u5b9a\u7684hash\u51b2\u7a81\uff0c\u4e5f\u5c31\u51fa\u73b0\u4e86 N-Way \u5173\u8054\u3002\u4e5f\u5c31\u662f\u628a\u8fde\u7eed\u7684N\u4e2aCache Line\u7ed1\u6210\u4e00\u7ec4\uff0c\u7136\u540e\uff0c\u5148\u628a\u627e\u5230\u76f8\u5173\u7684\u7ec4\uff0c\u7136\u540e\u518d\u5728\u8fd9\u4e2a\u7ec4\u5185\u627e\u5230\u76f8\u5173\u7684Cache Line\u3002\u8fd9\u53eb Set Associativity\u3002\u5982\u4e0b\u56fe\u6240\u793a\u3002<\/li>\n<\/ul>\n<p><img decoding=\"async\" loading=\"lazy\" class=\"aligncenter size-full wp-image-20806\" src=\"https:\/\/coolshell.cn\/wp-content\/uploads\/2020\/02\/cache-associative-fill-both.png\" alt=\"\" width=\"546\" height=\"271\" srcset=\"https:\/\/coolshell.cn\/wp-content\/uploads\/2020\/02\/cache-associative-fill-both.png 546w, https:\/\/coolshell.cn\/wp-content\/uploads\/2020\/02\/cache-associative-fill-both-300x149.png 300w, https:\/\/coolshell.cn\/wp-content\/uploads\/2020\/02\/cache-associative-fill-both-544x270.png 544w\" sizes=\"(max-width: 546px) 100vw, 546px\" \/><\/p>\n<p>\u5bf9\u4e8e N-Way \u7ec4\u5173\u8054\uff0c\u53ef\u80fd\u6709\u70b9\u4e0d\u597d\u7406\u89e3\uff0c\u8fd9\u91cc\u4e2a\u4f8b\u5b50\uff0c\u5e76\u591a\u8bf4\u4e00\u4e9b\u7ec6\u8282\uff08\u4e0d\u7136\u540e\u9762\u7684\u4ee3\u7801\u4f60\u4f1a\u4e0d\u80fd\u7406\u89e3\uff09\uff0cIntel \u5927\u591a\u6570\u5904\u7406\u5668\u7684L1 Cache\u90fd\u662f32KB\uff0c8-Way \u7ec4\u76f8\u8054\uff0cCache Line \u662f64 Bytes\u3002\u8fd9\u610f\u5473\u7740\uff0c<\/p>\n<ul>\n<li>32KB\u7684\u53ef\u4ee5\u5206\u6210\uff0c32KB \/ 64 = 512 \u6761 Cache Line\u3002<\/li>\n<li>\u56e0\u4e3a\u67098 Way\uff0c\u4e8e\u662f\u4f1a\u6bcf\u4e00Way \u6709 512 \/ 8 = 64 \u6761 Cache Line\u3002<\/li>\n<li>\u4e8e\u662f\u6bcf\u4e00\u8def\u5c31\u6709 64 x 64 = 4096 Byts \u7684\u5185\u5b58\u3002<\/li>\n<\/ul>\n<p>\u4e3a\u4e86\u65b9\u4fbf\u7d22\u5f15\u5185\u5b58\u5730\u5740\uff0c<\/p>\n<ul>\n<li><strong>Tag<\/strong>\uff1a\u6bcf\u6761 Cache Line \u524d\u90fd\u4f1a\u6709\u4e00\u4e2a\u72ec\u7acb\u5206\u914d\u7684 24 bits\u6765\u5b58\u7684 tag\uff0c\u5176\u5c31\u662f\u5185\u5b58\u5730\u5740\u7684\u524d24bits<\/li>\n<li><strong>Index<\/strong>\uff1a\u5185\u5b58\u5730\u5740\u540e\u7eed\u76846\u4e2abits\u5219\u662f\u5728\u8fd9\u4e00Way\u7684\u662fCache Line \u7d22\u5f15\uff0c2^6 = 64 \u521a\u597d\u53ef\u4ee5\u7d22\u5f1564\u6761Cache Line<\/li>\n<li><strong>Offset<\/strong>\uff1a\u518d\u5f80\u540e\u76846bits\u7528\u4e8e\u8868\u793a\u5728Cache Line \u91cc\u7684\u504f\u79fb\u91cf<\/li>\n<\/ul>\n<p>\u5982\u4e0b\u56fe\u6240\u793a\uff1a\uff08\u56fe\u7247\u6765\u81ea\u300a<a href=\"https:\/\/manybutfinite.com\/post\/intel-cpu-caches\/\" target=\"_blank\" rel=\"noopener noreferrer\">Cache: a place for concealment and safekeeping<\/a>\u300b\uff09<\/p>\n<p>\u5f53\u62ff\u5230\u4e00\u4e2a\u5185\u5b58\u5730\u5740\u7684\u65f6\u5019\uff0c\u5148\u62ff\u51fa\u4e2d\u95f4\u7684 6bits \u6765\uff0c\u627e\u5230\u662f\u54ea\u7ec4\u3002<\/p>\n<p style=\"text-align: center;\"><img decoding=\"async\" loading=\"lazy\" class=\"aligncenter size-full wp-image-20809\" src=\"https:\/\/coolshell.cn\/wp-content\/uploads\/2020\/03\/L1CacheExample.png\" alt=\"\" width=\"687\" height=\"461\" srcset=\"https:\/\/coolshell.cn\/wp-content\/uploads\/2020\/03\/L1CacheExample.png 687w, https:\/\/coolshell.cn\/wp-content\/uploads\/2020\/03\/L1CacheExample-300x201.png 300w, https:\/\/coolshell.cn\/wp-content\/uploads\/2020\/03\/L1CacheExample-402x270.png 402w\" sizes=\"(max-width: 687px) 100vw, 687px\" \/><\/p>\n<p>\u7136\u540e\uff0c\u5728\u8fd9\u4e00\u4e2a8\u7ec4\u7684cache line\u4e2d\uff0c\u518d\u8fdb\u884cO(n) n=8 \u7684\u904d\u5386\uff0c\u4e3b\u662f\u8981\u5339\u914d\u524d24bits\u7684tag\u3002\u5982\u679c\u5339\u914d\u4e2d\u4e86\uff0c\u5c31\u7b97\u547d\u4e2d\uff0c\u5982\u679c\u6ca1\u6709\u5339\u914d\u5230\uff0c\u90a3\u5c31\u662fcache miss\uff0c\u5982\u679c\u662f\u8bfb\u64cd\u4f5c\uff0c\u5c31\u9700\u8981\u8fdb\u5411\u540e\u9762\u7684\u7f13\u5b58\u8fdb\u884c\u8bbf\u95ee\u4e86\u3002L2\/L3\u540c\u6837\u662f\u8fd9\u6837\u7684\u7b97\u6cd5\u3002\u800c\u6dd8\u6c70\u7b97\u6cd5\u6709\u4e24\u79cd\uff0c\u4e00\u79cd\u662f\u968f\u673a\u4e00\u79cd\u662fLRU\u3002\u73b0\u5728\u4e00\u822c\u90fd\u662f\u4ee5LRU\u7684\u7b97\u6cd5\uff08\u901a\u8fc7\u589e\u52a0\u4e00\u4e2a\u8bbf\u95ee\u8ba1\u6570\u5668\u6765\u5b9e\u73b0\uff09<\/p>\n<p><img decoding=\"async\" loading=\"lazy\" class=\"aligncenter size-full wp-image-20840\" src=\"https:\/\/coolshell.cn\/wp-content\/uploads\/2020\/03\/selectingCacheLine.png\" alt=\"\" width=\"681\" height=\"283\" srcset=\"https:\/\/coolshell.cn\/wp-content\/uploads\/2020\/03\/selectingCacheLine.png 681w, https:\/\/coolshell.cn\/wp-content\/uploads\/2020\/03\/selectingCacheLine-300x125.png 300w, https:\/\/coolshell.cn\/wp-content\/uploads\/2020\/03\/selectingCacheLine-604x251.png 604w\" sizes=\"(max-width: 681px) 100vw, 681px\" \/><\/p>\n<p>\u8fd9\u4e5f\u610f\u5473\u7740\uff1a<\/p>\n<ul>\n<li>L1 Cache \u53ef\u6620\u5c04 36bits \u7684\u5185\u5b58\u5730\u5740\uff0c\u4e00\u5171 2^36 = 64GB\u7684\u5185\u5b58<\/li>\n<li>\u5f53CPU\u8981\u8bbf\u95ee\u4e00\u4e2a\u5185\u5b58\u7684\u65f6\u5019\uff0c\u901a\u8fc7\u8fd9\u4e2a\u5185\u5b58\u4e2d\u95f4\u76846bits \u5b9a\u4f4d\u662f\u54ea\u4e2aset\uff0c\u901a\u8fc7\u524d 24bits \u5b9a\u4f4d\u76f8\u5e94\u7684Cache Line\u3002<\/li>\n<li>\u5c31\u50cf\u4e00\u4e2ahash Table\u7684\u6570\u636e\u7ed3\u6784\u4e00\u6837\uff0c\u5148\u662fO(1)\u7684\u7d22\u5f15\uff0c\u7136\u540e\u8fdb\u5165\u51b2\u7a81\u641c\u7d22\u3002<\/li>\n<li>\u56e0\u4e3a\u4e2d\u95f4\u7684 6bits \u51b3\u5b9a\u4e86\u4e00\u4e2a\u540c\u4e00\u4e2aset\uff0c\u6240\u4ee5\uff0c\u5bf9\u4e8e\u4e00\u6bb5\u8fde\u7eed\u7684\u5185\u5b58\u6765\u8bf4\uff0c\u6bcf\u96944096\u7684\u5185\u5b58\u4f1a\u88ab\u653e\u5728\u540c\u4e00\u4e2a\u7ec4\u5185\uff0c\u5bfc\u81f4\u7f13\u5b58\u51b2\u7a81\u3002<\/li>\n<\/ul>\n<p>\u6b64\u5916\uff0c\u5f53\u6709\u6570\u636e\u6ca1\u6709\u547d\u4e2d\u7f13\u5b58\u7684\u65f6\u5019\uff0cCPU\u5c31\u4f1a\u4ee5\u6700\u5c0f\u4e3aCache Line\u7684\u5355\u5143\u5411\u5185\u5b58\u66f4\u65b0\u6570\u636e\u3002\u5f53\u7136\uff0cCPU\u5e76\u4e0d\u4e00\u5b9a\u53ea\u662f\u66f4\u65b064Bytes\uff0c\u56e0\u4e3a\u8bbf\u95ee\u4e3b\u5b58\u5b9e\u5728\u662f\u592a\u6162\u4e86\uff0c\u6240\u4ee5\uff0c\u4e00\u822c\u90fd\u4f1a\u591a\u66f4\u65b0\u4e00\u4e9b\u3002\u597d\u7684CPU\u4f1a\u6709\u4e00\u4e9b\u9884\u6d4b\u7684\u6280\u672f\uff0c\u5982\u679c\u627e\u5230\u4e00\u79cdpattern\u7684\u8bdd\uff0c\u5c31\u4f1a\u9884\u5148\u52a0\u8f7d\u66f4\u591a\u7684\u5185\u5b58\uff0c\u5305\u62ec\u6307\u4ee4\u4e5f\u53ef\u4ee5\u9884\u52a0\u8f7d\u3002\u8fd9\u53eb Prefetching \u6280\u672f \uff08\u53c2\u770b\uff0cWikipedia \u7684 <a href=\"https:\/\/en.wikipedia.org\/wiki\/Cache_prefetching\" target=\"_blank\" rel=\"noopener noreferrer\">Cache Prefetching<\/a> \u548c <a href=\"http:\/\/compas.cs.stonybrook.edu\/~nhonarmand\/courses\/sp16\/cse502\/slides\/13-prefetch.pdf\" target=\"_blank\" rel=\"noopener noreferrer\">\u7ebd\u7ea6\u5dde\u7acb\u5927\u5b66\u7684 Memory Prefetching<\/a>\uff09\u3002\u6bd4\u5982\uff0c\u4f60\u5728for-loop\u8bbf\u95ee\u4e00\u4e2a\u8fde\u7eed\u7684\u6570\u7ec4\uff0c\u4f60\u7684\u6b65\u957f\u662f\u4e00\u4e2a\u56fa\u5b9a\u7684\u6570\uff0c\u5185\u5b58\u5c31\u53ef\u4ee5\u505a\u5230prefetching\u3002\uff08\u6ce8\uff1a\u6307\u4ee4\u4e5f\u662f\u4ee5\u9884\u52a0\u8f7d\u7684\u65b9\u5f0f\u6267\u884c\uff0c\u53c2\u770b\u672c\u7ad9\u7684\u300a<a href=\"https:\/\/coolshell.cn\/articles\/7886.html\" target=\"_blank\" rel=\"noopener noreferrer\">\u4ee3\u7801\u6267\u884c\u7684\u6548\u7387<\/a>\u300b\u4e2d\u7684\u7b2c\u4e09\u4e2a\u793a\u4f8b\uff09<\/p>\n<p>\u4e86\u89e3\u8fd9\u4e9b\u7ec6\u8282\uff0c\u4f1a\u6709\u5229\u4e8e\u6211\u4eec\u77e5\u9053\u5728\u4ec0\u4e48\u60c5\u51b5\u4e0b\u6709\u53ef\u4ee5\u5bfc\u81f4\u7f13\u5b58\u7684\u5931\u6548\u3002<\/p>\n<h4><span class=\"ez-toc-section\" id=\"%E7%BC%93%E5%AD%98%E7%9A%84%E4%B8%80%E8%87%B4%E6%80%A7\"><\/span>\u7f13\u5b58\u7684\u4e00\u81f4\u6027<span class=\"ez-toc-section-end\"><\/span><\/h4>\n<p>\u5bf9\u4e8e\u4e3b\u6d41\u7684CPU\u6765\u8bf4\uff0c\u7f13\u5b58\u7684\u5199\u64cd\u4f5c\u57fa\u672c\u4e0a\u662f\u4e24\u79cd\u7b56\u7565\uff08\u53c2\u770b\u672c\u7ad9\u300a<a href=\"https:\/\/coolshell.cn\/articles\/17416.html\" target=\"_blank\" rel=\"noopener noreferrer\">\u7f13\u5b58\u66f4\u65b0\u7684\u5957\u8def<\/a>\u300b\uff09\uff0c<\/p>\n<ul>\n<li>\u4e00\u79cd\u662fWrite Back\uff0c\u5199\u64cd\u4f5c\u53ea\u8981\u5728cache\u4e0a\uff0c\u7136\u540e\u518dflush\u5230\u5185\u5b58\u4e0a\u3002<\/li>\n<li>\u4e00\u79cd\u662fWrite Through\uff0c\u5199\u64cd\u4f5c\u540c\u65f6\u5199\u5230cache\u548c\u5185\u5b58\u4e0a\u3002<\/li>\n<\/ul>\n<p>\u4e3a\u4e86\u63d0\u9ad8\u5199\u7684\u6027\u80fd\uff0c\u4e00\u822c\u6765\u8bf4\uff0c\u4e3b\u6d41\u7684CPU\uff08\u5982\uff1aIntel Core i7\/i9\uff09\u91c7\u7528\u7684\u662fWrite Back\u7684\u7b56\u7565\uff0c\u56e0\u4e3a\u76f4\u63a5\u5199\u5185\u5b58\u5b9e\u5728\u662f\u592a\u6162\u4e86\u3002<\/p>\n<p>\u597d\u4e86\uff0c\u73b0\u5728\u95ee\u9898\u6765\u4e86\uff0c\u5982\u679c\u6709\u4e00\u4e2a\u6570\u636e x \u5728 CPU \u7b2c0\u6838\u7684\u7f13\u5b58\u4e0a\u88ab\u66f4\u65b0\u4e86\uff0c\u90a3\u4e48\u5176\u5b83CPU\u6838\u4e0a\u5bf9\u4e8e\u8fd9\u4e2a\u6570\u636e x \u7684\u503c\u4e5f\u8981\u88ab\u66f4\u65b0\uff0c\u8fd9\u5c31\u662f\u7f13\u5b58\u4e00\u81f4\u6027\u7684\u95ee\u9898\u3002\uff08\u5f53\u7136\uff0c\u5bf9\u4e8e\u6211\u4eec\u4e0a\u5c42\u7684\u7a0b\u5e8f\u6211\u4eec\u4e0d\u7528\u5173\u5fc3CPU\u591a\u4e2a\u6838\u7684\u7f13\u5b58\u662f\u600e\u4e48\u540c\u6b65\u7684\uff0c\u8fd9\u5bf9\u4e0a\u5c42\u7684\u4ee3\u7801\u6765\u8bf4\u90fd\u662f\u900f\u660e\u7684\uff09<\/p>\n<p>\u4e00\u822c\u6765\u8bf4\uff0c\u5728CPU\u786c\u4ef6\u4e0a\uff0c\u4f1a\u6709\u4e24\u79cd\u65b9\u6cd5\u6765\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u3002<\/p>\n<ul>\n<li><strong>Directory \u534f\u8bae<\/strong>\u3002\u8fd9\u79cd\u65b9\u6cd5\u7684\u5178\u578b\u5b9e\u73b0\u662f\u8981\u8bbe\u8ba1\u4e00\u4e2a\u96c6\u4e2d\u5f0f\u63a7\u5236\u5668\uff0c\u5b83\u662f\u4e3b\u5b58\u50a8\u5668\u63a7\u5236\u5668\u7684\u4e00\u90e8\u5206\u3002\u5176\u4e2d\u6709\u4e00\u4e2a\u76ee\u5f55\u5b58\u50a8\u5728\u4e3b\u5b58\u50a8\u5668\u4e2d\uff0c\u5176\u4e2d\u5305\u542b\u6709\u5173\u5404\u79cd\u672c\u5730\u7f13\u5b58\u5185\u5bb9\u7684\u5168\u5c40\u72b6\u6001\u4fe1\u606f\u3002\u5f53\u5355\u4e2aCPU Cache \u53d1\u51fa\u8bfb\u5199\u8bf7\u6c42\u65f6\uff0c\u8fd9\u4e2a\u96c6\u4e2d\u5f0f\u63a7\u5236\u5668\u4f1a\u68c0\u67e5\u5e76\u53d1\u51fa\u5fc5\u8981\u7684\u547d\u4ee4\uff0c\u4ee5\u5728\u4e3b\u5b58\u548cCPU Cache\u4e4b\u95f4\u6216\u5728CPU Cache\u81ea\u8eab\u4e4b\u95f4\u8fdb\u884c\u6570\u636e\u540c\u6b65\u548c\u4f20\u8f93\u3002<\/li>\n<li><strong>Snoopy \u534f\u8bae<\/strong>\u3002\u8fd9\u79cd\u534f\u8bae\u66f4\u50cf\u662f\u4e00\u79cd\u6570\u636e\u901a\u77e5\u7684\u603b\u7ebf\u578b\u7684\u6280\u672f\u3002CPU Cache\u901a\u8fc7\u8fd9\u4e2a\u534f\u8bae\u53ef\u4ee5\u8bc6\u522b\u5176\u5b83Cache\u4e0a\u7684\u6570\u636e\u72b6\u6001\u3002\u5982\u679c\u6709\u6570\u636e\u5171\u4eab\u7684\u8bdd\uff0c\u53ef\u4ee5\u901a\u8fc7\u5e7f\u64ad\u673a\u5236\u5c06\u5171\u4eab\u6570\u636e\u7684\u72b6\u6001\u901a\u77e5\u7ed9\u5176\u5b83CPU Cache\u3002\u8fd9\u4e2a\u534f\u8bae\u8981\u6c42\u6bcf\u4e2aCPU Cache \u90fd\u53ef\u4ee5<strong class=\"hu je\"><em class=\"io\">\u201c<\/em>\u7aa5\u63a2<em class=\"io\">\u201d<\/em><\/strong>\u6570\u636e\u4e8b\u4ef6\u7684\u901a\u77e5\u5e76\u505a\u51fa\u76f8\u5e94\u7684\u53cd\u5e94\u3002\u5982\u4e0b\u56fe\u6240\u793a\uff0c\u6709\u4e00\u4e2aSnoopy Bus\u7684\u603b\u7ebf\u3002<\/li>\n<\/ul>\n<p><strong><img decoding=\"async\" loading=\"lazy\" class=\"aligncenter wp-image-20797\" style=\"font-weight: 400;\" src=\"https:\/\/coolshell.cn\/wp-content\/uploads\/2020\/02\/The-cache-coherence-problem-Initially-processors-0-and-1-both-read-location-x.png\" alt=\"\" width=\"400\" height=\"217\" srcset=\"https:\/\/coolshell.cn\/wp-content\/uploads\/2020\/02\/The-cache-coherence-problem-Initially-processors-0-and-1-both-read-location-x.png 850w, https:\/\/coolshell.cn\/wp-content\/uploads\/2020\/02\/The-cache-coherence-problem-Initially-processors-0-and-1-both-read-location-x-300x163.png 300w, https:\/\/coolshell.cn\/wp-content\/uploads\/2020\/02\/The-cache-coherence-problem-Initially-processors-0-and-1-both-read-location-x-768x417.png 768w, https:\/\/coolshell.cn\/wp-content\/uploads\/2020\/02\/The-cache-coherence-problem-Initially-processors-0-and-1-both-read-location-x-498x270.png 498w\" sizes=\"(max-width: 400px) 100vw, 400px\" \/><\/strong><\/p>\n<p>\u56e0\u4e3aDirectory\u534f\u8bae\u662f\u4e00\u4e2a\u4e2d\u5fc3\u5f0f\u7684\uff0c\u4f1a\u6709\u6027\u80fd\u74f6\u9888\uff0c\u800c\u4e14\u4f1a\u589e\u52a0\u6574\u4f53\u8bbe\u8ba1\u7684\u590d\u6742\u5ea6\u3002\u800cSnoopy\u534f\u8bae\u66f4\u50cf\u662f\u5fae\u670d\u52a1+\u6d88\u606f\u901a\u8baf\uff0c\u6240\u4ee5\uff0c\u73b0\u5728\u57fa\u672c\u90fd\u662f\u4f7f\u7528Snoopy\u7684\u603b\u7ebf\u7684\u8bbe\u8ba1\u3002<\/p>\n<p>\u8fd9\u91cc\uff0c\u6211\u60f3\u591a\u5199\u4e00\u4e9b\u7ec6\u8282\uff0c\u56e0\u4e3a\u8fd9\u79cd\u5fae\u89c2\u7684\u4e1c\u897f\uff0c\u8ba9\u4eba\u4e0d\u81ea\u7136\u5730\u5c31\u4f1a\u8ddf\u5206\u5e03\u5f0f\u7cfb\u7edf\u5173\u8054\u8d77\u6765\uff0c\u5728\u5206\u5e03\u5f0f\u7cfb\u7edf\u4e2d\u6211\u4eec\u4e00\u822c\u7528Paxos\/Raft\u8fd9\u6837\u7684\u5206\u5e03\u5f0f\u4e00\u81f4\u6027\u7684\u7b97\u6cd5\u3002\u800c\u5728CPU\u7684\u5fae\u89c2\u4e16\u754c\u91cc\uff0c\u5219\u4e0d\u5fc5\u4f7f\u7528\u8fd9\u6837\u7684\u7b97\u6cd5\uff0c\u539f\u56e0\u662f\u56e0\u4e3aCPU\u7684\u591a\u4e2a\u6838\u7684\u786c\u4ef6\u4e0d\u5fc5\u8003\u8651\u7f51\u7edc\u4f1a\u65ad\u4f1a\u5ef6\u8fdf\u7684\u95ee\u9898\u3002\u6240\u4ee5\uff0cCPU\u7684\u591a\u6838\u5fc3\u7f13\u5b58\u95f4\u7684\u540c\u6b65\u7684\u6838\u5fc3\u5c31\u662f\u8981\u7ba1\u7406\u597d\u6570\u636e\u7684\u72b6\u6001\u5c31\u597d\u4e86\u3002<\/p>\n<p>\u8fd9\u91cc\u4ecb\u7ecd\u51e0\u4e2a\u72b6\u6001\u534f\u8bae\uff0c\u5148\u4ece\u6700\u7b80\u5355\u7684\u5f00\u59cb\uff0cMESI\u534f\u8bae\uff0c\u8fd9\u4e2a\u534f\u8bae\u8ddf\u90a3\u4e2a\u8457\u540d\u7684\u8db3\u7403\u8fd0\u52a8\u5458\u6885\u897f\u6ca1\u4ec0\u4e48\u5173\u7cfb\uff0c\u5176\u4e3b\u8981\u8868\u793a\u7f13\u5b58\u6570\u636e\u6709\u56db\u4e2a\u72b6\u6001\uff1aModified\uff08\u5df2\u4fee\u6539\uff09, Exclusive\uff08\u72ec\u5360\u7684\uff09,Shared\uff08\u5171\u4eab\u7684\uff09\uff0cInvalid\uff08\u65e0\u6548\u7684\uff09\u3002<\/p>\n<p>\u8fd9\u4e9b\u72b6\u6001\u7684\u72b6\u6001\u673a\u5982\u4e0b\u6240\u793a\uff08\u6709\u70b9\u590d\u6742\uff0c\u4f60\u53ef\u4ee5\u5148\u4e0d\u770b\uff0c\u8fd9\u4e2a\u56fe\u5c31\u662f\u60f3\u544a\u8bc9\u4f60\u72b6\u6001\u63a7\u5236\u6709\u591a\u590d\u6742\uff09\uff1a<\/p>\n<p><img decoding=\"async\" loading=\"lazy\" class=\"aligncenter size-full wp-image-20804\" src=\"https:\/\/coolshell.cn\/wp-content\/uploads\/2020\/02\/MESI.png\" alt=\"\" width=\"420\" height=\"406\" srcset=\"https:\/\/coolshell.cn\/wp-content\/uploads\/2020\/02\/MESI.png 420w, https:\/\/coolshell.cn\/wp-content\/uploads\/2020\/02\/MESI-300x290.png 300w, https:\/\/coolshell.cn\/wp-content\/uploads\/2020\/02\/MESI-279x270.png 279w\" sizes=\"(max-width: 420px) 100vw, 420px\" \/><\/p>\n<p>\u4e0b\u9762\u662f\u4e2a\u793a\u4f8b\uff08\u5982\u679c\u4f60\u60f3\u770b\u4e00\u4e0b\u52a8\u753b\u6f14\u793a\u7684\u8bdd\uff0c\u8fd9\u91cc\u6709\u4e00\u4e2a\u7f51\u9875\uff08<a href=\"https:\/\/www.scss.tcd.ie\/Jeremy.Jones\/VivioJS\/caches\/MESIHelp.htm\" target=\"_blank\" rel=\"noopener noreferrer\">MESI Interactive Animations<\/a>\uff09\uff0c\u4f60\u53ef\u4ee5\u8fdb\u884c\u4ea4\u4e92\u64cd\u4f5c\uff0c\u8fd9\u4e2a\u52a8\u753b\u6f14\u793a\u4e2d\u4f7f\u7528\u7684Write Through\u7b97\u6cd5\uff09\uff1a<\/p>\n<table>\n<thead>\n<tr>\n<th>\u5f53\u524d\u64cd\u4f5c<\/th>\n<th>CPU0<\/th>\n<th>CPU1<\/th>\n<th>Memory<\/th>\n<th>\u8bf4\u660e<\/th>\n<\/tr>\n<\/thead>\n<tbody>\n<tr>\n<td>1) CPU0 read(x)<\/td>\n<td>\u00a0x=1 (E)<\/td>\n<td><\/td>\n<td>x=1<\/td>\n<td>\u53ea\u6709\u4e00\u4e2aCPU\u6709 x \u53d8\u91cf\uff0c<br \/>\n\u6240\u4ee5\uff0c\u72b6\u6001\u662f Exclusive<\/td>\n<\/tr>\n<tr>\n<td>2) CPU1 read(x)<\/td>\n<td>\u00a0x=1 (S)<\/td>\n<td>x=1(S)<\/td>\n<td>x=1<\/td>\n<td>\u6709\u4e24\u4e2aCPU\u90fd\u8bfb\u53d6 x \u53d8\u91cf\uff0c<br \/>\n\u6240\u4ee5\u72b6\u6001\u53d8\u6210 Shared<\/td>\n<\/tr>\n<tr>\n<td>3) CPU0 write(x,9)<\/td>\n<td>\u00a0x=<span style=\"color: #ff0000;\">9<\/span> (M)<\/td>\n<td>x=1(I)<\/td>\n<td>x=1<\/td>\n<td>\u53d8\u91cf\u6539\u53d8\uff0c\u5728CPU0\u4e2d\u72b6\u6001<br \/>\n\u53d8\u6210 Modified\uff0c\u5728CPU1\u4e2d<br \/>\n\u72b6\u6001\u53d8\u6210 Invalid<\/td>\n<\/tr>\n<tr>\n<td>4) \u53d8\u91cf x\u00a0\u5199\u56de\u5185\u5b58<\/td>\n<td>\u00a0x=9 (M)<\/td>\n<td>X=1(I)<\/td>\n<td>x=9<\/td>\n<td>\u76ee\u524d\u7684\u72b6\u6001\u4e0d\u53d8<\/td>\n<\/tr>\n<tr>\n<td>5) CPU1\u00a0 read(x)<\/td>\n<td>\u00a0x=9 (S)<\/td>\n<td>x=9(S)<\/td>\n<td>x=9<\/td>\n<td>\u53d8\u91cf\u540c\u6b65\u5230\u6240\u6709\u7684Cache\u4e2d\uff0c<br \/>\n\u72b6\u6001\u56de\u5230Shared<\/td>\n<\/tr>\n<\/tbody>\n<\/table>\n<p>&nbsp;<\/p>\n<p>MESI \u8fd9\u79cd\u534f\u8bae\u5728\u6570\u636e\u66f4\u65b0\u540e\uff0c\u4f1a\u6807\u8bb0\u5176\u5b83\u5171\u4eab\u7684CPU\u7f13\u5b58\u7684\u6570\u636e\u62f7\u8d1d\u4e3aInvalid\u72b6\u6001\uff0c\u7136\u540e\u5f53\u5176\u5b83CPU\u518d\u6b21read\u7684\u65f6\u5019\uff0c\u5c31\u4f1a\u51fa\u73b0 cache miss \u7684\u95ee\u9898\uff0c\u6b64\u65f6\u518d\u4ece\u5185\u5b58\u4e2d\u66f4\u65b0\u6570\u636e\u3002\u4ece\u5185\u5b58\u4e2d\u66f4\u65b0\u6570\u636e\u610f\u5473\u774020\u500d\u901f\u5ea6\u7684\u964d\u4f4e\u3002\u6211\u4eec\u80fd\u4e0d\u80fd\u76f4\u63a5\u4ece\u6211\u9694\u58c1\u7684CPU\u7f13\u5b58\u4e2d\u66f4\u65b0\uff1f\u662f\u7684\uff0c\u8fd9\u5c31\u53ef\u4ee5\u589e\u52a0\u5f88\u591a\u901f\u5ea6\u4e86\uff0c\u4f46\u662f\u72b6\u6001\u63a7\u5236\u4e5f\u5c31\u53d8\u9ebb\u70e6\u4e86\u3002\u8fd8\u9700\u8981\u591a\u6765\u4e00\u4e2a\u72b6\u6001\uff1aOwner(\u5bbf\u4e3b)\uff0c\u7528\u4e8e\u6807\u8bb0\uff0c\u6211\u662f\u66f4\u65b0\u6570\u636e\u7684\u6e90\u3002\u4e8e\u662f\uff0c\u51fa\u73b0\u4e86 <a href=\"https:\/\/en.wikipedia.org\/wiki\/MOESI_protocol\" target=\"_blank\" rel=\"noopener noreferrer\">MOESI \u534f\u8bae<\/a><\/p>\n<p>MOESI\u534f\u8bae\u7684\u72b6\u6001\u673a\u548c\u6f14\u793a\u793a\u4f8b\u6211\u5c31\u4e0d\u8d34\u4e86\uff08\u6709\u5174\u8da3\u53ef\u4ee5\u4e0a<a href=\"https:\/\/inst.eecs.berkeley.edu\/~cs61c\/su18\/disc\/11\/Disc11Sol.pdf\" target=\"_blank\" rel=\"noopener\">Berkeley\u4e0a\u770b\u770b\u76f8\u5173\u7684\u8bfe\u4ef6<\/a>\uff09\uff0c<strong>\u6211\u4eec\u53ea\u9700\u8981\u7406\u89e3MOESI\u534f\u8bae\u5141\u8bb8 CPU Cache \u95f4\u540c\u6b65\u6570\u636e\uff0c\u4e8e\u662f\u4e5f\u964d\u4f4e\u4e86\u5bf9\u5185\u5b58\u7684\u64cd\u4f5c<\/strong>\uff0c\u6027\u80fd\u662f\u975e\u5e38\u5927\u7684\u63d0\u5347\uff0c\u4f46\u662f\u63a7\u5236\u903b\u8f91\u4e5f\u975e\u5e38\u590d\u6742\u3002<\/p>\n<p>\u987a\u4fbf\u8bf4\u4e00\u4e0b\uff0c\u4e0e MOESI \u534f\u8bae\u7c7b\u4f3c\u7684\u4e00\u4e2a\u534f\u8bae\u662f <a href=\"https:\/\/en.wikipedia.org\/wiki\/MESIF_protocol\" target=\"_blank\" rel=\"noopener noreferrer\">MESIF<\/a>\uff0c\u5176\u4e2d\u7684 F \u662f Forward\uff0c\u540c\u6837\u662f\u628a\u66f4\u65b0\u8fc7\u7684\u6570\u636e\u8f6c\u53d1\u7ed9\u522b\u7684 CPU Cache \u4f46\u662f\uff0cMOESI \u4e2d\u7684 Owner \u72b6\u6001 \u548cMESIF \u4e2d\u7684 Forward \u72b6\u6001\u6709\u4e00\u4e2a\u975e\u5e38\u5927\u7684\u4e0d\u4e00\u6837\u2014\u2014 <strong>Owner\u72b6\u6001\u4e0b\u7684\u6570\u636e\u662fdirty\u7684\uff0c\u8fd8\u6ca1\u6709\u5199\u56de\u5185\u5b58\uff0cForward\u72b6\u6001\u4e0b\u7684\u6570\u636e\u662fclean\u7684\uff0c\u53ef\u4ee5\u4e22\u5f03\u800c\u4e0d\u7528\u53e6\u884c\u901a\u77e5<\/strong>\u3002<\/p>\n<p>\u9700\u8981\u8bf4\u660e\u7684\u662f\uff0cAMD\u7528MOESI\uff0cIntel\u7528MESIF\u3002\u6240\u4ee5\uff0cF \u72b6\u6001\u4e3b\u8981\u662f\u9488\u5bf9 CPU L3 Cache \u8bbe\u8ba1\u7684\uff08\u524d\u9762\u6211\u4eec\u8bf4\u8fc7\uff0cL3\u662f\u6240\u6709CPU\u6838\u5fc3\u5171\u4eab\u7684\uff09\u3002\uff08\u76f8\u5173\u7684\u6bd4\u8f83\u53ef\u4ee5\u53c2\u770b<a href=\"https:\/\/stackoverflow.com\/a\/49989985\" target=\"_blank\" rel=\"noopener noreferrer\">StackOverlow\u4e0a\u8fd9\u4e2a\u95ee\u9898\u7684\u7b54\u6848<\/a>\uff09<\/p>\n<h4><span class=\"ez-toc-section\" id=\"%E7%A8%8B%E5%BA%8F%E6%80%A7%E8%83%BD\"><\/span>\u7a0b\u5e8f\u6027\u80fd<span class=\"ez-toc-section-end\"><\/span><\/h4>\n<p>\u4e86\u89e3\u4e86\u6211\u4eec\u4e0a\u9762\u7684\u8fd9\u4e9b\u4e1c\u897f\u540e\uff0c\u6211\u4eec\u6765\u770b\u4e00\u4e0b\u5bf9\u4e8e\u7a0b\u5e8f\u7684\u5f71\u54cd\u3002<\/p>\n<h5><span class=\"ez-toc-section\" id=\"%E7%A4%BA%E4%BE%8B%E4%B8%80\"><\/span>\u793a\u4f8b\u4e00<span class=\"ez-toc-section-end\"><\/span><\/h5>\n<p>\u9996\u5148\uff0c\u5047\u8bbe\u6211\u4eec\u6709\u4e00\u4e2a64M\u957f\u7684\u6570\u7ec4\uff0c\u8bbe\u60f3\u4e00\u4e0b\u4e0b\u9762\u7684\u4e24\u4e2a\u5faa\u73af\uff1a<\/p>\n<pre class=\"EnlighterJSRAW\" data-enlighter-language=\"cpp\">const int LEN = 64*1024*1024;\nint *arr = new int[LEN];\n\nfor (int i = 0; i &lt; LEN; i += 2) arr[i] *= i;\n\nfor (int i = 0; i &lt; LEN; i += 8) arr[i] *= i;<\/pre>\n<p>\u6309\u6211\u4eec\u7684\u60f3\u6cd5\u6765\u770b\uff0c\u7b2c\u4e8c\u4e2a\u5faa\u73af\u8981\u6bd4\u7b2c\u4e00\u4e2a\u5faa\u73af\u5c114\u500d\u7684\u8ba1\u7b97\u91cf\uff0c\u5176\u5e94\u8be5\u4e5f\u662f\u8981\u5feb4\u500d\u7684\u3002\u4f46\u5b9e\u9645\u8dd1\u4e0b\u6765\u5e76\u4e0d\u662f\uff0c<strong>\u5728\u6211\u7684\u673a\u5668\u4e0a\uff0c\u7b2c\u4e00\u4e2a\u5faa\u73af\u9700\u8981127\u6beb\u79d2\uff0c\u7b2c\u4e8c\u4e2a\u5faa\u73af\u5219\u9700\u8981121\u6beb\u79d2\uff0c\u76f8\u5dee\u65e0\u51e0<\/strong>\u3002\u8fd9\u91cc\u6700\u4e3b\u8981\u7684\u539f\u56e0\u5c31\u662f Cache Line\uff0c\u56e0\u4e3aCPU\u4f1a\u4ee5\u4e00\u4e2aCache Line 64Bytes\u6700\u5c0f\u65f6\u5355\u4f4d\u52a0\u8f7d\uff0c\u4e5f\u5c31\u662f16\u4e2a32bits\u7684\u6574\u578b\uff0c\u6240\u4ee5\uff0c\u65e0\u8bba\u4f60\u6b65\u957f\u662f2\u8fd8\u662f8\uff0c\u90fd\u5dee\u4e0d\u591a\u3002\u800c\u540e\u9762\u7684\u4e58\u6cd5\u5176\u5b9e\u662f\u4e0d\u8017CPU\u65f6\u95f4\u7684\u3002<\/p>\n<h5><span class=\"ez-toc-section\" id=\"%E7%A4%BA%E4%BE%8B%E4%BA%8C\"><\/span>\u793a\u4f8b\u4e8c<span class=\"ez-toc-section-end\"><\/span><\/h5>\n<p>\u6211\u4eec\u518d\u6765\u770b\u4e00\u4e2a\u4e0e\u7f13\u5b58\u547d\u4e2d\u7387\u6709\u5173\u7684\u4ee3\u7801\uff0c\u6211\u4eec\u4ee5\u4e00\u5b9a\u7684\u6b65\u957f<code>increment<\/code> \u6765\u8bbf\u95ee\u4e00\u4e2a\u8fde\u7eed\u7684\u6570\u7ec4\u3002<\/p>\n<pre class=\"EnlighterJSRAW\" data-enlighter-language=\"cpp\">for (int i = 0; i &lt; 10000000; i++) {\n    for (int j = 0; j &lt; size; j += increment) {\n        memory[j] += j;\n    }\n}<\/pre>\n<p>\u6211\u4eec\u6d4b\u8bd5\u4e00\u4e0b\uff0c\u5728\u4e0b\u8868\u4e2d\uff0c \u8868\u5934\u662f\u6b65\u957f\uff0c\u4e5f\u5c31\u662f\u6bcf\u6b21\u8df3\u591a\u5c11\u4e2a\u6574\u6570\uff0c\u800c\u7eb5\u5411\u662f\u8fd9\u4e2a\u6570\u7ec4\u53ef\u4ee5\u8df3\u51e0\u6b21\uff08\u4f60\u53ef\u4ee5\u7406\u89e3\u4e3a\u8981\u51e0\u6761Cache Line\uff09\uff0c\u4e8e\u662f\u8868\u4e2d\u7684\u4efb\u4f55\u4e00\u9879\u4ee3\u8868\u4e86\u8fd9\u4e2a\u6570\u7ec4\u6709\u591a\u5c11\uff0c\u800c\u4e14\u6b65\u957f\u662f\u591a\u5c11\u3002\u6bd4\u5982\uff1a\u6a2a\u8f74\u662f 512\uff0c\u7eb5\u8f74\u662f4\uff0c\u610f\u601d\u662f\uff0c\u8fd9\u4e2a\u6570\u7ec4\u6709 <code>4*512 = 2048<\/code> \u4e2a\u957f\u5ea6\uff0c\u8bbf\u95ee\u65f6\u6309512\u6b65\u957f\u8bbf\u95ee\uff0c\u4e5f\u5c31\u662f\u8bbf\u95ee\u5176\u4e2d\u7684\u8fd9\u51e0\u9879\uff1a<code>[0, 512, 1024, 1536]<\/code> \u8fd9\u56db\u9879\u3002<\/p>\n<p>\u8868\u4e2d\u540c\u7684\u9879\u662f\uff0c\u662f\u5faa\u73af1000\u4e07\u6b21\u7684\u65f6\u95f4\uff0c\u5355\u4f4d\u662f\u201c\u5fae\u79d2\u201d\uff08\u9664\u4ee51000\u540e\u662f\u6beb\u79d2\uff09<\/p>\n<pre>| count |   1    |   16  |  512  | 1024  |\n------------------------------------------\n|     1 |  17539 | 16726 | 15143 | 14477 |\n|     2 |  15420 | 14648 | 13552 | 13343 |\n|     3 |  14716 | 14463 | 15086 | 17509 |\n|     4 |  18976 | 18829 | 18961 | 21645 |\n|     5 |  23693 | 23436 | 74349 | 29796 |\n|     6 |  23264 | 23707 | 27005 | 44103 |\n|     7 |  28574 | 28979 | 33169 | 58759 |\n|     8 |  33155 | 34405 | 39339 | 65182 |\n|     9 |  37088 | 37788 | 49863 |<span style=\"color: #cc0000;\"><strong>156745<\/strong><\/span> |\n|    10 |  41543 | 42103 | 58533 |<span style=\"color: #cc0000;\"><strong>215278<\/strong><\/span> |\n|    11 |  47638 | 50329 | 66620 |<span style=\"color: #cc0000;\"><strong>335603<\/strong><\/span> |\n|    12 |  49759 | 51228 | 75087 |<span style=\"color: #cc0000;\"><strong>305075<\/strong><\/span> |\n|    13 |  53938 | 53924 | 77790 |<span style=\"color: #cc0000;\"><strong>366879<\/strong><\/span> |\n|    14 |  58422 | 59565 | 90501 |<span style=\"color: #cc0000;\"><strong>466368<\/strong><\/span> |\n|    15 |  62161 | 64129 | 90814 |<span style=\"color: #cc0000;\"><strong>525780<\/strong><\/span> |\n|    16 |  67061 | 66663 | 98734 |<span style=\"color: #cc0000;\"><strong>440558<\/strong><\/span> |\n|    17 |  71132 | 69753 |<span style=\"color: #cc0000;\"><strong>171203<\/strong><\/span> |<span style=\"color: #cc0000;\"><strong>506631<\/strong><\/span> |\n|    18 |  74102 | 73130 |<span style=\"color: #cc0000;\"><strong>293947<\/strong><\/span> |<span style=\"color: #cc0000;\"><strong>550920<\/strong><\/span> |\n<\/pre>\n<p>\u6211\u4eec\u53ef\u4ee5\u770b\u5230\uff0c\u4ece <code>[9\uff0c1024]<\/code> \u4ee5\u540e\uff0c\u65f6\u95f4\u663e\u8457\u4e0a\u5347\u3002\u5305\u62ec <code>[17\uff0c512]<\/code> \u548c <code>[18,512]<\/code> \u4e5f\u663e\u8457\u4e0a\u5347\u3002\u8fd9\u662f\u56e0\u4e3a\uff0c\u6211\u673a\u5668\u7684 L1 Cache \u662f 32KB, 8 Way \u7684\uff0c\u524d\u9762\u8bf4\u8fc7\uff0c8 Way\u7684\u670964\u7ec4\uff0c\u6bcf\u7ec48\u4e2aCache Line\uff0c\u5f53for-loop\u6b65\u957f\u8d85\u8fc71024\u4e2a\u6574\u578b\uff0c\u4e5f\u5c31\u662f\u6b63\u597d 4096 Bytes\u65f6\uff0c\u4e5f\u5c31\u662f\u5bfc\u81f4\u5185\u5b58\u5730\u5740\u7684\u53d8\u5316\u662f\u53d8\u5316\u5728\u9ad8\u4f4d\u768424bits\u4e0a\uff0c\u800c\u4f4e\u4f4d\u768412bits\u53d8\u5316\u4e0d\u5927\uff0c\u5c24\u5176\u662f\u4e2d\u95f46bits\u6ca1\u6709\u53d8\u5316\uff0c\u5bfc\u81f4\u5168\u90e8\u547d\u4e2d\u540c\u4e00\u7ec4set\uff0c\u5bfc\u81f4\u5927\u91cf\u7684cache \u51b2\u7a81\uff0c\u5bfc\u81f4\u6027\u80fd\u4e0b\u964d\uff0c\u65f6\u95f4\u4e0a\u5347\u3002\u800c [16, 512]\u4e5f\u662f\u4e00\u6837\u7684\uff0c\u5176\u4e2d\u7684\u51e0\u6b65\u5f00\u59cb\u5bfc\u81f4L1 Cache\u5f00\u59cb\u51b2\u7a81\u5931\u6548\u3002<\/p>\n<h5><span class=\"ez-toc-section\" id=\"%E7%A4%BA%E4%BE%8B%E4%B8%89\"><\/span>\u793a\u4f8b\u4e09<span class=\"ez-toc-section-end\"><\/span><\/h5>\n<p>\u63a5\u4e0b\u6765\uff0c\u6211\u4eec\u518d\u6765\u770b\u4e2a\u793a\u4f8b\u3002\u4e0b\u9762\u662f\u4e00\u4e2a\u4e8c\u7ef4\u6570\u7ec4\u7684\u4e24\u79cd\u904d\u5386\u65b9\u5f0f\uff0c\u4e00\u4e2a\u9010\u884c\u904d\u5386\uff0c\u4e00\u4e2a\u662f\u9010\u5217\u904d\u5386\uff0c\u8fd9\u4e24\u79cd\u65b9\u5f0f\u5728\u7406\u8bba\u4e0a\u6765\u8bf4\uff0c\u5bfb\u5740\u548c\u8ba1\u7b97\u91cf\u90fd\u662f\u4e00\u6837\u7684\uff0c\u6267\u884c\u65f6\u95f4\u5e94\u8be5\u4e5f\u662f\u4e00\u6837\u7684\u3002<\/p>\n<pre class=\"EnlighterJSRAW\" data-enlighter-language=\"cpp\">const int row = 1024;\nconst int col = 512\nint matrix[row][col];\n\n\/\/\u9010\u884c\u904d\u5386\nint sum_row=0;\nfor(int _r=0; _r&lt;row; _r++) {\n    for(int _c=0; _c&lt;col; _c++){\n        sum_row += matrix[_r][_c];\n    }\n}\n\n\/\/\u9010\u5217\u904d\u5386\nint sum_col=0;\nfor(int _c=0; _c&lt;col; _c++) {\n    for(int _r=0; _r&lt;row; _r++){\n        sum_col += matrix[_r][_c];\n    }\n}<\/pre>\n<p>\u7136\u800c\uff0c\u5e76\u4e0d\u662f\uff0c\u5728\u6211\u7684\u673a\u5668\u4e0a\uff0c\u5f97\u5230\u4e0b\u9762\u7684\u7ed3\u679c\u3002<\/p>\n<ul>\n<li>\u9010\u884c\u904d\u5386\uff1a0.081ms<\/li>\n<li>\u9010\u5217\u904d\u5386\uff1a1.069ms<\/li>\n<\/ul>\n<p>\u6267\u884c\u65f6\u95f4\u6709\u5341\u51e0\u500d\u7684\u5dee\u8ddd\u3002\u5176\u4e2d\u7684\u539f\u56e0\uff0c\u5c31\u662f\u9010\u5217\u904d\u5386\u5bf9\u4e8eCPU Cache \u7684\u8fd0\u4f5c\u65b9\u5f0f\u5e76\u4e0d\u53cb\u597d\uff0c\u6240\u4ee5\uff0c\u4ed8\u51fa\u5de8\u5927\u7684\u4ee3\u4ef7\u3002<\/p>\n<h5><span class=\"ez-toc-section\" id=\"%E7%A4%BA%E4%BE%8B%E5%9B%9B\"><\/span>\u793a\u4f8b\u56db<span class=\"ez-toc-section-end\"><\/span><\/h5>\n<p>\u63a5\u4e0b\u6765\uff0c\u6211\u4eec\u6765\u770b\u4e00\u4e0b\u591a\u6838\u4e0b\u7684\u6027\u80fd\u95ee\u9898\uff0c\u53c2\u770b\u5982\u4e0b\u7684\u4ee3\u7801\u3002\u4e24\u4e2a\u7ebf\u7a0b\u5728\u64cd\u4f5c\u4e00\u4e2a\u6570\u7ec4\u7684\u4e24\u4e2a\u4e0d\u540c\u7684\u5143\u7d20\uff08\u65e0\u9700\u52a0\u9501\uff09\uff0c\u7ebf\u7a0b\u5faa\u73af1000\u4e07\u6b21\uff0c\u505a\u52a0\u6cd5\u64cd\u4f5c\u3002\u5728\u4e0b\u9762\u7684\u4ee3\u7801\u4e2d\uff0c\u6211\u9ad8\u4eae\u4e86\u4e00\u884c\uff0c\u5c31\u662f<code>p2<\/code>\u6307\u9488\uff0c\u8981\u4e48\u662f<code>p[1]<\/code>\uff0c\u6216\u662f <code>p[30]<\/code>\uff0c\u7406\u8bba\u4e0a\u6765\u8bf4\uff0c\u65e0\u8bba\u8bbf\u95ee\u54ea\u4e24\u4e2a\u6570\u7ec4\u5143\u7d20\uff0c\u90fd\u5e94\u8be5\u662f\u4e00\u6837\u7684\u6267\u884c\u65f6\u95f4\u3002<\/p>\n<pre class=\"EnlighterJSRAW\" data-enlighter-language=\"cpp\" data-enlighter-highlight=\"9\">void fn (int* data) {\n    for(int i = 0; i &lt; 10*1024*1024; ++i)\n        *data += rand();\n}\n\nint p[32];\n\nint *p1 = &amp;p[0];\nint *p2 = &amp;p[1]; \/\/ int *p2 = &amp;p[30];\n\nthread t1(fn, p1);\nthread t2(fn, p2);<\/pre>\n<p>\u7136\u800c\uff0c\u5e76\u4e0d\u662f\uff0c\u5728\u6211\u7684\u673a\u5668\u4e0a\u6267\u884c\u4e0b\u6765\u7684\u7ed3\u679c\u662f\uff1a<\/p>\n<ul>\n<li>\u5bf9\u4e8e <code>p[0]<\/code> \u548c <code>p[1]<\/code> \uff1a560ms<\/li>\n<li>\u5bf9\u4e8e <code>p[0]<\/code> \u548c <code>p[30]<\/code>\uff1a104ms<\/li>\n<\/ul>\n<p>\u8fd9\u662f\u56e0\u4e3a <code>p[0]<\/code> \u548c <code>p[1]<\/code> \u5728\u540c\u4e00\u6761 Cache Line \u4e0a\uff0c\u800c <code>p[0]<\/code> \u548c <code>p[30]<\/code> \u5219\u4e0d\u53ef\u80fd\u5728\u540c\u4e00\u6761Cache Line \u4e0a \uff0cCPU\u7684\u7f13\u5b58\u6700\u5c0f\u7684\u66f4\u65b0\u5355\u4f4d\u662fCache Line\uff0c\u6240\u4ee5\uff0c<strong>\u8fd9\u5bfc\u81f4\u867d\u7136\u4e24\u4e2a\u7ebf\u7a0b\u5728\u5199\u4e0d\u540c\u7684\u6570\u636e\uff0c\u4f46\u662f\u56e0\u4e3a\u8fd9\u4e24\u4e2a\u6570\u636e\u5728\u540c\u4e00\u6761Cache Line\u4e0a\uff0c\u5c31\u4f1a\u5bfc\u81f4\u7f13\u5b58\u9700\u8981\u4e0d\u65ad\u8fdb\u5728\u4e24\u4e2aCPU\u7684L1\/L2\u4e2d\u8fdb\u884c\u540c\u6b65\uff0c\u4ece\u800c\u5bfc\u81f4\u4e865\u500d\u7684\u65f6\u95f4\u5dee\u5f02<\/strong>\u3002<\/p>\n<h5><span class=\"ez-toc-section\" id=\"%E7%A4%BA%E4%BE%8B%E4%BA%94\"><\/span>\u793a\u4f8b\u4e94<span class=\"ez-toc-section-end\"><\/span><\/h5>\n<p>\u63a5\u4e0b\u6765\uff0c\u6211\u4eec\u518d\u6765\u770b\u4e00\u4e0b\u53e6\u5916\u4e00\u6bb5\u4ee3\u7801\uff1a\u6211\u4eec\u60f3\u7edf\u8ba1\u4e00\u4e0b\u4e00\u4e2a\u6570\u7ec4\u4e2d\u7684\u5947\u6570\u4e2a\u6570\uff0c\u4f46\u662f\u8fd9\u4e2a\u6570\u7ec4\u592a\u5927\u4e86\uff0c\u6211\u4eec\u5e0c\u671b\u53ef\u4ee5\u7528\u591a\u7ebf\u7a0b\u6765\u5b8c\u6210\u8fd9\u4e2a\u7edf\u8ba1\u3002\u4e0b\u9762\u7684\u4ee3\u7801\u4e2d\uff0c<strong>\u6211\u4eec\u4e3a\u6bcf\u4e00\u4e2a\u7ebf\u7a0b\u4f20\u5165\u4e00\u4e2a id \uff0c\u7136\u540e\u901a\u8fc7\u8fd9\u4e2a id \u6765\u5b8c\u6210\u5bf9\u5e94\u6570\u7ec4\u6bb5\u7684\u7edf\u8ba1\u4efb\u52a1\u3002\u8fd9\u6837\u53ef\u4ee5\u52a0\u5feb\u6574\u4e2a\u5904\u7406\u901f\u5ea6<\/strong>\u3002<\/p>\n<pre class=\"EnlighterJSRAW\" data-enlighter-language=\"cpp\">int total_size = 16 * 1024 * 1024; \/\/\u6570\u7ec4\u957f\u5ea6\nint* test_data = new test_data[total_size]; \/\/\u6570\u7ec4\nint nthread = 6; \/\/\u7ebf\u7a0b\u6570\uff08\u56e0\u4e3a\u6211\u7684\u673a\u5668\u662f6\u6838\u7684\uff09\nint result[nthread]; \/\/\u6536\u96c6\u7ed3\u679c\u7684\u6570\u7ec4\n\nvoid thread_func (int id) {\n    result[id] = 0;\n    int chunk_size = total_size \/ nthread + 1;\n    int start = id * chunk_size;\n    int end = min(start + chunk_size, total_size);\n\n    for ( int i = start; i &lt; end; ++i ) {\n        if (test_data[i] % 2 != 0 ) ++result[id];\n    }\n}<\/pre>\n<p>\u7136\u800c\uff0c\u5728\u6267\u884c\u8fc7\u7a0b\u4e2d\uff0c<strong>\u4f60\u4f1a\u53d1\u73b0\uff0c6\u4e2a\u7ebf\u7a0b\u5c45\u7136\u8dd1\u4e0d\u8fc71\u4e2a\u7ebf\u7a0b<\/strong>\u3002\u56e0\u4e3a\u6839\u636e\u4e0a\u9762\u7684\u4f8b\u5b50\u4f60\u77e5\u9053 <code>result[]<\/code> \u8fd9\u4e2a\u6570\u7ec4\u4e2d\u7684\u6570\u636e\u5728\u4e00\u4e2aCache Line\u4e2d\uff0c\u6240\u4ee5\uff0c\u6240\u6709\u7684\u7ebf\u7a0b\u90fd\u4f1a\u5bf9\u8fd9\u4e2a Cache Line \u8fdb\u884c\u5199\u64cd\u4f5c\uff0c\u5bfc\u81f4\u6240\u6709\u7684\u7ebf\u7a0b\u90fd\u5728\u4e0d\u65ad\u5730\u91cd\u65b0\u540c\u6b65 <code>result[]<\/code> \u6240\u5728\u7684 Cache Line\uff0c\u6240\u4ee5\uff0c\u5bfc\u81f4 6 \u4e2a\u7ebf\u7a0b\u8fd8\u8dd1\u4e0d\u8fc7\u4e00\u4e2a\u7ebf\u7a0b\u7684\u7ed3\u679c\u3002\u8fd9\u53eb <strong>False Sharing<\/strong>\u3002<\/p>\n<p>\u4f18\u5316\u4e5f\u5f88\u7b80\u5355\uff0c\u4f7f\u7528\u4e00\u4e2a\u7ebf\u7a0b\u5185\u7684\u53d8\u91cf\u3002<\/p>\n<pre class=\"EnlighterJSRAW\" data-enlighter-language=\"cpp\">void thread_func (int id) {\n    result[id] = 0;\n    int chunk_size = total_size \/ nthread + 1;\n    int start = id * chunk_size;\n    int end = min(start + chunk_size, total_size);\n\n    int c = 0; \/\/\u4f7f\u7528\u4e34\u65f6\u53d8\u91cf\uff0c\u6ca1\u6709cache line\u7684\u540c\u6b65\u4e86\n    for ( int i = start; i &lt; end; ++i ) {\n        if (test_data[i] % 2 != 0 ) ++c;\n    }\n    result[id] = c;\n}<\/pre>\n<p>\u6211\u4eec\u628a\u4e24\u4e2a\u7a0b\u5e8f\u5206\u522b\u5728 1 \u5230 32 \u4e2a\u7ebf\u7a0b\u4e0a\u8dd1\u4e00\u4e0b\uff0c\u5f97\u51fa\u7684\u7ed3\u679c\u753b\u4e00\u5f20\u56fe\u5982\u4e0b\u6240\u793a\uff08\u6a2a\u8f74\u662f\u7ebf\u7a0b\u6570\uff0c\u7eb5\u8f74\u662f\u5b8c\u6210\u7edf\u7684\u65f6\u95f4\uff0c\u5355\u4f4d\u662f\u5fae\u79d2\uff09\uff1a<\/p>\n<p><img decoding=\"async\" loading=\"lazy\" class=\"aligncenter size-large wp-image-20813\" src=\"https:\/\/coolshell.cn\/wp-content\/uploads\/2020\/03\/false.sharing-1024x643.png\" alt=\"\" width=\"640\" height=\"402\" srcset=\"https:\/\/coolshell.cn\/wp-content\/uploads\/2020\/03\/false.sharing-1024x643.png 1024w, https:\/\/coolshell.cn\/wp-content\/uploads\/2020\/03\/false.sharing-300x188.png 300w, https:\/\/coolshell.cn\/wp-content\/uploads\/2020\/03\/false.sharing-768x482.png 768w, https:\/\/coolshell.cn\/wp-content\/uploads\/2020\/03\/false.sharing-430x270.png 430w, https:\/\/coolshell.cn\/wp-content\/uploads\/2020\/03\/false.sharing.png 1320w\" sizes=\"(max-width: 640px) 100vw, 640px\" \/><\/p>\n<p>\u4e0a\u56fe\u4e2d\uff0c\u6211\u4eec\u53ef\u4ee5\u770b\u5230\uff0c\u7070\u8272\u7684\u66f2\u7ebf\u5c31\u662f\u7b2c\u4e00\u79cd\u65b9\u6cd5\uff0c\u6a59\u8272\u7684\u5c31\u662f\u7b2c\u4e8c\u79cd\uff08\u7528\u5c40\u90e8\u53d8\u91cf\u7684\uff09\u65b9\u6cd5\u3002\u5f53\u53ea\u6709\u4e00\u4e2a\u7ebf\u7a0b\u7684\u65f6\u5019\uff0c\u4e24\u4e2a\u65b9\u6cd5\u76f8\u5f53\uff0c\u57fa\u672c\u6ca1\u6709\u4ec0\u4e48\u5dee\u522b\uff0c\u4f46\u662f\u5728\u7ebf\u7a0b\u6570\u589e\u52a0\u7684\u65f6\u5019\u7684\u65f6\u5019\uff0c\u4f60\u4f1a\u53d1\u73b0\uff0c\u7b2c\u4e8c\u79cd\u65b9\u6cd5\u7684\u6027\u80fd\u63d0\u9ad8\u7684\u975e\u5e38\u5feb\u3002\u76f4\u5230\u5230\u8fbe6\u4e2a\u7ebf\u7a0b\u7684\u65f6\u5019\uff0c\u5f00\u59cb\u53d8\u5f97\u7a33\u5b9a\uff08\u524d\u9762\u8bf4\u8fc7\uff0c\u6211\u7684CPU\u662f6\u6838\u7684\uff09\u3002\u800c\u7b2c\u4e00\u79cd\u65b9\u6cd5\u65e0\u8bba\u52a0\u591a\u5c11\u7ebf\u7a0b\u4e5f\u6ca1\u6709\u529e\u6cd5\u8d85\u8fc7\u7b2c\u4e8c\u79cd\u65b9\u6cd5\u3002\u56e0\u4e3a\u7b2c\u4e00\u79cd\u65b9\u6cd5\u4e0d\u662fCPU Cache \u53cb\u597d\u7684\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u7b2c\u4e8c\u79cd\u65b9\u6cd5\uff0c<strong>\u53ea\u8981\u6211\u7684CPU\u6838\u6570\u8db3\u591f\u591a\uff0c\u5c31\u53ef\u4ee5\u505a\u5230\u7ebf\u6027\u7684\u6027\u80fd\u6269\u5c55\uff0c\u8ba9\u6bcf\u4e00\u4e2aCPU\u6838\u90fd\u8dd1\u8d77\u6765\uff0c\u800c\u7b2c\u4e00\u79cd\u5219\u4e0d\u80fd<\/strong>\u3002<\/p>\n<p>\u7bc7\u5e45\u95ee\u9898\uff0c\u793a\u4f8b\u5c31\u5199\u5230\u8fd9\u91cc\uff0c\u76f8\u5173\u7684\u4ee3\u7801\u53c2\u770b<a href=\"https:\/\/github.com\/haoel\/cpu-cache\" target=\"_blank\" rel=\"noopener noreferrer\">\u6211\u7684Github\u76f8\u5173\u4ed3\u5e93<\/a>\u3002<\/p>\n<h4><span class=\"ez-toc-section\" id=\"%E5%BB%B6%E4%BC%B8%E9%98%85%E8%AF%BB\"><\/span>\u5ef6\u4f38\u9605\u8bfb<span class=\"ez-toc-section-end\"><\/span><\/h4>\n<ul>\n<li>Wikipedia : <a href=\"https:\/\/en.wikipedia.org\/wiki\/CPU_cache\" target=\"_blank\" rel=\"noopener noreferrer\">CPU Cache\u00a0<\/a><\/li>\n<li>\u7ecf\u5178\u6587\u7ae0\uff1a<a href=\"http:\/\/igoro.com\/archive\/gallery-of-processor-cache-effects\/\" target=\"_blank\" rel=\"noopener noreferrer\">Gallery of Processor Cache Effects<\/a> \uff08\u8fd9\u7bc7\u6587\u7ae0\u4e2d\u7684\u6d4b\u8bd5\u5df2\u7ecf\u6709\u70b9\u8fc7\u65f6\u4e86\uff0c\u4f46\u662f\u8fd9\u7bc7\u6587\u7ae0\u4e2d\u6240\u8bf4\u7684\u90a3\u4e9b\u4e1c\u897f\u8fd8\u662f\u975e\u5e38\u9002\u7528\u7684\uff09<\/li>\n<li>Effective C++\u4f5c\u8005 Scott Meyers \u7684\u6f14\u8bb2 CPU Caches and Why You Care \uff08<a href=\"https:\/\/www.youtube.com\/watch?v=WDIkqP4JbkE\" target=\"_blank\" rel=\"noopener noreferrer\">Youtube<\/a>\uff0c<a href=\"https:\/\/www.aristeia.com\/TalkNotes\/codedive-CPUCachesHandouts.pdf\" target=\"_blank\" rel=\"noopener noreferrer\">PPT<\/a>\uff09<\/li>\n<li>\u7f8e\u56fd\u79c1\u7acb\u5927\u5b66Swarthmore\u7684\u6559\u6750 <a href=\"https:\/\/www.cs.swarthmore.edu\/~kwebb\/cs31\/f18\/memhierarchy\/caching.html\" target=\"_blank\" rel=\"noopener noreferrer\">Cache Architecture and Design<\/a><\/li>\n<li>\u7ecf\u5178\u6587\u7ae0\uff1a<a href=\"https:\/\/people.freebsd.org\/~lstewart\/articles\/cpumemory.pdf\" target=\"_blank\" rel=\"noopener noreferrer\">What Every Programmer Should Know About Memory<\/a> \uff08\u8fd9\u7bc7\u6587\u7ae0\u975e\u5e38\u7ecf\u5178\uff0c\u4f46\u662f\u5f00\u7bc7\u592a\u6666\u6da9\u4e86\uff0c\u5c45\u7136\u544a\u8bc9\u4f60\u6676\u4f53\u7ba1\u5185\u7684\u6784\u9020\uff0c\u7b2c\u4e09\u7ae0\u548c\u7b2c\u516d\u7ae0\u662f\u91cd\u70b9\uff09<\/li>\n<li>Nonblocking Algorithms and Scalable Multicore Programming \uff08<a href=\"https:\/\/queue.acm.org\/detail.cfm?id=2492433\" target=\"_blank\" rel=\"noopener noreferrer\">\u82f1\u6587\u7248<\/a>\uff0c<a href=\"https:\/\/www.oschina.net\/translate\/nonblocking-algorithms-and-scalable-multicore-programming\" target=\"_blank\" rel=\"noopener noreferrer\">\u4e2d\u6587\u7248<\/a>\uff09<\/li>\n<li>Github\u4e0a\u7684\u4e00\u4e2a\u4ee3\u7801\u5e93 <a href=\"https:\/\/github.com\/Kobzol\/hardware-effects\" target=\"_blank\" rel=\"noopener noreferrer\">hardware-effects<\/a> \u91cc\u9762\u6709\u53d7CPU\u5f71\u54cd\u7684\u7a0b\u5e8f\u7684\u6f14\u793a<\/li>\n<li>Optimizing for instruction caches \uff08<a href=\"https:\/\/www.eetimes.com\/optimizing-for-instruction-caches-part-1\/\" target=\"_blank\" rel=\"noopener noreferrer\">Part 1<\/a>\uff0c<a href=\"https:\/\/www.eetimes.com\/optimizing-for-instruction-caches-part-2\/\" target=\"_blank\" rel=\"noopener noreferrer\">Part 2<\/a>\uff0c <a href=\"https:\/\/www.eetimes.com\/optimizing-for-instruction-caches-part-3\/\">Part 3<\/a>\uff09<\/li>\n<li>\u7ecf\u5178\u6570\u636e\uff1a<a href=\"https:\/\/gist.github.com\/jboner\/2841832\" target=\"_blank\" rel=\"noopener noreferrer\">Latency Numbers Every Programmer Should Know<\/a><\/li>\n<li>\u5173\u4e8eJava\u7684\u53ef\u4ee5\u770b\u4e00\u4e0b\u8fd9\u7bc7<a href=\"https:\/\/dzone.com\/articles\/optimizing-memory-access-with-cpu-cache\" target=\"_blank\" rel=\"noopener noreferrer\">Optimizing Memory Access With CPU Cache<\/a> \u6216\u662f <a href=\"https:\/\/www.stardog.com\/blog\/writing-cache-friendly-code\/\" target=\"_blank\" rel=\"noopener noreferrer\">Writing cache-friendly code<\/a><\/li>\n<\/ul>\n<p>\u603b\u4e4b\uff0c\u8fd9\u4e2aCPU Cache\u7684\u8c03\u4f18\u6280\u672f\u4e0d\u662f\u4ec0\u4e48\u65b0\u9c9c\u7684\u4e1c\u897f\uff0c\u53ea\u8981Google\u5c31\u80fd\u627e\u5230\u6709\u5f88\u591a\u5f88\u591a\u6587\u7ae0\u2026\u2026<\/p>\n<p>\uff08\u5168\u6587\u5b8c\uff09<\/p>\n","raw":"","protected":false},"excerpt":{"rendered":"<p>\u597d\u4e45\u6ca1\u6709\u5199\u4e00\u4e9b\u5fae\u89c2\u65b9\u9762\u7684\u6587\u7ae0\u4e86\uff0c\u4eca\u5929\u5199\u4e00\u7bc7\u5173\u4e8eCPU Cache\u76f8\u5173\u7684\u6587\u7ae0\uff0c\u8fd9\u7bc7\u6587\u7ae0\u6bd4\u8f83\u957f\uff0c\u4e3b\u8981\u5206\u6210\u8fd9\u4e48\u51e0\u4e2a\u90e8\u5206\uff1a\u57fa\u7840\u77e5\u8bc6\u3001\u7f13\u5b58\u7684\u547d\u4e2d\u3001\u7f13\u5b58\u7684\u4e00\u81f4\u6027\u3001\u76f8\u5173\u7684\u4ee3\u7801&#8230;<\/p>\n<p class=\"read-more\"><a class=\"btn btn-default\" href=\"https:\/\/coolshell.cn\/articles\/20793.html\"> Read More<span class=\"screen-reader-text\">  Read More<\/span><\/a><\/p>\n","protected":false},"author":2,"featured_media":0,"comment_status":"open","ping_status":"open","sticky":false,"template":"","format":"standard","meta":[],"categories":[23,3],"tags":[676,281,664],"series":[],"aioseo_notices":[],"views":144894,"post_thumbnail_image":"https:\/\/coolshell.cn\/wp-content\/uploads\/2020\/03\/cpu_512x512.png","content_first_image":"https:\/\/coolshell.cn\/wp-content\/uploads\/2020\/03\/cpu_512x512.png","post_medium_image_300":"https:\/\/coolshell.cn\/wp-content\/uploads\/2020\/03\/cpu_512x512.png","post_thumbnail_image_624":"https:\/\/coolshell.cn\/wp-content\/uploads\/2020\/03\/cpu_512x512.png","post_frist_image":"https:\/\/coolshell.cn\/wp-content\/uploads\/2020\/03\/cpu_512x512.png","post_medium_image":"https:\/\/coolshell.cn\/wp-content\/uploads\/2020\/03\/cpu_512x512.png","post_large_image":"https:\/\/coolshell.cn\/wp-content\/uploads\/2020\/03\/cpu_512x512.png","post_full_image":"https:\/\/coolshell.cn\/wp-content\/uploads\/2020\/03\/cpu_512x512.png","post_all_images":[{"imagesurl":"https:\/\/coolshell.cn\/wp-content\/uploads\/2020\/03\/cpu_512x512-300x300.png","id":"image0"},{"imagesurl":"https:\/\/coolshell.cn\/wp-content\/uploads\/2020\/02\/cache.architecture.png","id":"image1"},{"imagesurl":"https:\/\/coolshell.cn\/wp-content\/uploads\/2020\/02\/cache-associative-fill-both.png","id":"image2"},{"imagesurl":"https:\/\/coolshell.cn\/wp-content\/uploads\/2020\/03\/L1CacheExample.png","id":"image3"},{"imagesurl":"https:\/\/coolshell.cn\/wp-content\/uploads\/2020\/03\/selectingCacheLine.png","id":"image4"},{"imagesurl":"https:\/\/coolshell.cn\/wp-content\/uploads\/2020\/02\/The-cache-coherence-problem-Initially-processors-0-and-1-both-read-location-x.png","id":"image5"},{"imagesurl":"https:\/\/coolshell.cn\/wp-content\/uploads\/2020\/02\/MESI.png","id":"image6"},{"imagesurl":"https:\/\/coolshell.cn\/wp-content\/uploads\/2020\/03\/false.sharing-1024x643.png","id":"image7"}],"videoAdId":"","listAd":"0","listAdId":"","listAdEvery":5,"total_comments":107,"category_name":"\u7a0b\u5e8f\u8bbe\u8ba1","post_date":"2020-03-01","like_count":"0","praiseWord":"\u9f13\u52b1","excitationAd":"0","rewardedVideoAdId":"","detailAdId":"","detailAd":"0","enterpriseMinapp":"0","audios":[],"postImageUrl":"http:\/\/coolshell.cn\/wp-content\/uploads\/2016\/09\/coolshell-360x200.jpg","avatarurls":[],"related_posts":[],"pageviews":144895,"pageviews_wl":53707,"ratings_average":4,"ratings_total":666,"ratings_users":147,"next_post_id":20845,"next_post_title":"Rust\u8bed\u8a00\u7684\u7f16\u7a0b\u8303\u5f0f","previous_post_id":19840,"previous_post_title":"HTTP\u7684\u524d\u4e16\u4eca\u751f"}