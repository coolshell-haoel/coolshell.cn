{"id":244,"date":"2009-03-25T17:59:52","date_gmt":"2009-03-25T09:59:52","guid":{"rendered":"http:\/\/coolshell.cn\/?p=244"},"modified":"2009-03-25T17:59:52","modified_gmt":"2009-03-25T09:59:52","slug":"%e5%85%a8%e7%90%83ip%e5%9c%b0%e5%9d%80%e6%95%b0%e6%8d%ae%e5%ba%93","status":"publish","type":"post","link":"https:\/\/coolshell.cn\/articles\/244.html","title":{"rendered":"\u5168\u7403IP\u5730\u5740\u6570\u636e\u5e93"},"content":{"rendered":"<p>\u4e0b\u9762\u662f\u4e00\u4e2a\u514d\u8d39\u7684\u5168\u7403IP\u5730\u5740\u6570\u636e\u5e93\uff0c\u5305\u62ec\u4e86\u56fd\u5bb6\uff0c\u57ce\u5e02\uff0c\u5730\u533a\uff0c\u548c\u7ecf\u7eac\u5ea6\uff0c\u4ee5\u4fbf\u4f60\u53ef\u4ee5\u5229\u7528Google Map\u5728\u5730\u56fe\u4e0a\u6807\u6ce8\u3002\u8fd9\u4e2a\u6570\u636e\u5e93\u7684\u7cbe\u786e\u5ea6\u53ef\u80fd\u670960%\u5de6\u53f3\u3002<\/p>\n<p><a href=\"http:\/\/www.blogama.org\/ipinfodb.sql.bz2\"><strong>SQL format<\/strong><\/a><br \/>\n<cite>\u66f4\u65b0\u81f3\u00a02009\u5e743\u670811\u65e5<\/cite><\/p>\n<p><a href=\"http:\/\/www.blogama.org\/ipinfodb_csv.zip\"><strong>CSV format<\/strong><\/a> (\u591a\u6587\u4ef6)<br \/>\n<cite>\u66f4\u65b0\u81f3\u00a02009\u5e743\u670811\u65e5<\/cite><\/p>\n<p>\u4e0b\u9762\u662f\u600e\u4e48\u4f7f\u7528\u8fd9\u4e2a\u6570\u636e\u5e93\u3002<\/p>\n<p><!--more--><\/p>\n<p>\u9996\u5148\uff0c\u6240\u6709\u7684IP\u5730\u5740\u90fd\u662f\u6309\u4e00\u4e2a\u6574\u5f62\u6765\u5b58\u653e\u7684\uff0c\u5047\u8bbe\u4e00\u4e2aIP\u5730\u5740\u4e3aA.B.C.D\uff0c\u90a3\u4e48\u5176\u8ba1\u7b97\u516c\u5f0f\u5982\u4e0b\u6240\u793a\uff1a<\/p>\n<p style=\"padding-left: 30px;\">ip = (A*256+B)*256+C<\/p>\n<p>\u4e5f\u5c31\u662f\u8bf4\uff0c\u5b83\u53ea\u8ba1\u7b97\u5230\u7f51\u6bb5\u4e3a\uff1aA.B.C.0\u5230A.B.C.255\u3002\u4f8b\u5982\uff1a\u6211\u4eec\u6709\u4e00\u4e2aIP\u5730\u5740\u4e3a\uff1a74.125.45.100 (google.com)\uff0c\u90a3\u4e48\uff0c<\/p>\n<p style=\"padding-left: 30px;\">ip = (74*256+125)*256+45 = 4881709<\/p>\n<p>\u8fd9\u6837\uff0c\u6211\u4eec\u53ef\u4ee5\u65b9\u4fbf\u5730\u4f7f\u7528\u5982\u4e0b\u7684SQL\u8bed\u53e5\u641c\u7d22\u6570\u636e\uff1a<\/p>\n<p style=\"padding-left: 30px;\">SELECT * FROM <code data-enlighter-language=\"raw\" class=\"EnlighterJSRAW\">ip_group_city<\/code><br \/>\nWHERE<code data-enlighter-language=\"raw\" class=\"EnlighterJSRAW\">ip_start<\/code> &lt;= 4881709 ORDER BY ip_start DESC LIMIT 1;<\/p>\n<p>\u7ed3\u679c\u4f1a\u662f\u5982\u4e0b\u6240\u793a\uff1a<\/p>\n<p style=\"padding-left: 30px;\">ip_start|country_code|region_code|city|zipcode|latitude|longitude<br \/>\n4881664|US|CA|Mountain View|94043|37.4192|-122.057<\/p>\n<p>\u5982\u679c\u4f60\u60f3\u5728\u7ebf\u4f7f\u7528\u8fd9\u4e9b\u6570\u636e\u7684\u8bdd\uff0c\u4f60\u53ef\u4ee5\u4f7f\u7528\u5982\u4e0b\u6240\u793a\u7684\u7f51\u5740\uff1a<\/p>\n<p>http:\/\/blogama.org\/ip_query.php?ip=74.125.45.100&#038;output=xml<\/p>\n<p>\u4e8e\u662f\uff0c\u4f60\u5c31\u4f1a\u5f97\u5230\u5982\u4e0b\u7684XML\u6570\u636e\uff1a<\/p>\n<p style=\"padding-left: 30px;\"><span style=\"color: #009900;\"><span style=\"font-weight: bold; color: #000000;\">&lt;?xml<\/span> <span style=\"color: #000066;\">version<\/span>=<span style=\"color: #ff0000;\">&#8220;1.0&#8221;<\/span> <span style=\"color: #000066;\">encoding<\/span>=<span style=\"color: #ff0000;\">&#8220;UTF-8&#8221;<\/span><span style=\"font-weight: bold; color: #000000;\">?&gt;<\/span><\/span><br \/>\n<span style=\"color: #009900;\"><span style=\"font-weight: bold; color: #000000;\">&lt;Response<span style=\"font-weight: bold; color: #000000;\">&gt;<\/span><\/span><\/span><br \/>\n<span style=\"color: #009900;\"><span style=\"font-weight: bold; color: #000000;\">&lt;Ip<span style=\"font-weight: bold; color: #000000;\">&gt;<\/span><\/span><\/span>74.125.45.100<span style=\"color: #009900;\"><span style=\"font-weight: bold; color: #000000;\">&lt;\/Ip<span style=\"font-weight: bold; color: #000000;\">&gt;<\/span><\/span><\/span><br \/>\n<span style=\"color: #009900;\"><span style=\"font-weight: bold; color: #000000;\">&lt;Status<span style=\"font-weight: bold; color: #000000;\">&gt;<\/span><\/span><\/span>OK<span style=\"color: #009900;\"><span style=\"font-weight: bold; color: #000000;\">&lt;\/Status<span style=\"font-weight: bold; color: #000000;\">&gt;<\/span><\/span><\/span><br \/>\n<span style=\"color: #009900;\"><span style=\"font-weight: bold; color: #000000;\">&lt;CountryCode<span style=\"font-weight: bold; color: #000000;\">&gt;<\/span><\/span><\/span>US<span style=\"color: #009900;\"><span style=\"font-weight: bold; color: #000000;\">&lt;\/CountryCode<span style=\"font-weight: bold; color: #000000;\">&gt;<\/span><\/span><\/span><br \/>\n<span style=\"color: #009900;\"><span style=\"font-weight: bold; color: #000000;\">&lt;CountryName<span style=\"font-weight: bold; color: #000000;\">&gt;<\/span><\/span><\/span>United States<span style=\"color: #009900;\"><span style=\"font-weight: bold; color: #000000;\">&lt;\/CountryName<span style=\"font-weight: bold; color: #000000;\">&gt;<\/span><\/span><\/span><br \/>\n<span style=\"color: #009900;\"><span style=\"font-weight: bold; color: #000000;\">&lt;RegionCode<span style=\"font-weight: bold; color: #000000;\">&gt;<\/span><\/span><\/span>CA<span style=\"color: #009900;\"><span style=\"font-weight: bold; color: #000000;\">&lt;\/RegionCode<span style=\"font-weight: bold; color: #000000;\">&gt;<\/span><\/span><\/span><br \/>\n\u00a0<br \/>\n<span style=\"color: #009900;\"><span style=\"font-weight: bold; color: #000000;\">&lt;RegionName<span style=\"font-weight: bold; color: #000000;\">&gt;<\/span><\/span><span style=\"font-weight: bold; color: #000000;\">&lt;\/RegionName<span style=\"font-weight: bold; color: #000000;\">&gt;<\/span><\/span><\/span><br \/>\n<span style=\"color: #009900;\"><span style=\"font-weight: bold; color: #000000;\">&lt;City<span style=\"font-weight: bold; color: #000000;\">&gt;<\/span><\/span><\/span>Mountain View<span style=\"color: #009900;\"><span style=\"font-weight: bold; color: #000000;\">&lt;\/City<span style=\"font-weight: bold; color: #000000;\">&gt;<\/span><\/span><\/span><br \/>\n<span style=\"color: #009900;\"><span style=\"font-weight: bold; color: #000000;\">&lt;ZipPostalCode<span style=\"font-weight: bold; color: #000000;\">&gt;<\/span><\/span><\/span>94043<span style=\"color: #009900;\"><span style=\"font-weight: bold; color: #000000;\">&lt;\/ZipPostalCode<span style=\"font-weight: bold; color: #000000;\">&gt;<\/span><\/span><\/span><br \/>\n<span style=\"color: #009900;\"><span style=\"font-weight: bold; color: #000000;\">&lt;Latitude<span style=\"font-weight: bold; color: #000000;\">&gt;<\/span><\/span><\/span>37.4192<span style=\"color: #009900;\"><span style=\"font-weight: bold; color: #000000;\">&lt;\/Latitude<span style=\"font-weight: bold; color: #000000;\">&gt;<\/span><\/span><\/span><br \/>\n<span style=\"color: #009900;\"><span style=\"font-weight: bold; color: #000000;\">&lt;Longitude<span style=\"font-weight: bold; color: #000000;\">&gt;<\/span><\/span><\/span>-122.057<span style=\"color: #009900;\"><span style=\"font-weight: bold; color: #000000;\">&lt;\/Longitude<span style=\"font-weight: bold; color: #000000;\">&gt;<\/span><\/span><\/span><br \/>\n<span style=\"color: #009900;\"><span style=\"font-weight: bold; color: #000000;\">&lt;\/Response<span style=\"font-weight: bold; color: #000000;\">&gt;<\/span><\/span><\/span><\/p>\n<p>\u5982\u679c\u4f60\u8bf7\u6c42\u7684\u662f\uff1a<\/p>\n<p><a href=\"http:\/\/blogama.org\/ip_query.php?ip=74.125.45.100&amp;output=raw\">http:\/\/blogama.org\/ip_query.php?ip=74.125.45.100&amp;output=raw<\/a><\/p>\n<p>\u8fd9\u6837\u4f60\u4f1a\u5f97\u5230CSV\u7684\u683c\u5f0f\uff1a<\/p>\n<p>74.125.45.100,OK,US,United States,CA,,Mountain View,94043,37.4192,-122.057<\/p>\n<p>\u6587\u7ae0\uff1a<a href=\"http:\/\/blogama.org\/node\/58\" target=\"_blank\">\u6765\u6e90<\/a><\/p>\n","raw":"","protected":false},"excerpt":{"rendered":"<p>\u4e0b\u9762\u662f\u4e00\u4e2a\u514d\u8d39\u7684\u5168\u7403IP\u5730\u5740\u6570\u636e\u5e93\uff0c\u5305\u62ec\u4e86\u56fd\u5bb6\uff0c\u57ce\u5e02\uff0c\u5730\u533a\uff0c\u548c\u7ecf\u7eac\u5ea6\uff0c\u4ee5\u4fbf\u4f60\u53ef\u4ee5\u5229\u7528Google Map\u5728\u5730\u56fe\u4e0a\u6807\u6ce8\u3002\u8fd9\u4e2a\u6570\u636e\u5e93\u7684\u7cbe\u786e\u5ea6\u53ef\u80fd\u670960%\u5de6\u53f3\u3002 SQ&#8230;<\/p>\n<p class=\"read-more\"><a class=\"btn btn-default\" href=\"https:\/\/coolshell.cn\/articles\/244.html\"> Read More<span class=\"screen-reader-text\">  Read More<\/span><\/a><\/p>\n","protected":false},"author":2,"featured_media":0,"comment_status":"open","ping_status":"open","sticky":false,"template":"","format":"standard","meta":[],"categories":[10],"tags":[62],"series":[],"aioseo_notices":[],"views":27695,"post_thumbnail_image":"","content_first_image":"","post_medium_image_300":"","post_thumbnail_image_624":"","post_frist_image":"","post_medium_image":"","post_large_image":"","post_full_image":"","post_all_images":[],"videoAdId":"","listAd":"0","listAdId":"","listAdEvery":5,"total_comments":12,"category_name":"\u6742\u9879\u8d44\u6e90","post_date":"2009-03-25","like_count":"0","praiseWord":"\u9f13\u52b1","excitationAd":"0","rewardedVideoAdId":"","detailAdId":"","detailAd":"0","enterpriseMinapp":"0","audios":[],"postImageUrl":"http:\/\/coolshell.cn\/wp-content\/uploads\/2016\/09\/coolshell-360x200.jpg","avatarurls":[],"related_posts":[],"pageviews":27696,"pageviews_wl":8026,"ratings_average":3,"ratings_total":33,"ratings_users":9,"next_post_id":309,"next_post_title":"\u5341\u4e2a\u6700\u597d\u7684PDF\u751f\u6210\u5e93","previous_post_id":240,"previous_post_title":"\u975e\u5e38\u4e0d\u9519\u7684\u7f16\u7a0b\u6280\u672f\u6559\u7a0b"}