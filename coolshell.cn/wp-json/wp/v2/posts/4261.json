{"id":4261,"date":"2011-04-06T23:05:39","date_gmt":"2011-04-06T15:05:39","guid":{"rendered":"http:\/\/coolshell.cn\/?p=4261"},"modified":"2011-04-10T21:57:38","modified_gmt":"2011-04-10T13:57:38","slug":"javamail%e4%bd%bf%e7%94%a8","status":"publish","type":"post","link":"https:\/\/coolshell.cn\/articles\/4261.html","title":{"rendered":"JavaMail\u4f7f\u7528"},"content":{"rendered":"<p>\uff08<strong>\u672c\u6587\u7531\u7f51\u53cbjjzhx_1211\u6295\u9012\uff0c\u611f\u8c22!<\/strong>\uff09<\/p>\n<p>\u4f7f\u7528JavaMail\u9700\u8981\u4e24\u4e2a\u5305\uff1aactivation-1.1.jar\u548cmail-1.4.2.jar\uff08\u5f53\u7136\u73b0\u5728\u6700\u65b0\u7684\u7248\u672c\u5df2\u7ecf\u4e0d\u6b62\u4e86\uff09\uff0c\u4e5f\u53ef\u4ee5\u76f4\u63a5\u5305\u542bJava SE 6\u7684j2ee.jar\uff0c\u81ea\u5e26\u4e86\u524d\u9762\u7684\u4e24\u4e2a\u5305\u3002\u6211\u628a\u90ae\u4ef6\u529f\u80fd\u5199\u6210\u4e86\u4e00\u4e2a\u670d\u52a1\uff0c\u53d1\u9001\u90ae\u4ef6\u7684\u6570\u636e\u90fd\u901a\u8fc7Map&lt;String, String&gt;\u7c7b\u578b\u7684\u53c2\u6570\u5c01\u88c5\u4e86\u8d77\u6765\u3002<strong>\u4ee3\u7801\u89c1\u6587\u7ae0\u6700\u540e<\/strong>\u3002<\/p>\n<div id=\"ez-toc-container\" class=\"ez-toc-v2_0_48 counter-hierarchy ez-toc-counter ez-toc-grey ez-toc-container-direction\">\n<div class=\"ez-toc-title-container\">\n<p class=\"ez-toc-title\">\u76ee\u5f55<\/p>\n<span class=\"ez-toc-title-toggle\"><\/span><\/div>\n<nav><ul class='ez-toc-list ez-toc-list-level-1 ' ><li class='ez-toc-page-1 ez-toc-heading-level-4'><a class=\"ez-toc-link ez-toc-heading-1\" href=\"https:\/\/coolshell.cn\/articles\/4261.html\/#Session\" title=\"Session\">Session<\/a><\/li><li class='ez-toc-page-1 ez-toc-heading-level-4'><a class=\"ez-toc-link ez-toc-heading-2\" href=\"https:\/\/coolshell.cn\/articles\/4261.html\/#Message\" title=\"Message\">Message<\/a><\/li><li class='ez-toc-page-1 ez-toc-heading-level-4'><a class=\"ez-toc-link ez-toc-heading-3\" href=\"https:\/\/coolshell.cn\/articles\/4261.html\/#Address\" title=\"Address\">Address<\/a><\/li><li class='ez-toc-page-1 ez-toc-heading-level-4'><a class=\"ez-toc-link ez-toc-heading-4\" href=\"https:\/\/coolshell.cn\/articles\/4261.html\/#Authenticator\" title=\"Authenticator\">Authenticator<\/a><\/li><li class='ez-toc-page-1 ez-toc-heading-level-4'><a class=\"ez-toc-link ez-toc-heading-5\" href=\"https:\/\/coolshell.cn\/articles\/4261.html\/#Transport\" title=\"Transport\">Transport<\/a><\/li><li class='ez-toc-page-1 ez-toc-heading-level-4'><a class=\"ez-toc-link ez-toc-heading-6\" href=\"https:\/\/coolshell.cn\/articles\/4261.html\/#Store_and_Folder\" title=\"Store and Folder\">Store and Folder<\/a><\/li><li class='ez-toc-page-1 ez-toc-heading-level-4'><a class=\"ez-toc-link ez-toc-heading-7\" href=\"https:\/\/coolshell.cn\/articles\/4261.html\/#%E4%BB%A3%E7%A0%81\" title=\"\u4ee3\u7801\">\u4ee3\u7801<\/a><\/li><\/ul><\/nav><\/div>\n<h4><span class=\"ez-toc-section\" id=\"Session\"><\/span>Session<span class=\"ez-toc-section-end\"><\/span><\/h4>\n<p>Session \u5b9a\u4e49\u4e86\u4e00\u4e2a\u57fa\u672c\u7684\u90ae\u4ef6\u4f1a\u8bdd\uff0c\u4efb\u4f55\u5de5\u4f5c\u90fd\u662f\u57fa\u4e8e\u8fd9\u4e2aSession\u7684\u3002Session \u5bf9\u8c61\u9700\u8981\u4e00\u4e2a java.util.Properties \u5bf9\u8c61\u6765\u5f97\u5230\u7c7b\u4f3c \u90ae\u4ef6\u670d\u52a1\u5668\uff0c\u7528\u6237\u540d\uff0c\u5bc6\u7801\u8fd9\u6837\u7684\u4fe1\u606f\u3002Session \u7684\u6784\u9020\u51fd\u6570\u662f\u79c1\u6709\u7684\uff0c\u53ef\u4ee5\u901a\u8fc7 getDefaultInstance() \u65b9\u6cd5\u6765\u53d6\u5f97\u4e00\u4e2a\u5355\u4e00\u7684\u53ef\u4ee5\u88ab\u5171\u4eab\u7684\u9ed8\u8ba4session \u5982\uff1a<\/p>\n<pre data-enlighter-language=\"java\" class=\"EnlighterJSRAW\">Properties props = new Properties();\r\nSession session = Session.getDefaultInstance(props,null);<\/pre>\n<p>\u6216\u8005\uff0c\u53ef\u4ee5\u4f7f\u7528 getInstance() \u65b9\u6cd5\u6765\u521b\u5efa\u4e00\u4e2a\u552f\u4e00\u7684 session\u5982\uff1a<\/p>\n<pre data-enlighter-language=\"java\" class=\"EnlighterJSRAW\">Properties props = new Properties();\r\nSession session = Session.getInstance(props,null);<\/pre>\n<p>\u5728\u8fd9\u4e24\u79cd\u65b9\u6cd5\u4e2d \u5176\u4e2d\u7684 null \u53c2\u6570\u662f\u4e00\u4e2a Authenticator \u5bf9\u8c61\uff0c\u5728\u8fd9\u91cc\u6ca1\u6709\u88ab\u4f7f\u7528\u7684\uff0c\u6240\u4ee5\u5c31\u662fnull\u3002\u5728\u5927\u591a\u6570\u6848\u4f8b\u4e2d\uff0c\u4f7f\u7528\u4e00\u4e2a\u5171\u4eabsession \u5df2\u7ecf\u505a\u591f\u4e86\u3002<\/p>\n<p><!--more--><\/p>\n<h4><span class=\"ez-toc-section\" id=\"Message\"><\/span>Message<span class=\"ez-toc-section-end\"><\/span><\/h4>\n<p>\u4e00\u65e6\u4f60\u521b\u5efa\u4e86Session\u5bf9\u8c61\uff0c\u90a3\u4e48\u4e0b\u9762\u8981\u505a\u7684\u5c31\u662f\u521b\u5efamessage\u6765\u53d1\u9001\u3002Message\u662f\u4e00\u4e2a\u62bd\u8c61\u7c7b\uff0c\u5728\u5927\u90e8\u5206\u5e94\u7528\u4e2d\u4f60\u53ef\u4ee5\u4f7f\u7528\u5b83\u7684\u5b50\u7c7bjavax.mail.internet.MimeMessage \u3002MimeMessage \u662f\u4e00\u4e2a\u7406\u89e3\u5728\u4e0d\u540cRFCs\u4e2d\u5b9a\u4e49\u7684MIME\u7c7b\u578b\u4ee5\u53caheaders\u7684e-mail message\u3002Message headers \u5fc5\u987b\u4f7f\u7528 US-ASCII \u5b57\u7b26\u96c6\u3002\u53ef\u4ee5\u7528\u5982\u4e0b\u7684\u65b9\u6cd5\u521b\u5efa\u4e00\u4e2aMessage<\/p>\n<p><code data-enlighter-language=\"java\" class=\"EnlighterJSRAW\">MimeMessage message = new MimeMessage(session);<\/code><\/p>\n<p>\u6211\u4eec\u6ce8\u610f\u5230\uff0c\u8fd9\u91cc\u9700\u8981\u7528session\u5bf9\u8c61\u4f5c\u4e3a\u6784\u9020\u51fd\u6570\u7684\u53c2\u6570\u3002\u5f53\u7136\uff0c\u8fd8\u6709\u5176\u5b83\u7684\u6784\u9020\u51fd\u6570\uff0c\u6bd4\u5982\u4ece\u7528RFC822\u683c\u5f0f\u5316\u8fc7\u7684\u8f93\u5165\u6d41\u6765\u521b\u5efamessage\u3002<\/p>\n<p>\u4e00\u65e6\u4f60\u5f97\u5230\u4e86 message ,\u4f60\u5c31\u53ef\u4ee5\u6765\u8bbe\u7f6e\u5b83\u7684\u5404\u4e2a\u90e8\u5206\uff08parts\uff09\u3002\u8bbe\u7f6e\u5185\u5bb9\uff08content\uff09\u7684\u57fa\u672c\u7684\u673a\u5236\u662f\u4f7f\u7528setContent() \u65b9\u6cd5\u3002<\/p>\n<p><code data-enlighter-language=\"java\" class=\"EnlighterJSRAW\">message.setContent(&quot;Email Content. &quot;,&quot;text\/plain&quot;);<\/code><\/p>\n<p>\u5982\u679c\uff0c\u4f60\u80fd\u591f\u660e\u786e\u4f60\u7684\u4f7f\u7528MimeMessage\u6765\u521b\u5efamessage \u5e76\u4e14\u53ea\u662f\u4f7f\u7528\u666e\u901a\u7684\u6587\u672c\uff08plain text\uff09 \u90a3\u4e48\u4f60\u4e5f\u53ef\u4ee5\u4f7f\u7528 setText() \u65b9\u6cd5\uff0csetTest()\u65b9\u6cd5\u53ea\u9700\u8981\u8bbe\u7f6e\u5177\u4f53\u7684\u5185\u5bb9\uff0c\u5b83\u9ed8\u8ba4\u7684MIME\u7c7b\u578b\u662f text\/plain<\/p>\n<p><code data-enlighter-language=\"java\" class=\"EnlighterJSRAW\">message.setText(&quot;Email Content. &quot;);<\/code><\/p>\n<p>\u5bf9\u4e8e\u666e\u901a\u6587\u672c\u7c7b\u578b\u7684\u90ae\u4ef6\uff0c\u6709\u4e00\u79cd\u673a\u5236\u662f\u9996\u9009\uff08 message.setText(&#8220;Email Content. &#8220;)\uff09\u7684\u8bbe\u7f6e\u5185\u5bb9\u7684\u65b9\u6cd5\u3002\u5982\u679c\u8981\u521b\u5efa\u5176\u5b83\u7c7b\u578b\u7684message \uff0c\u6bd4\u5982\u3000HTML\u7c7b\u578b\u7684message\u00a0\u00a0 \u90a3\u4e48\u8fd8\u662f\u9700\u8981\u4f7f\u7528\u524d\u8005\u3000\uff08\u3000message.setContent(&#8220;Email Content. &#8220;,&#8221;text\/html&#8221;);\u3000\uff09<br \/>\n\u8bbe\u7f6e\u4e3b\u9898\uff08subject \uff09\uff0c\u4f7f\u7528setSubject() \u65b9\u6cd5<\/p>\n<p><code data-enlighter-language=\"java\" class=\"EnlighterJSRAW\">message.setSubject(&quot; Subject &quot;);<\/code><\/p>\n<h4><span class=\"ez-toc-section\" id=\"Address\"><\/span>Address<span class=\"ez-toc-section-end\"><\/span><\/h4>\n<p>\u5f53\u4f60\u5df2\u7ecf\u521b\u5efaSession \u4ee5\u53ca Message\uff0c\u5e76\u4e14\u5df2\u7ecf\u4e3amessage \u586b\u5145\u4e86\u5185\u5bb9\uff0c\u90a3\u4e48\u63a5\u4e0b\u6765\u8981\u505a\u7684\u5c31\u662f\u7ed9\u4f60\u7684\u90ae\u4ef6\u6dfb\u52a0\u4e00\u4e2a\u5730\u5740\uff08Address\uff09\u3002\u3000\u5c31\u50cfMessage\u4e00\u6837\uff0cAddress\u4e5f\u662f\u4e00\u4e2a\u62bd\u8c61\u7c7b\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u5b83\u7684\u4e00\u4e2a\u5b50<\/p>\n<p>javax.mail.internet.InternetAddress<\/p>\n<p>\u521b\u5efa\u4e00\u4e2a\u5730\u5740\u975e\u5e38\u7b80\u5355<\/p>\n<p><code data-enlighter-language=\"java\" class=\"EnlighterJSRAW\">Address address = new InternetAddress(&quot;&lt;a href=&quot;mailto:suixin@asiainfo.com&quot;&gt;suixin@asiainfo.com&lt;\/a&gt;&quot;);<\/code><\/p>\n<p>\u5982\u679c\uff0c\u4f60\u5e0c\u671b\u5728\u51fa\u73b0\u90ae\u4ef6\u5730\u5740\u7684\u5730\u65b9\u51fa\u73b0\u4e00\u4e2a\u540d\u79f0\uff0c\u90a3\u4e48\u4f60\u53ea\u9700\u8981\u518d\u591a\u4f20\u9012\u4e00\u4e2a\u53c2\u6570\u3002<\/p>\n<p><code data-enlighter-language=\"java\" class=\"EnlighterJSRAW\">Address address = new InternetAddress(&quot;&lt;a href=&quot;mailto:suixin@asiainfo.com&amp;quot;,&amp;quot;Steve&quot;&gt;suixin@asiainfo.com&quot;,&quot;Steve&lt;\/a&gt;&quot;);<\/code><\/p>\n<p>\u4f60\u9700\u8981\u4e3a message \u7684from\u4ee5\u53ca to \u5b57\u6bb5\u521b\u5efaaddress\u5bf9\u8c61\u3002\u4e3a\u4e86\u8bc6\u522b\u53d1\u9001\u8005\uff0c\u4f60\u9700\u8981\u4f7f\u7528setFrom() \u548c setReplyTo() \u65b9\u6cd5\u3002<\/p>\n<p><code data-enlighter-language=\"java\" class=\"EnlighterJSRAW\">messge.setFrom(address);<\/code><\/p>\n<p>\u5982\u679c\u4f60\u7684message \u9700\u8981\u663e\u793a\u591a\u4e2a from \u5730\u5740\uff0c\u53ef\u4ee5\u4f7f\u7528 addFrom() \u65b9\u6cd5<\/p>\n<pre data-enlighter-language=\"java\" class=\"EnlighterJSRAW\">Address address[] = {....};\r\nmessage.addFrom(address);<\/pre>\n<p>\u4e3a\u4e86\u8fa8\u8bc6message \u7684\u6536\u4ef6\u4eba\uff0c\u4f60\u9700\u8981\u4f7f\u7528 setRecipient() \u65b9\u6cd5\u3002\u8fd9\u4e2a\u65b9\u6cd5\u9664\u4e86address\u53c2\u6570\u4e4b\u5916\uff0c\u8fd8\u9700\u8981\u4e00<\/p>\n<p>Message.RecipientType \u3002<br \/>\nmessage.addRecipient(type,address);<br \/>\nMessage.RecipientType\u6709\u51e0\u4e2a\u9884\u5148\u5b9a\u4e49\u597d\u7684\u7c7b\u578b<br \/>\nMessage.RecipientType.TO\u3000\u3000\u6536\u4ef6\u4eba<br \/>\nMessage.RecipientType.CC\u3000\u3000\u6284\u9001<br \/>\nMessage.RecipientType.BCC\u3000 \u6697\u9001<\/p>\n<p>\u5982\u679c\u4f60\u7684\u4e00\u5c01\u90ae\u4ef6\uff0c\u9700\u8981\u53d1\u9001\u7ed9\u4f60\u7684\u8001\u5e08\uff0c\u5e76\u8fd8\u8981\u7ed9\u4f60\u7684\u51e0\u4e2a\u540c\u5b66\uff0c\u90a3\u4e48\u4f60\u53ef\u4ee5\u8fd9\u6837<\/p>\n<pre data-enlighter-language=\"java\" class=\"EnlighterJSRAW\">Address toAddress = new InternetAddress(&quot;&lt;a href=&quot;mailto:teacher@17288.com&quot;&gt;teacher@17288.com&lt;\/a&gt;&quot;);\r\nAddress[] ccAddress = {new InternetAddress(&quot;&lt;a href=&quot;mailto:schoolmate1@17288.com&amp;quot;),new&quot;&gt;schoolmate1@17288.com&quot;),new&lt;\/a&gt; InternetAddress(&quot;&lt;a href=&quot;mailto:schoolmate2@17288.com&quot;&gt;schoolmate2@17288.com&lt;\/a&gt;&quot;)};\r\nmessage.addRecipient(Message.RecipientType.To, toAddress);\r\nmessage.addRecipient(Message.RecipientType.CC, ccAddress);<\/pre>\n<p>JavaMail \u6ca1\u6709\u63d0\u4f9b\u7535\u5b50\u90ae\u4ef6\u5730\u5740\u6709\u6548\u6027\u7684\u68c0\u6d4b\u3002\u8fd9\u4e9b\u8d85\u8d8a\u4e86JavaMail API\u7684\u8303\u56f4\u3002<\/p>\n<h4><span class=\"ez-toc-section\" id=\"Authenticator\"><\/span>Authenticator<span class=\"ez-toc-section-end\"><\/span><\/h4>\n<p>\u901a\u8fc7Authenticator\u8bbe\u7f6e\u7528\u6237\u540d\u3001\u5bc6\u7801\uff0c\u6765\u8bbf\u95ee\u53d7\u4fdd\u62a4\u7684\u8d44\u6e90\uff0c\u8fd9\u91cc\u7684\u8d44\u6e90\u4e00\u822c\u6307\u7684\u662f\u90ae\u4ef6\u670d\u52a1\u5668\u3002<\/p>\n<p>Authenticator\u4e5f\u662f\u4e00\u4e2a\u62bd\u8c61\u7c7b\uff0c\u4f60\u9700\u8981\u81ea\u5df1\u7f16\u5199\u5b50\u7c7b\u5df2\u5907\u5e94\u7528\u3002\u4f60\u9700\u8981\u5b9e\u73b0getPasswordAuthentication()\u65b9\u6cd5\uff0c\u5e76\u8fd4\u56de\u4e00\u4e2aPasswordAuthentication\u5b9e\u4f8b\u3002\u4f60\u5fc5\u987b\u5728 session\u88ab\u521b\u5efa\u65f6\uff0c \u6ce8\u518c\u4f60\u7684 Authenticator\u3002\u8fd9\u6837\uff0c\u5f53\u9700\u8981\u8fdb\u884c\u8ba4\u8bc1\u662f\uff0c\u4f60\u7684Authenticator\u5c31\u53ef\u4ee5\u88ab\u5f97\u5230\u3002<\/p>\n<pre data-enlighter-language=\"java\" class=\"EnlighterJSRAW\">Properties props = new Properties();\r\n\/\/\u8bbe\u7f6e\u5c5e\u6027\r\nAuthenticator auth = new YourAuthenticator();\r\nSession session = Session.getDefaultInstance(props, auth);<\/pre>\n<h4><span class=\"ez-toc-section\" id=\"Transport\"><\/span>Transport<span class=\"ez-toc-section-end\"><\/span><\/h4>\n<p>\u53d1\u9001\u6d88\u606f\u6700\u540e\u7684\u4e00\u6b65\u5c31\u662f\u4f7f\u7528Transport\u7c7b\uff0c\u4f60\u53ef\u4ee5\u901a\u8fc7\u4e24\u79cd\u65b9\u6cd5\u6765\u8fdb\u884c\u53d1\u9001\u3002<br \/>\nTransport \u662f\u4e00\u4e2a\u62bd\u8c61\u7c7b\uff0c\u4f60\u53ef\u4ee5\u8c03\u7528\u5b83\u9759\u6001\u7684send() \u65b9\u6cd5\u6765\u53d1\u9001<\/p>\n<p><code data-enlighter-language=\"java\" class=\"EnlighterJSRAW\">Transport.send(message);<\/code><\/p>\n<p>\u6216\u8005\uff0c\u4f60\u53ef\u4ee5\u4e3a\u4f60\u4f7f\u7528\u7684\u534f\u8bae\u4ecesession\u4e2d\u53d6\u5f97\u4e00\u4e2a\u6307\u5b9a\u7684\u5b9e\u4f8b\uff0c<\/p>\n<pre data-enlighter-language=\"java\" class=\"EnlighterJSRAW\">Transport transport = session.getTransport(&quot;smtp&quot;);\r\ntransport.sendMessage(message, message.getAllRecipients());\r\ntransport.close();<\/pre>\n<h4><span class=\"ez-toc-section\" id=\"Store_and_Folder\"><\/span>Store and Folder<span class=\"ez-toc-section-end\"><\/span><\/h4>\n<p>\u8fd9\u4e24\u4e2a\u7c7b\u91cd\u8981\u7528\u4e8e\u53d6\u5f97\u4fe1\u606f\u3002\u5728\u521b\u5efa\u4e86Session\u4e4b\u540e\uff0c\u9700\u8981\u8fde\u63a5\u5230\u4e00\u4e2a Store \uff0c\u4f60\u9700\u8981\u544a\u8bc9Store\u4f60\u4f7f\u7528\u7684\u662f\u4ec0\u4e48\u534f\u8bae\u3002<\/p>\n<pre data-enlighter-language=\"java\" class=\"EnlighterJSRAW\">\/\/ Store store = session.getStore(&quot;imap&quot;);\r\nStore store = session.getStore(&quot;pop3&quot;);\r\nstore.connect(host, username, password);<\/pre>\n<p>\u5728\u8fde\u63a5\u5230\u4e00\u4e2a Store \u540e\uff0c\u4f60\u53ef\u4ee5\u5f97\u5230\u4e00\u4e2a Folder\uff0c\u5f53\u7136\uff0c\u8fd9\u4e2aFloder\u5fc5\u987b\u662f\u6253\u5f00\u7684\u3002<\/p>\n<pre data-enlighter-language=\"java\" class=\"EnlighterJSRAW\">Folder folder = store.getFolder(&quot;INBOX&quot;);\r\nfolder.open(Folder.READ_ONLY);\r\nMessage message[] = folder.getMessages();<\/pre>\n<p>\u5982\u679c\u4f7f\u7528POP3\u90a3\u4e48\uff0cINDEX\u662f\u552f\u4e00\u53ef\u7528\u7684\u6587\u4ef6\u5939\u3002\u5982\u679c\u4f7f\u7528\u7684\u662fIMAP\uff0c\u4f60\u5c31\u53ef\u4ee5\u4f7f\u7528\u5176\u5b83\u7684\u6587\u4ef6\u5939\u3002<\/p>\n<h4><span class=\"ez-toc-section\" id=\"%E4%BB%A3%E7%A0%81\"><\/span>\u4ee3\u7801<span class=\"ez-toc-section-end\"><\/span><\/h4>\n<pre data-enlighter-language=\"java\" class=\"EnlighterJSRAW\">public boolean sendEmail(Map&lt;String, String&gt; data) {\r\n    \/\/ \u521b\u5efaProperties \u5bf9\u8c61\r\n    Properties props = System.getProperties();\r\n    props.put(&quot;mail.smtp.host&quot;, Constants.HOST); \/\/ \u5168\u5c40\u53d8\u91cf\r\n    props.put(&quot;mail.smtp.auth&quot;, &quot;true&quot;);\r\n\r\n    \/\/ \u521b\u5efa\u90ae\u4ef6\u4f1a\u8bdd\r\n    Session session = Session.getDefaultInstance(props,\r\n    new Authenticator() { \/\/ \u9a8c\u8d26\u8d26\u6237\r\n        @Override\r\n        public PasswordAuthentication getPasswordAuthentication() {\r\n            return new PasswordAuthentication(Constants.USERNAME,\r\n                                              Constants.PASSWORD);\r\n        }\r\n    });\r\n\r\n    try {\r\n        \/\/ \u5b9a\u4e49\u90ae\u4ef6\u4fe1\u606f\r\n        MimeMessage message = new MimeMessage(session);\r\n        message.setFrom(new InternetAddress(Constants.FROM));\r\n        message.addRecipient(\r\n            Message.RecipientType.TO,\r\n            new InternetAddress(\r\n                \/\/ \u8fd9\u91cc\u53ef\u4ee5\u6dfb\u52a0\u591a\u4e2a\u76ee\u7684\u7528\u6237\r\n                data.get(Constants.EMAIL_TO)\r\n            )\r\n        );\r\n        \/\/ \u6dfb\u52a0\u90ae\u4ef6\u53d1\u9001\u65f6\u95f4\uff08\u4e0d\u77e5\u9053\u4f53\u73b0\u5728\u54ea\u513f\uff09\r\n        message.setSentDate(new Date());\r\n        \/\/ \u8981\u7f16\u7801\uff0c\u5426\u5219\u4e2d\u6587\u4f1a\u51fa\u4e71\u7801\uff0c\u8c8c\u4f3c\u8fd9\u4e2a\u65b9\u6cd5\u662f\u5bf9\u6570\u636e\u8fdb\u884c\u4e86\r\n        \/\/(&quot;=?GB2312?B?&quot;+enc.encode(subject.getBytes())+&quot;?=&quot;)\u5f62\u52bf\u7684\u5305\u88c5\r\n        message.setSubject(MimeUtility.encodeText(data.get(Constants.EMAIL_SUBJECT), &quot;gbk&quot;, &quot;B&quot;));\r\n\r\n        MimeMultipart mmp = new MimeMultipart();\r\n        MimeBodyPart mbp_text = new MimeBodyPart();\r\n        \/\/ &quot;text\/plain&quot;\u662f\u6587\u672c\u578b\uff0c\u6ca1\u6709\u6837\u5f0f\uff0c\r\n        \/\/&quot;text\/html&quot;\u662fhtml\u6837\u5f0f\uff0c\u53ef\u4ee5\u89e3\u6790html\u6807\u7b7e\r\n        mbp_text.setContent(data.get(Constants.EMAIL_TEXT),\r\n                            &quot;text\/html;charset=gbk&quot;);\r\n        mmp.addBodyPart(mbp_text); \/\/ \u52a0\u5165\u90ae\u4ef6\u6b63\u6587\r\n\r\n        \/\/ \u5904\u7406\u9644\u4ef6\uff0c\u53ef\u4ee5\u6dfb\u52a0\u591a\u4e2a\u9644\u4ef6\r\n        if (data.get(Constants.EMAIL_ATTACHMENT) != null) {\r\n            String[] files = data.get(Constants.EMAIL_ATTACHMENT).split(&quot;,&quot;);\r\n            if (files.length != 0) {\r\n                for (String file : files) {\r\n                    MimeBodyPart mbp_file = new MimeBodyPart();\r\n                    FileDataSource fds = new FileDataSource(file);\r\n                    mbp_file.setDataHandler(new DataHandler(fds));\r\n                    mbp_file.setFileName(MimeUtility.encodeText(fds.getName(), &quot;gbk&quot;, &quot;B&quot;));\r\n                    mmp.addBodyPart(mbp_file);\r\n                }\r\n            }\r\n        }\r\n        message.setContent(mmp);\r\n        \/\/ message.setText(data.get(Constants.EMAIL_TEXT));\r\n\r\n        \/\/ \u53d1\u9001\u6d88\u606f\r\n        \/\/ session.getTransport(&quot;smtp&quot;).send(message); \/\/\u4e5f\u53ef\u4ee5\u8fd9\u6837\u521b\u5efaTransport\u5bf9\u8c61\r\n        Transport.send(message);\r\n        return true;\r\n    } catch (Exception e) {\r\n        e.printStackTrace();\r\n        return false;\r\n    }\r\n}\r\n<\/pre>\n<p>\uff08\u5168\u6587\u5b8c\uff09<\/p>\n","raw":"","protected":false},"excerpt":{"rendered":"<p>\uff08\u672c\u6587\u7531\u7f51\u53cbjjzhx_1211\u6295\u9012\uff0c\u611f\u8c22!\uff09 \u4f7f\u7528JavaMail\u9700\u8981\u4e24\u4e2a\u5305\uff1aactivation-1.1.jar\u548cmail-1.4.2.jar\uff08\u5f53\u7136\u73b0\u5728\u6700\u65b0&#8230;<\/p>\n<p class=\"read-more\"><a class=\"btn btn-default\" href=\"https:\/\/coolshell.cn\/articles\/4261.html\"> Read More<span class=\"screen-reader-text\">  Read More<\/span><\/a><\/p>\n","protected":false},"author":1140,"featured_media":0,"comment_status":"open","ping_status":"open","sticky":false,"template":"","format":"standard","meta":[],"categories":[4,7],"tags":[13,511],"series":[],"aioseo_notices":[],"views":14297,"post_thumbnail_image":"","content_first_image":"","post_medium_image_300":"","post_thumbnail_image_624":"","post_frist_image":"","post_medium_image":"","post_large_image":"","post_full_image":"","post_all_images":[],"videoAdId":"","listAd":"0","listAdId":"","listAdEvery":5,"total_comments":6,"category_name":"Java\u8bed\u8a00","post_date":"2011-04-06","like_count":"0","praiseWord":"\u9f13\u52b1","excitationAd":"0","rewardedVideoAdId":"","detailAdId":"","detailAd":"0","enterpriseMinapp":"0","audios":[],"postImageUrl":"http:\/\/coolshell.cn\/wp-content\/uploads\/2016\/09\/coolshell-360x200.jpg","avatarurls":[],"related_posts":[],"pageviews":14298,"pageviews_wl":13471,"ratings_average":2,"ratings_total":23,"ratings_users":9,"next_post_id":4270,"next_post_title":"Eclipse\u5f00\u53d1Android\u5e94\u7528\u7a0b\u5e8f\u5165\u95e8","previous_post_id":4220,"previous_post_title":"\u4e00\u4e9b\u6709\u610f\u601d\u7684\u6587\u7ae0\u548c\u8d44\u6e90"}