{"id":671,"date":"2009-04-26T01:29:57","date_gmt":"2009-04-25T17:29:57","guid":{"rendered":"http:\/\/coolshell.cn\/?p=671"},"modified":"2009-04-26T12:24:26","modified_gmt":"2009-04-26T04:24:26","slug":"python%e8%b0%83%e7%94%a8c%e8%af%ad%e8%a8%80%e5%87%bd%e6%95%b0","status":"publish","type":"post","link":"https:\/\/coolshell.cn\/articles\/671.html","title":{"rendered":"Python\u8c03\u7528C\u8bed\u8a00\u51fd\u6570"},"content":{"rendered":"<p>\u4f7f\u7528Python\u7684<a href=\"http:\/\/docs.python.org\/library\/ctypes.html\">ctypes<\/a>\uff0c\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u8c03\u7528\u7531C\u76f4\u63a5\u7f16\u8bd1\u51fa\u6765\u7684\u51fd\u6570\u3002\u5176\u5b9e\u5c31\u662f\u8c03\u7528\u52a8\u6001\u94fe\u63a5\u5e93\u4e2d\u7684\u51fd\u6570\u3002\u4e3a\u4ec0\u4e48\u6211\u4eec\u9700\u8981\u8fd9\u6837\u505a\u5462\uff0c\u56e0\u4e3a\u6709\u4e9b\u65f6\u5019\uff0c\u6211\u4eec\u53ef\u80fd\u9700\u8981\u4e00\u4e2a\u6027\u80fd\u4e0a\u6bd4\u8f83\u8bb2\u7a76\u7684\u7b97\u6cd5\uff0c\u6709\u4e9b\u65f6\u5019\uff0c\u6211\u4eec\u53ef\u4ee5\u5728Python\u4e2d\u4f7f\u7528\u5df2\u7ecf\u6709\u4e86\u7684\u73b0\u6210\u7684\u88ab\u5c01\u95ed\u5728\u52a8\u6001\u94fe\u63a5\u5e93\u4e2d\u7684\u51fd\u6570\u3002\u4e0b\u9762\u662f\u5982\u4f55\u8c03\u7528\u7684\u793a\u4f8b\u3002<\/p>\n<p>\u9996\u5148\uff0c\u6211\u4eec\u7528\u4e00\u4e2a\u4e58\u6cd5\u6765\u8868\u793a\u4e00\u4e2a\u7b97\u6cd5\u529f\u80fd\u3002\u4e0b\u9762\u662fC\u7684\u7a0b\u5e8f\uff1a<\/p>\n<pre data-enlighter-language=\"c\" class=\"EnlighterJSRAW\">int\r\nmultiply(int num1, int num2)\r\n{\r\n\u00a0\u00a0\u00a0 return num1 * num2;\r\n}\r\n<\/pre>\n<p><!--more--><\/p>\n<p>\u5982\u679c\u5728Windows\u4e0b\uff0c\u4f60\u53ef\u80fd\u9700\u8981\u5199\u6210\u4e0b\u9762\u8fd9\u4e2a\u6837\u5b50\uff1a<\/p>\n<pre data-enlighter-language=\"c\" class=\"EnlighterJSRAW\">\r\n#include &lt;windows.h&gt;\r\n\r\n\r\nBOOL APIENTRY\r\nDllMain(HANDLE hModule, DWORD dwReason, LPVOID lpReserved)\r\n{\r\n\u00a0\u00a0\u00a0 return TRUE;\r\n}\r\n\r\n__declspec(dllexport) int\r\nmultiply(int num1, int num2)\r\n{\r\n\u00a0\u00a0\u00a0 return num1 * num2;\r\n}\r\n<\/pre>\n<p>\u7136\u540e\uff0c\u81ea\u7136\u662f\u628a\u8fd9\u4e2aC\u6587\u4ef6\u7f16\u6210\u52a8\u6001\u94fe\u63a5\u5e93\uff1a<\/p>\n<p>Linux\u4e0b\u7684\u7f16\u8bd1\uff1a<\/p>\n<pre data-enlighter-language=\"shell\" class=\"EnlighterJSRAW\">\r\ngcc -c -fPIC libtest.c\r\ngcc -shared libtest.o -o libtest.so\r\n<\/pre>\n<p>Windows\u4e0b\u7684\u7f16\u8bd1\uff1a<\/p>\n<pre data-enlighter-language=\"shell\" class=\"EnlighterJSRAW\">\r\ncl -LD libtest.c -libtest.dll\r\n<\/pre>\n<p>\u4e8e\u662f\u5728\u6211\u4eec\u7684Python\u4e2d\u53ef\u4ee5\u8fd9\u6837\u4f7f\u7528\uff1a<br \/>\n(\u5176\u4e2d\u7684libtest.so\u5728Windows\u4e0b\u6539\u6210libtest.dll\u5373\u53ef)<\/p>\n<pre data-enlighter-language=\"python\" class=\"EnlighterJSRAW\">\r\n&gt;&gt;&gt; from ctypes import *\r\n&gt;&gt;&gt; import os\r\n&gt;&gt;&gt; libtest = cdll.LoadLibrary(os.getcwd() + &#039;\/libtest.so&#039;)\r\n&gt;&gt;&gt; print libtest.multiply(2, 2)\r\n4\r\n<\/pre>\n<p>\u6ce8\u610f\uff1a\u4e0a\u9762\u7684Python\u811a\u672c\u4e2d\u9700\u8981\u628a\u52a8\u6001\u94fe\u63a5\u5e93\u653e\u5230\u5f53\u524d\u76ee\u5f55\u4e2d\u3002<\/p>\n","raw":"","protected":false},"excerpt":{"rendered":"<p>\u4f7f\u7528Python\u7684ctypes\uff0c\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u8c03\u7528\u7531C\u76f4\u63a5\u7f16\u8bd1\u51fa\u6765\u7684\u51fd\u6570\u3002\u5176\u5b9e\u5c31\u662f\u8c03\u7528\u52a8\u6001\u94fe\u63a5\u5e93\u4e2d\u7684\u51fd\u6570\u3002\u4e3a\u4ec0\u4e48\u6211\u4eec\u9700\u8981\u8fd9\u6837\u505a\u5462\uff0c\u56e0\u4e3a\u6709\u4e9b\u65f6\u5019\uff0c\u6211\u4eec\u53ef\u80fd\u9700\u8981\u4e00\u4e2a\u6027&#8230;<\/p>\n<p class=\"read-more\"><a class=\"btn btn-default\" href=\"https:\/\/coolshell.cn\/articles\/671.html\"> Read More<span class=\"screen-reader-text\">  Read More<\/span><\/a><\/p>\n","protected":false},"author":2,"featured_media":0,"comment_status":"open","ping_status":"open","sticky":false,"template":"","format":"standard","meta":[],"categories":[33,3],"tags":[112,791],"series":[],"aioseo_notices":[],"views":36205,"post_thumbnail_image":"","content_first_image":"","post_medium_image_300":"","post_thumbnail_image_624":"","post_frist_image":"","post_medium_image":"","post_large_image":"","post_full_image":"","post_all_images":[],"videoAdId":"","listAd":"0","listAdId":"","listAdEvery":5,"total_comments":20,"category_name":"Python","post_date":"2009-04-26","like_count":"0","praiseWord":"\u9f13\u52b1","excitationAd":"0","rewardedVideoAdId":"","detailAdId":"","detailAd":"0","enterpriseMinapp":"0","audios":[],"postImageUrl":"http:\/\/coolshell.cn\/wp-content\/uploads\/2016\/09\/coolshell-360x200.jpg","avatarurls":[],"related_posts":[],"pageviews":36206,"pageviews_wl":8562,"ratings_average":4,"ratings_total":70,"ratings_users":17,"next_post_id":677,"next_post_title":"\u7528Python\u5199NCurses UI","previous_post_id":664,"previous_post_title":"\u4f7f\u7528PHP\u7684cURL\u5e93"}