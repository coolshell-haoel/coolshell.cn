{"id":8489,"date":"2012-11-07T08:17:20","date_gmt":"2012-11-07T00:17:20","guid":{"rendered":"http:\/\/coolshell.cn\/?p=8489"},"modified":"2020-07-06T18:00:52","modified_gmt":"2020-07-06T10:00:52","slug":"go-%e8%af%ad%e8%a8%80%e7%ae%80%e4%bb%8b%ef%bc%88%e4%b8%8b%ef%bc%89-%e7%89%b9%e6%80%a7","status":"publish","type":"post","link":"https:\/\/coolshell.cn\/articles\/8489.html","title":{"rendered":"Go \u8bed\u8a00\u7b80\u4ecb\uff08\u4e0b\uff09\u2014 \u7279\u6027"},"content":{"rendered":"<p>\u5e0c\u671b\u4f60\u770b\u5230\u8fd9\u7bc7\u6587\u7ae0\u7684\u65f6\u5019\u8fd8\u662f\u5728\u516c\u4ea4\u8f66\u548c\u5730\u94c1\u4e0a\u6b63\u5728\u4e0a\u4e0b\u73ed\u7684\u65f6\u95f4\uff0c\u6211\u5e0c\u671b\u6211\u7684\u8fd9\u7bc7\u6587\u7ae0\u53ef\u4ee5\u8ba9\u4f60\u5229\u7528\u8fd9\u6bb5\u65f6\u95f4\u4e86\u89e3\u4e00\u95e8\u8bed\u8a00\u3002\u5f53\u7136\uff0c\u5e0c\u671b\u4f60\u4e0d\u4f1a\u56e0\u4e3a\u770b\u6211\u7684\u6587\u7ae0\u800c\u9519\u8fc7\u7ad9\u3002\u5475\u5475\u3002<\/p>\n<p>\u5982\u679c\u4f60\u8fd8\u4e0d\u4e86\u89e3Go\u8bed\u8a00\u7684\u8bed\u6cd5\uff0c\u8fd8\u8bf7\u4f60\u79fb\u6b65\u5148\u770b\u4e00\u4e0b\u4e0a\u7bc7\u2014\u2014\u300a<strong><a title=\"Go\u8bed\u8a00\u7b80\u4ecb\uff08\u4e0a\uff09\uff1a\u8bed\u6cd5\" href=\"https:\/\/coolshell.cn\/articles\/8460.html\" target=\"_blank\" rel=\"noopener noreferrer\">Go\u8bed\u8a00\u7b80\u4ecb\uff08\u4e0a\uff09\uff1a\u8bed\u6cd5<\/a><\/strong>\u300b<\/p>\n<p><img decoding=\"async\" loading=\"lazy\" src=\"https:\/\/coolshell.cn\/wp-content\/uploads\/2012\/11\/google-go-language.jpg\" alt=\"\" title=\"google-go-language\" width=\"450\" height=\"272\" class=\"aligncenter size-full wp-image-8531\" srcset=\"https:\/\/coolshell.cn\/wp-content\/uploads\/2012\/11\/google-go-language.jpg 450w, https:\/\/coolshell.cn\/wp-content\/uploads\/2012\/11\/google-go-language-300x181.jpg 300w, https:\/\/coolshell.cn\/wp-content\/uploads\/2012\/11\/google-go-language-447x270.jpg 447w\" sizes=\"(max-width: 450px) 100vw, 450px\" \/><\/p>\n<div id=\"ez-toc-container\" class=\"ez-toc-v2_0_48 counter-hierarchy ez-toc-counter ez-toc-grey ez-toc-container-direction\">\n<div class=\"ez-toc-title-container\">\n<p class=\"ez-toc-title\">\u76ee\u5f55<\/p>\n<span class=\"ez-toc-title-toggle\"><\/span><\/div>\n<nav><ul class='ez-toc-list ez-toc-list-level-1 ' ><li class='ez-toc-page-1 ez-toc-heading-level-4'><a class=\"ez-toc-link ez-toc-heading-1\" href=\"https:\/\/coolshell.cn\/articles\/8489.html\/#goroutine\" title=\"goroutine\">goroutine<\/a><\/li><li class='ez-toc-page-1 ez-toc-heading-level-4'><a class=\"ez-toc-link ez-toc-heading-2\" href=\"https:\/\/coolshell.cn\/articles\/8489.html\/#goroutine%E7%9A%84%E5%B9%B6%E5%8F%91%E5%AE%89%E5%85%A8%E6%80%A7\" title=\"goroutine\u7684\u5e76\u53d1\u5b89\u5168\u6027\">goroutine\u7684\u5e76\u53d1\u5b89\u5168\u6027<\/a><\/li><li class='ez-toc-page-1 ez-toc-heading-level-4'><a class=\"ez-toc-link ez-toc-heading-3\" href=\"https:\/\/coolshell.cn\/articles\/8489.html\/#%E5%8E%9F%E5%AD%90%E6%93%8D%E4%BD%9C\" title=\"\u539f\u5b50\u64cd\u4f5c\">\u539f\u5b50\u64cd\u4f5c<\/a><\/li><li class='ez-toc-page-1 ez-toc-heading-level-4'><a class=\"ez-toc-link ez-toc-heading-4\" href=\"https:\/\/coolshell.cn\/articles\/8489.html\/#Channel_%E4%BF%A1%E9%81%93\" title=\"Channel \u4fe1\u9053\">Channel \u4fe1\u9053<\/a><\/li><li class='ez-toc-page-1 ez-toc-heading-level-4'><a class=\"ez-toc-link ez-toc-heading-5\" href=\"https:\/\/coolshell.cn\/articles\/8489.html\/#%E5%AE%9A%E6%97%B6%E5%99%A8\" title=\"\u5b9a\u65f6\u5668\">\u5b9a\u65f6\u5668<\/a><\/li><li class='ez-toc-page-1 ez-toc-heading-level-4'><a class=\"ez-toc-link ez-toc-heading-6\" href=\"https:\/\/coolshell.cn\/articles\/8489.html\/#Socket%E7%BC%96%E7%A8%8B\" title=\"Socket\u7f16\u7a0b\">Socket\u7f16\u7a0b<\/a><\/li><li class='ez-toc-page-1 ez-toc-heading-level-4'><a class=\"ez-toc-link ez-toc-heading-7\" href=\"https:\/\/coolshell.cn\/articles\/8489.html\/#%E7%B3%BB%E7%BB%9F%E8%B0%83%E7%94%A8\" title=\"\u7cfb\u7edf\u8c03\u7528\">\u7cfb\u7edf\u8c03\u7528<\/a><\/li><li class='ez-toc-page-1 ez-toc-heading-level-4'><a class=\"ez-toc-link ez-toc-heading-8\" href=\"https:\/\/coolshell.cn\/articles\/8489.html\/#%E6%89%A7%E8%A1%8C%E5%91%BD%E4%BB%A4%E8%A1%8C\" title=\"\u6267\u884c\u547d\u4ee4\u884c\">\u6267\u884c\u547d\u4ee4\u884c<\/a><\/li><li class='ez-toc-page-1 ez-toc-heading-level-4'><a class=\"ez-toc-link ez-toc-heading-9\" href=\"https:\/\/coolshell.cn\/articles\/8489.html\/#%E5%91%BD%E4%BB%A4%E8%A1%8C%E5%8F%82%E6%95%B0\" title=\"\u547d\u4ee4\u884c\u53c2\u6570\">\u547d\u4ee4\u884c\u53c2\u6570<\/a><\/li><li class='ez-toc-page-1 ez-toc-heading-level-4'><a class=\"ez-toc-link ez-toc-heading-10\" href=\"https:\/\/coolshell.cn\/articles\/8489.html\/#%E4%B8%80%E4%B8%AA%E7%AE%80%E5%8D%95%E7%9A%84HTTP_Server\" title=\"\u4e00\u4e2a\u7b80\u5355\u7684HTTP Server\">\u4e00\u4e2a\u7b80\u5355\u7684HTTP Server<\/a><\/li><\/ul><\/nav><\/div>\n<h4><span class=\"ez-toc-section\" id=\"goroutine\"><\/span>goroutine<span class=\"ez-toc-section-end\"><\/span><\/h4>\n<p>GoRoutine\u4e3b\u8981\u662f\u4f7f\u7528go\u5173\u952e\u5b57\u6765\u8c03\u7528\u51fd\u6570\uff0c\u4f60\u8fd8\u53ef\u4ee5\u4f7f\u7528\u533f\u540d\u51fd\u6570\uff0c\u5982\u4e0b\u6240\u793a\uff1a<\/p>\n<p><!--more--><\/p>\n<pre class=\"EnlighterJSRAW\" data-enlighter-language=\"golang\" data-enlighter-highlight=\"9,11\">package main\nimport &quot;fmt&quot;\n\nfunc f(msg string) {\n    fmt.Println(msg)\n}\n\nfunc main(){\n    go f(&quot;goroutine&quot;)\n\n    go func(msg string) {\n        fmt.Println(msg)\n    }(&quot;going&quot;)\n}<\/pre>\n<p>\u6211\u4eec\u518d\u6765\u770b\u4e00\u4e2a\u793a\u4f8b\uff0c\u4e0b\u9762\u7684\u4ee3\u7801\u4e2d\u5305\u62ec\u5f88\u591a\u5185\u5bb9\uff0c\u5305\u62ec\u65f6\u95f4\u5904\u7406\uff0c\u968f\u673a\u6570\u5904\u7406\uff0c\u8fd8\u6709goroutine\u7684\u4ee3\u7801\u3002\u5982\u679c\u4f60\u719f\u6089C\u8bed\u8a00\uff0c\u4f60\u5e94\u8be5\u4f1a\u5f88\u5bb9\u6613\u7406\u89e3\u4e0b\u9762\u7684\u4ee3\u7801\u3002<\/p>\n<p>\u4f60\u53ef\u4ee5\u7b80\u5355\u7684\u628ago\u5173\u952e\u5b57\u8c03\u7528\u7684\u51fd\u6570\u60f3\u50cf\u6210pthread_create\u3002\u4e0b\u9762\u7684\u4ee3\u7801\u4f7f\u7528for\u5faa\u73af\u521b\u5efa\u4e863\u4e2a\u7ebf\u7a0b\uff0c\u6bcf\u4e2a\u7ebf\u7a0b\u4f7f\u7528\u4e00\u4e2a\u968f\u673a\u7684Sleep\u65f6\u95f4\uff0c\u7136\u540e\u5728routine()\u51fd\u6570\u4e2d\u4f1a\u8f93\u51fa\u4e00\u4e9b\u7ebf\u7a0b\u6267\u884c\u7684\u65f6\u95f4\u4fe1\u606f\u3002<\/p>\n<pre class=\"EnlighterJSRAW\" data-enlighter-language=\"golang\">\npackage main\n\nimport &quot;fmt&quot;\nimport &quot;time&quot;\nimport &quot;math\/rand&quot;\n\nfunc routine(name string, delay time.Duration) {\n\n    t0 := time.Now()\n    fmt.Println(name, &quot; start at &quot;, t0)\n\n    time.Sleep(delay)\n\n    t1 := time.Now()\n    fmt.Println(name, &quot; end at &quot;, t1)\n\n    fmt.Println(name, &quot; lasted &quot;, t1.Sub(t0))\n}\n\nfunc main() {\n\n    \/\/\u751f\u6210\u968f\u673a\u79cd\u5b50\n    rand.Seed(time.Now().Unix())\n\n    var name string\n    for i:=0; i&lt;3; i++{\n        name = fmt.Sprintf(&quot;go_%02d&quot;, i) \/\/\u751f\u6210ID\n        \/\/\u751f\u6210\u968f\u673a\u7b49\u5f85\u65f6\u95f4\uff0c\u4ece0-4\u79d2\n        go routine(name, time.Duration(rand.Intn(5)) * time.Second)\n    }\n\n    \/\/\u8ba9\u4e3b\u8fdb\u7a0b\u505c\u4f4f\uff0c\u4e0d\u7136\u4e3b\u8fdb\u7a0b\u9000\u4e86\uff0cgoroutine\u4e5f\u5c31\u9000\u4e86\n    var input string\n    fmt.Scanln(&amp;input)\n    fmt.Println(&quot;done&quot;)\n}\n<\/pre>\n<p>\u8fd0\u884c\u7684\u7ed3\u679c\u53ef\u80fd\u662f\uff1a<\/p>\n<pre class=\"EnlighterJSRAW\" data-enlighter-language=\"shell\">\ngo_00  start at  2012-11-04 19:46:35.8974894 +0800 +0800\ngo_01  start at  2012-11-04 19:46:35.8974894 +0800 +0800\ngo_02  start at  2012-11-04 19:46:35.8974894 +0800 +0800\ngo_01  end at  2012-11-04 19:46:36.8975894 +0800 +0800\ngo_01  lasted  1.0001s\ngo_02  end at  2012-11-04 19:46:38.8987895 +0800 +0800\ngo_02  lasted  3.0013001s\ngo_00  end at  2012-11-04 19:46:39.8978894 +0800 +0800\ngo_00  lasted  4.0004s\n<\/pre>\n<h4><span class=\"ez-toc-section\" id=\"goroutine%E7%9A%84%E5%B9%B6%E5%8F%91%E5%AE%89%E5%85%A8%E6%80%A7\"><\/span>goroutine\u7684\u5e76\u53d1\u5b89\u5168\u6027<span class=\"ez-toc-section-end\"><\/span><\/h4>\n<p>\u5173\u4e8egoroutine\uff0c\u6211\u8bd5\u4e86\u4e00\u4e0b\uff0c\u65e0\u8bba\u662fWindows\u8fd8\u662fLinux\uff0c\u57fa\u672c\u4e0a\u6765\u8bf4\u662f\u7528\u64cd\u4f5c\u7cfb\u7edf\u7684\u7ebf\u7a0b\u6765\u5b9e\u73b0\u7684\u3002\u4e0d\u8fc7\uff0cgoroutine\u6709\u4e2a\u7279\u6027\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0c<strong>\u5982\u679c\u4e00\u4e2agoroutine\u6ca1\u6709\u88ab\u963b\u585e\uff0c\u90a3\u4e48\u522b\u7684goroutine\u5c31\u4e0d\u4f1a\u5f97\u5230\u6267\u884c<\/strong>\u3002\u8fd9\u5e76\u4e0d\u662f\u771f\u6b63\u7684\u5e76\u53d1\uff0c\u5982\u679c\u4f60\u8981\u771f\u6b63\u7684\u5e76\u53d1\uff0c\u4f60\u9700\u8981\u5728\u4f60\u7684main\u51fd\u6570\u7684\u7b2c\u4e00\u884c\u52a0\u4e0a\u4e0b\u9762\u7684\u8fd9\u6bb5\u4ee3\u7801\uff1a<\/p>\n<pre class=\"EnlighterJSRAW\" data-enlighter-language=\"golang\">import &quot;runtime&quot;\n...\nruntime.GOMAXPROCS(4)<\/pre>\n<p>\u8fd8\u662f\u8ba9\u6211\u4eec\u6765\u770b\u4e00\u4e2a\u6709\u5e76\u53d1\u5b89\u5168\u6027\u95ee\u9898\u7684\u793a\u4f8b\uff08\u6ce8\u610f\uff1a\u6211\u4f7f\u7528\u4e86C\u7684\u65b9\u5f0f\u6765\u5199\u8fd9\u6bb5Go\u7684\u7a0b\u5e8f\uff09<\/p>\n<p>\u8fd9\u662f\u4e00\u4e2a\u7ecf\u5e38\u51fa\u73b0\u5728\u6559\u79d1\u4e66\u91cc\u5356\u7968\u7684\u4f8b\u5b50\uff0c\u6211\u542f\u4e865\u4e2agoroutine\u6765\u5356\u7968\uff0c\u5356\u7968\u7684\u51fd\u6570sell_tickets\u5f88\u7b80\u5355\uff0c\u5c31\u662f\u968f\u673a\u7684sleep\u4e00\u4e0b\uff0c\u7136\u540e\u5bf9\u5168\u5c40\u53d8\u91cftotal_tickets\u4f5c\u51cf\u4e00\u64cd\u4f5c\u3002<\/p>\n<pre class=\"EnlighterJSRAW\" data-enlighter-language=\"golang\">\npackage main\n\nimport &quot;fmt&quot;\nimport &quot;time&quot;\nimport &quot;math\/rand&quot;\nimport &quot;runtime&quot;\n\nvar total_tickets int32 = 10;\n\nfunc sell_tickets(i int){\n    for{\n        if total_tickets &gt; 0 { \/\/\u5982\u679c\u6709\u7968\u5c31\u5356\n            time.Sleep( time.Duration(rand.Intn(5)) * time.Millisecond)\n            total_tickets-- \/\/\u5356\u4e00\u5f20\u7968\n            fmt.Println(&quot;id:&quot;, i, &quot;  ticket:&quot;, total_tickets)\n        }else{\n            break\n        }\n    }\n}\n\nfunc main() {\n    runtime.GOMAXPROCS(4) \/\/\u6211\u7684\u7535\u8111\u662f4\u6838\u5904\u7406\u5668\uff0c\u6240\u4ee5\u6211\u8bbe\u7f6e\u4e864\n    rand.Seed(time.Now().Unix()) \/\/\u751f\u6210\u968f\u673a\u79cd\u5b50\n\n    for i := 0; i &lt; 5; i++ { \/\/\u5e76\u53d15\u4e2agoroutine\u6765\u5356\u7968\n         go sell_tickets(i)\n    }\n    \/\/\u7b49\u5f85\u7ebf\u7a0b\u6267\u884c\u5b8c\n    var input string\n    fmt.Scanln(&amp;input)\n    fmt.Println(total_tickets, &quot;done&quot;) \/\/\u9000\u51fa\u65f6\u6253\u5370\u8fd8\u6709\u591a\u5c11\u7968\n}<\/pre>\n<p>\u8fd9\u4e2a\u7a0b\u5e8f\u6bcb\u5eb8\u7f6e\u7591\u6709\u5e76\u53d1\u5b89\u5168\u6027\u95ee\u9898\uff0c\u6240\u4ee5\u6267\u884c\u8d77\u6765\u4f60\u4f1a\u770b\u5230\u4e0b\u9762\u7684\u7ed3\u679c\uff1a<\/p>\n<pre class=\"EnlighterJSRAW\" data-enlighter-language=\"shell\">\n$go run sell_tickets.go\nid: 0   ticket: 9  \nid: 0   ticket: 8  \nid: 4   ticket: 7  \nid: 1   ticket: 6  \nid: 3   ticket: 5  \nid: 0   ticket: 4  \nid: 3   ticket: 3  \nid: 2   ticket: 2  \nid: 0   ticket: 1  \nid: 3   ticket: 0  \nid: 1   ticket: -1  \nid: 4   ticket: -2  \nid: 2   ticket: -3  \nid: 0   ticket: -4  \n-4 done<\/pre>\n<p>\u53ef\u89c1\uff0c\u6211\u4eec\u9700\u8981\u4f7f\u7528\u4e0a\u9501\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u4e92\u65a5\u91cf\u6765\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u3002\u4e0b\u9762\u7684\u4ee3\u7801\uff0c\u6211\u53ea\u5217\u51fa\u4e86\u4fee\u6539\u8fc7\u7684\u5185\u5bb9\uff1a<\/p>\n<pre class=\"EnlighterJSRAW\" data-enlighter-language=\"golang\" data-enlighter-highlight=\"5,9,13,19\"> package main\nimport &quot;fmt&quot;\nimport &quot;time&quot;\nimport &quot;math\/rand&quot;\nimport &quot;sync&quot;\nimport &quot;runtime&quot;\n\nvar total_tickets int32 = 10;\nvar mutex = &amp;sync.Mutex{} \/\/\u53ef\u7b80\u5199\u6210\uff1avar mutex sync.Mutex\n\nfunc sell_tickets(i int){\n    for total_tickets&gt;0 {\n        mutex.Lock()\n        if total_tickets &gt; 0 {\n            time.Sleep( time.Duration(rand.Intn(5)) * time.Millisecond)\n            total_tickets--\n            fmt.Println(i, total_tickets)\n        }\n        mutex.Unlock()\n    }\n}\n.......\n......\n<\/pre>\n<h4><span class=\"ez-toc-section\" id=\"%E5%8E%9F%E5%AD%90%E6%93%8D%E4%BD%9C\"><\/span>\u539f\u5b50\u64cd\u4f5c<span class=\"ez-toc-section-end\"><\/span><\/h4>\n<p>\u8bf4\u5230\u5e76\u53d1\u5c31\u9700\u8981\u8bf4\u8bf4\u539f\u5b50\u64cd\u4f5c\uff0c\u76f8\u4fe1\u5927\u5bb6\u8fd8\u8bb0\u5f97\u6211\u5199\u7684\u90a3\u7bc7\u300a<a title=\"\u65e0\u9501\u961f\u5217\u7684\u5b9e\u73b0\" href=\"https:\/\/coolshell.cn\/articles\/8239.html\" target=\"_blank\" rel=\"noopener noreferrer\">\u65e0\u9501\u961f\u5217\u7684\u5b9e\u73b0<\/a>\u300b\u4e00\u6587\uff0c\u91cc\u9762\u8bf4\u5230\u4e86\u4e00\u4e9bCAS &#8211; CompareAndSwap\u7684\u64cd\u4f5c\u3002Go\u8bed\u8a00\u4e5f\u652f\u6301\u3002\u4f60\u53ef\u4ee5\u770b\u4e00\u4e0b\u76f8\u5f53\u7684\u6587\u6863<\/p>\n<p>\u6211\u5728\u8fd9\u91cc\u5c31\u4e3e\u4e00\u4e2a\u5f88\u7b80\u5355\u7684\u793a\u4f8b\uff1a\u4e0b\u9762\u7684\u7a0b\u5e8f\u670910\u4e2agoroutine\uff0c\u6bcf\u4e2a\u4f1a\u5bf9cnt\u53d8\u91cf\u7d2f\u52a020\u6b21\uff0c\u6240\u4ee5\uff0c\u6700\u540e\u7684cnt\u5e94\u8be5\u662f200\u3002\u5982\u679c\u6ca1\u6709atomic\u7684\u539f\u5b50\u64cd\u4f5c\uff0c\u90a3\u4e48cnt\u5c06\u6709\u53ef\u80fd\u5f97\u5230\u4e00\u4e2a\u5c0f\u4e8e200\u7684\u6570\u3002<\/p>\n<p>\u4e0b\u9762\u4f7f\u7528\u4e86atomic\u64cd\u4f5c\uff0c\u6240\u4ee5\u662f\u5b89\u5168\u7684\u3002<\/p>\n<pre class=\"EnlighterJSRAW\" data-enlighter-language=\"golang\" data-enlighter-highlight=\"5,13,18\">package main\n\nimport &quot;fmt&quot;\nimport &quot;time&quot;\nimport &quot;sync\/atomic&quot;\n\nfunc main() {\n    var cnt uint32 = 0\n    for i := 0; i &lt; 10; i++ {\n        go func() {\n            for i:=0; i&lt;20; i++ {\n                time.Sleep(time.Millisecond)\n                atomic.AddUint32(&amp;cnt, 1)\n            }\n        }()\n    }\n    time.Sleep(time.Second)\/\/\u7b49\u4e00\u79d2\u949f\u7b49goroutine\u5b8c\u6210\n    cntFinal := atomic.LoadUint32(&amp;cnt)\/\/\u53d6\u6570\u636e\n    fmt.Println(&quot;cnt:&quot;, cntFinal)\n}<\/pre>\n<p>\u8fd9\u6837\u7684\u51fd\u6570\u8fd8\u6709\u5f88\u591a\uff0c\u53c2\u770b<a href=\"http:\/\/golang.org\/pkg\/sync\/atomic\/\" target=\"_blank\" rel=\"noopener noreferrer\">go\u7684atomic\u5305\u6587\u6863<\/a>\uff08\u88ab\u5899\uff09<\/p>\n<h4><span class=\"ez-toc-section\" id=\"Channel_%E4%BF%A1%E9%81%93\"><\/span>Channel \u4fe1\u9053<span class=\"ez-toc-section-end\"><\/span><\/h4>\n<p>Channal\u662f\u4ec0\u4e48\uff1fChannal\u5c31\u662f\u7528\u6765\u901a\u4fe1\u7684\uff0c\u5c31\u50cfUnix\u4e0b\u7684\u7ba1\u9053\u4e00\u6837\uff0c\u5728Go\u4e2d\u662f\u8fd9\u6837\u4f7f\u7528Channel\u7684\u3002<\/p>\n<p>\u4e0b\u9762\u7684\u7a0b\u5e8f\u6f14\u793a\u4e86\u4e00\u4e2agoroutine\u548c\u4e3b\u7a0b\u5e8f\u901a\u4fe1\u7684\u4f8b\u7a0b\u3002\u8fd9\u4e2a\u7a0b\u5e8f\u8db3\u591f\u7b80\u5355\u4e86\u3002<\/p>\n<pre class=\"EnlighterJSRAW\" data-enlighter-language=\"golang\" data-enlighter-highlight=\"7,10\">\npackage main\n\nimport &quot;fmt&quot;\n\nfunc main() {\n    \/\/\u521b\u5efa\u4e00\u4e2astring\u7c7b\u578b\u7684channel\n    channel := make(chan string)\n\n    \/\/\u521b\u5efa\u4e00\u4e2agoroutine\u5411channel\u91cc\u53d1\u4e00\u4e2a\u5b57\u7b26\u4e32\n    go func() { channel &lt;- &quot;hello&quot; }()\n\n    msg := &lt;- channel\n    fmt.Println(msg)\n}[<\/pre>\n<p><strong>\u6307\u5b9achannel\u7684buffer<\/strong><\/p>\n<p>\u6307\u5b9abuffer\u7684\u5927\u5c0f\u5f88\u7b80\u5355\uff0c\u770b\u4e0b\u9762\u7684\u7a0b\u5e8f\uff1a<\/p>\n<pre class=\"EnlighterJSRAW\" data-enlighter-language=\"golang\" data-enlighter-highlight=\"5\">package main\nimport &quot;fmt&quot;\n\nfunc main() {\n    channel := make(chan string, 2)\n\n    go func() {\n        channel &lt;- &quot;hello&quot;\n        channel &lt;- &quot;World&quot;\n    }()\n\n    msg1 := &lt;-channel\n    msg2 := &lt;-channel\n    fmt.Println(msg1, msg2)\n}<\/pre>\n<p><strong>Channel\u7684\u963b\u585e<\/strong><\/p>\n<p>\u6ce8\u610f\uff0cchannel\u9ed8\u8ba4\u4e0a\u662f\u963b\u585e\u7684\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0c\u5982\u679cChannel\u6ee1\u4e86\uff0c\u5c31\u963b\u585e\u5199\uff0c\u5982\u679cChannel\u7a7a\u4e86\uff0c\u5c31\u963b\u585e\u8bfb\u3002\u4e8e\u662f\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u4f7f\u7528\u8fd9\u79cd\u7279\u6027\u6765\u540c\u6b65\u6211\u4eec\u7684\u53d1\u9001\u548c\u63a5\u6536\u7aef\u3002<\/p>\n<p>\u4e0b\u9762\u8fd9\u4e2a\u4f8b\u7a0b\u8bf4\u660e\u4e86\u8fd9\u4e00\u70b9\uff0c\u4ee3\u7801\u6709\u70b9\u4e71\uff0c\u4e0d\u8fc7\u6211\u89c9\u5f97\u4e0d\u96be\u7406\u89e3\u3002<\/p>\n<pre class=\"EnlighterJSRAW\" data-enlighter-language=\"golang\">package main\n\nimport &quot;fmt&quot;\nimport &quot;time&quot;\n\nfunc main() {\n\n    channel := make(chan string) \/\/\u6ce8\u610f: buffer\u4e3a1\n\n    go func() {\n        channel &lt;- &quot;hello&quot;\n        fmt.Println(&quot;write \\&quot;hello\\&quot; done!&quot;)\n\n        channel &lt;- &quot;World&quot; \/\/Reader\u5728Sleep\uff0c\u8fd9\u91cc\u5728\u963b\u585e\n        fmt.Println(&quot;write \\&quot;World\\&quot; done!&quot;)\n\n        fmt.Println(&quot;Write go sleep...&quot;)\n        time.Sleep(3*time.Second)\n        channel &lt;- &quot;channel&quot;\n        fmt.Println(&quot;write \\&quot;channel\\&quot; done!&quot;)\n    }()\n\n    time.Sleep(2*time.Second)\n    fmt.Println(&quot;Reader Wake up...&quot;)\n\n    msg := &lt;-channel\n    fmt.Println(&quot;Reader: &quot;, msg)\n\n    msg = &lt;-channel\n    fmt.Println(&quot;Reader: &quot;, msg)\n\n    msg = &lt;-channel \/\/Writer\u5728Sleep\uff0c\u8fd9\u91cc\u5728\u963b\u585e\n    fmt.Println(&quot;Reader: &quot;, msg)\n}<\/pre>\n<p>\u4e0a\u9762\u7684\u4ee3\u7801\u8f93\u51fa\u7684\u7ed3\u679c\u5982\u4e0b\uff1a<\/p>\n<pre class=\"EnlighterJSRAW\" data-enlighter-language=\"shell\">\nReader Wake up...\nReader:  hello\nwrite &quot;hello&quot; done!\nwrite &quot;World&quot; done!\nWrite go sleep...\nReader:  World\nwrite &quot;channel&quot; done!\nReader:  channel\n<\/pre>\n<p><strong>Channel\u963b\u585e\u7684\u8fd9\u4e2a\u7279\u6027\u8fd8\u6709\u4e00\u4e2a\u597d\u5904\u662f\uff0c\u53ef\u4ee5\u8ba9\u6211\u4eec\u7684goroutine\u5728\u8fd0\u884c\u7684\u4e00\u5f00\u59cb\u5c31\u963b\u585e\u5728\u4ece\u67d0\u4e2achannel\u9886\u4efb\u52a1\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u4f5c\u6210\u4e00\u4e2a\u7c7b\u4f3c\u4e8e\u7ebf\u7a0b\u6c60\u4e00\u6837\u7684\u4e1c\u897f\u3002\u5173\u4e8e\u8fd9\u4e2a\u7a0b\u5e8f\u6211\u5c31\u4e0d\u5199\u4e86\u3002\u6211\u76f8\u4fe1\u4f60\u53ef\u4ee5\u81ea\u5df1\u5b9e\u73b0\u7684\u3002<\/strong><\/p>\n<p><strong>\u591a\u4e2aChannel\u7684select<\/strong><\/p>\n<pre class=\"EnlighterJSRAW\" data-enlighter-language=\"golang\">package main\nimport &quot;time&quot;\nimport &quot;fmt&quot;\n\nfunc main() {\n    \/\/\u521b\u5efa\u4e24\u4e2achannel - c1 c2\n    c1 := make(chan string)\n    c2 := make(chan string)\n\n    \/\/\u521b\u5efa\u4e24\u4e2agoruntine\u6765\u5206\u522b\u5411\u8fd9\u4e24\u4e2achannel\u53d1\u9001\u6570\u636e\n    go func() {\n        time.Sleep(time.Second * 1)\n        c1 &lt;- &quot;Hello&quot;\n    }()\n    go func() {\n        time.Sleep(time.Second * 1)\n        c2 &lt;- &quot;World&quot;\n    }()\n\n    \/\/\u4f7f\u7528select\u6765\u4fa6\u542c\u4e24\u4e2achannel\n    for i := 0; i &lt; 2; i++ {\n        select {\n        case msg1 := &lt;-c1:\n            fmt.Println(&quot;received&quot;, msg1)\n        case msg2 := &lt;-c2:\n            fmt.Println(&quot;received&quot;, msg2)\n        }\n    }\n}<\/pre>\n<p>\u6ce8\u610f\uff1a\u4e0a\u9762\u7684select\u662f\u963b\u585e\u7684\uff0c\u6240\u4ee5\uff0c\u624d\u641e\u51faugly\u7684for i &lt;2\u8fd9\u79cd\u4e1c\u897f<strong>\u3002<br \/>\n<\/strong><\/p>\n<p><strong>Channel select\u963b\u585e\u7684Timeout<\/strong><\/p>\n<p>\u89e3\u51b3\u4e0a\u8ff0\u90a3\u4e2afor\u5faa\u73af\u7684\u95ee\u9898\uff0c\u4e00\u822c\u6709\u4e24\u79cd\u65b9\u6cd5\uff1a\u4e00\u79cd\u662f\u963b\u585e\u4f46\u6709timeout\uff0c\u4e00\u79cd\u662f\u65e0\u963b\u585e\u3002\u6211\u4eec\u6765\u770b\u770b\u5982\u679c\u7ed9select\u8bbe\u7f6e\u4e0atimeout\u7684\u3002<\/p>\n<pre class=\"EnlighterJSRAW\" data-enlighter-language=\"golang\" data-enlighter-highlight=\"8\">\n    for {\n        timeout_cnt := 0\n        select {\n        case msg1 := &lt;-c1:\n            fmt.Println(&quot;msg1 received&quot;, msg1)\n        case msg2 := &lt;-c2:\n            fmt.Println(&quot;msg2 received&quot;, msg2)\n        case  &lt;-time.After(time.Second * 30)\uff1a\n            fmt.Println(&quot;Time Out&quot;)\n            timout_cnt++\n        }\n        if time_cnt &gt; 3 {\n            break\n        }\n    }\n<\/pre>\n<p>\u4e0a\u9762\u4ee3\u7801\u4e2d\u9ad8\u4eae\u7684\u4ee3\u7801\u4e3b\u8981\u662f\u7528\u6765\u8ba9select\u8fd4\u56de\u7684\uff0c\u6ce8\u610f case\u4e2d\u7684time.After\u4e8b\u4ef6\u3002<\/p>\n<p><strong>Channel\u7684\u65e0\u963b\u585e<\/strong><\/p>\n<p>\u597d\uff0c\u6211\u4eec\u518d\u6765\u770b\u770b\u65e0\u963b\u585e\u7684channel\uff0c\u5176\u5b9e\u4e5f\u5f88\u7b80\u5355\uff0c\u5c31\u662f\u5728select\u4e2d\u52a0\u5165default\uff0c\u5982\u4e0b\u6240\u793a\uff1a<\/p>\n<pre class=\"EnlighterJSRAW\" data-enlighter-language=\"golang\" data-enlighter-highlight=\"8\">\n    for {\n        select {\n        case msg1 := &lt;-c1:\n            fmt.Println(&quot;received&quot;, msg1)\n        case msg2 := &lt;-c2:\n            fmt.Println(&quot;received&quot;, msg2)\n        default: \/\/default\u4f1a\u5bfc\u81f4\u65e0\u963b\u585e\n            fmt.Println(&quot;nothing received!&quot;)\n            time.Sleep(time.Second)\n        }\n    }\n<\/pre>\n<p><strong>Channel\u7684\u5173\u95ed<\/strong><\/p>\n<p>\u5173\u95edChannel\u53ef\u4ee5\u901a\u77e5\u5bf9\u65b9\u5185\u5bb9\u53d1\u9001\u5b8c\u4e86\uff0c\u4e0d\u7528\u518d\u7b49\u4e86\u3002\u53c2\u770b\u4e0b\u9762\u7684\u4f8b\u7a0b\uff1a<\/p>\n<pre class=\"EnlighterJSRAW\" data-enlighter-language=\"golang\" data-enlighter-highlight=\"19,27\">package main\n\nimport &quot;fmt&quot;\nimport &quot;time&quot;\nimport &quot;math\/rand&quot;\n\nfunc main() {\n\n    channel := make(chan string)\n    rand.Seed(time.Now().Unix())\n\n    \/\/\u5411channel\u53d1\u9001\u968f\u673a\u4e2a\u6570\u7684message\n    go func () {\n        cnt := rand.Intn(10)\n        fmt.Println(&quot;message cnt :&quot;, cnt)\n        for i:=0; i&lt;cnt; i++{\n            channel &lt;- fmt.Sprintf(&quot;message-%2d&quot;, i)\n        }\n        close(channel) \/\/\u5173\u95edChannel\n    }()\n\n    var more bool = true\n    var msg string\n    for more {\n        select{\n        \/\/channel\u4f1a\u8fd4\u56de\u4e24\u4e2a\u503c\uff0c\u4e00\u4e2a\u662f\u5185\u5bb9\uff0c\u4e00\u4e2a\u662f\u8fd8\u6709\u6ca1\u6709\u5185\u5bb9\n        case msg, more = &lt;- channel:\n            if more {\n                fmt.Println(msg)\n            }else{\n                fmt.Println(&quot;channel closed!&quot;)\n            }\n        }\n    }\n}<\/pre>\n<h4><span class=\"ez-toc-section\" id=\"%E5%AE%9A%E6%97%B6%E5%99%A8\"><\/span>\u5b9a\u65f6\u5668<span class=\"ez-toc-section-end\"><\/span><\/h4>\n<p>Go\u8bed\u8a00\u4e2d\u53ef\u4ee5\u4f7f\u7528time.NewTimer\u6216time.NewTicker\u6765\u8bbe\u7f6e\u4e00\u4e2a\u5b9a\u65f6\u5668\uff0c\u8fd9\u4e2a\u5b9a\u65f6\u5668\u4f1a\u7ed1\u5b9a\u5728\u4f60\u7684\u5f53\u524dchannel\u4e2d\uff0c\u901a\u8fc7channel\u7684\u963b\u585e\u901a\u77e5\u673a\u5668\u6765\u901a\u77e5\u4f60\u7684\u7a0b\u5e8f\u3002<\/p>\n<p>\u4e0b\u9762\u662f\u4e00\u4e2atimer\u7684\u793a\u4f8b\u3002<\/p>\n<pre class=\"EnlighterJSRAW\" data-enlighter-language=\"golang\" data-enlighter-highlight=\"9\">package main\n\nimport &quot;time&quot;\nimport &quot;fmt&quot;\n\nfunc main() {\n    timer := time.NewTimer(2*time.Second)\n\n    &lt;- timer.C\n    fmt.Println(&quot;timer expired!&quot;)\n}<\/pre>\n<p>\u4e0a\u9762\u7684\u4f8b\u7a0b\u770b\u8d77\u6765\u50cf\u4e00\u4e2aSleep\uff0c\u662f\u7684\uff0c\u4e0d\u8fc7Timer\u662f\u53ef\u4ee5Stop\u7684\u3002\u4f60\u9700\u8981\u6ce8\u610fTimer\u53ea\u901a\u77e5\u4e00\u6b21\u3002\u5982\u679c\u4f60\u8981\u50cfC\u4e2d\u7684Timer\u80fd\u6301\u7eed\u901a\u77e5\u7684\u8bdd\uff0c\u4f60\u9700\u8981\u4f7f\u7528Ticker\u3002\u4e0b\u9762\u662fTicker\u7684\u4f8b\u7a0b\uff1a<\/p>\n<pre class=\"EnlighterJSRAW\" data-enlighter-language=\"golang\" data-enlighter-highlight=\"9\">package main\n\nimport &quot;time&quot;\nimport &quot;fmt&quot;\n\nfunc main() {\n    ticker := time.NewTicker(time.Second)\n\n    for t := range ticker.C {\n        fmt.Println(&quot;Tick at&quot;, t)\n    }\n}<\/pre>\n<p>\u4e0a\u9762\u7684\u8fd9\u4e2aticker\u4f1a\u8ba9\u4f60\u7a0b\u5e8f\u8fdb\u5165\u6b7b\u5faa\u73af\uff0c\u6211\u4eec\u5e94\u8be5\u653e\u5176\u653e\u5728\u4e00\u4e2agoroutine\u4e2d\u3002\u4e0b\u9762\u8fd9\u4e2a\u7a0b\u5e8f\u7ed3\u5408\u4e86timer\u548cticker<\/p>\n<pre class=\"EnlighterJSRAW\" data-enlighter-language=\"golang\">package main\n\nimport &quot;time&quot;\nimport &quot;fmt&quot;\n\nfunc main() {\n\n    ticker := time.NewTicker(time.Second)\n\n    go func () {\n        for t := range ticker.C {\n            fmt.Println(t)\n        }\n    }()\n\n    \/\/\u8bbe\u7f6e\u4e00\u4e2atimer\uff0c10\u949e\u540e\u505c\u6389ticker\n    timer := time.NewTimer(10*time.Second)\n    &lt;- timer.C\n\n    ticker.Stop()\n    fmt.Println(&quot;timer expired!&quot;)\n}<\/pre>\n<h4><span class=\"ez-toc-section\" id=\"Socket%E7%BC%96%E7%A8%8B\"><\/span>Socket\u7f16\u7a0b<span class=\"ez-toc-section-end\"><\/span><\/h4>\n<p>\u4e0b\u9762\u662f\u6211\u5c1d\u8bd5\u7684\u4e00\u4e2aEcho Server\u7684Socket\u4ee3\u7801\uff0c\u611f\u89c9\u8fd8\u662f\u633a\u7b80\u5355\u7684\u3002<\/p>\n<p><strong>Server\u7aef<\/strong><\/p>\n<pre class=\"EnlighterJSRAW\" data-enlighter-language=\"golang\" data-enlighter-highlight=\"12,19,24,33,36\"> \npackage main\n\nimport (\n    &quot;net&quot;\n    &quot;fmt&quot;\n    &quot;io&quot;\n)\n\nconst RECV_BUF_LEN = 1024\n\nfunc main() {\n    listener, err := net.Listen(&quot;tcp&quot;, &quot;0.0.0.0:6666&quot;)\/\/\u4fa6\u542c\u57286666\u7aef\u53e3\n    if err != nil {\n        panic(&quot;error listening:&quot;+err.Error())\n    }\n    fmt.Println(&quot;Starting the server&quot;)\n\n    for {\n        conn, err := listener.Accept() \/\/\u63a5\u53d7\u8fde\u63a5\n        if err != nil {\n            panic(&quot;Error accept:&quot;+err.Error())\n        }\n        fmt.Println(&quot;Accepted the Connection :&quot;, conn.RemoteAddr())\n        go EchoServer(conn)\n    }\n}\n\nfunc EchoServer(conn net.Conn) {\n    buf := make([]byte, RECV_BUF_LEN)\n    defer conn.Close()\n\n    for {\n        n, err := conn.Read(buf);\n        switch err {\n            case nil:\n                conn.Write( buf[0:n] )\n            case io.EOF:\n                fmt.Printf(&quot;Warning: End of data: %s \\n&quot;, err);\n                return\n            default:\n                fmt.Printf(&quot;Error: Reading data : %s \\n&quot;, err);\n                return\n        }\n     }\n}\n<\/pre>\n<p><strong>Client\u7aef<\/strong><\/p>\n<pre class=\"EnlighterJSRAW\" data-enlighter-language=\"golang\" data-enlighter-highlight=\"12,23,31\">\npackage main\n\nimport (\n    &quot;fmt&quot;\n    &quot;time&quot;\n    &quot;net&quot;\n)\n\nconst RECV_BUF_LEN = 1024\n\nfunc main() {\n    conn,err := net.Dial(&quot;tcp&quot;, &quot;127.0.0.1:6666&quot;)\n    if err != nil {\n        panic(err.Error())\n    }\n    defer conn.Close()\n\n    buf := make([]byte, RECV_BUF_LEN)\n\n    for i := 0; i &lt; 5; i++ {\n        \/\/\u51c6\u5907\u8981\u53d1\u9001\u7684\u5b57\u7b26\u4e32\n        msg := fmt.Sprintf(&quot;Hello World, %03d&quot;, i)\n        n, err := conn.Write([]byte(msg))\n        if err != nil {\n            println(&quot;Write Buffer Error:&quot;, err.Error())\n            break\n        }\n        fmt.Println(msg)\n\n        \/\/\u4ece\u670d\u52a1\u5668\u7aef\u6536\u5b57\u7b26\u4e32\n        n, err = conn.Read(buf)\n        if err !=nil {\n            println(&quot;Read Buffer Error:&quot;, err.Error())\n            break\n        }\n        fmt.Println(string(buf[0:n]))\n\n        \/\/\u7b49\u4e00\u79d2\u949f\n        time.Sleep(time.Second)\n    }\n}\n<\/pre>\n<h4><span class=\"ez-toc-section\" id=\"%E7%B3%BB%E7%BB%9F%E8%B0%83%E7%94%A8\"><\/span>\u7cfb\u7edf\u8c03\u7528<span class=\"ez-toc-section-end\"><\/span><\/h4>\n<p>Go\u8bed\u8a00\u90a3\u4e48C\uff0c\u6240\u4ee5\uff0c\u4e00\u5b9a\u4f1a\u6709\u4e00\u4e9b\u7cfb\u7edf\u8c03\u7528\u3002Go\u8bed\u8a00\u4e3b\u8981\u662f\u901a\u8fc7\u4e24\u4e2a\u5305\u5b8c\u6210\u7684\u3002\u4e00\u4e2a\u662f<a href=\"http:\/\/golang.org\/pkg\/os\/\" target=\"_blank\" rel=\"noopener noreferrer\">os\u5305<\/a>\uff0c\u4e00\u4e2a\u662f<a href=\"http:\/\/golang.org\/pkg\/syscall\/\" target=\"_blank\" rel=\"noopener noreferrer\">syscall\u5305<\/a>\u3002\uff08\u6ce8\u610f\uff0c\u94fe\u63a5\u88ab\u5899\uff09<\/p>\n<p>\u8fd9\u4e24\u4e2a\u5305\u91cc\u63d0\u4f9b\u90fd\u662fUnix-Like\u7684\u7cfb\u7edf\u8c03\u7528\uff0c<\/p>\n<ul>\n<li>syscall\u91cc\u63d0\u4f9b\u4e86\u4ec0\u4e48Chroot\/Chmod\/Chmod\/Chdir&#8230;\uff0cGetenv\/Getgid\/Getpid\/Getgroups\/Getpid\/Getppid&#8230;\uff0c\u8fd8\u6709\u5f88\u591a\u5982Inotify\/Ptrace\/Epoll\/Socket\/&#8230;\u7684\u7cfb\u7edf\u8c03\u7528\u3002<\/li>\n<\/ul>\n<ul>\n<li>os\u5305\u91cc\u63d0\u4f9b\u7684\u4e1c\u897f\u4e0d\u591a\uff0c\u4e3b\u8981\u662f\u4e00\u4e2a\u8de8\u5e73\u53f0\u7684\u8c03\u7528\u3002\u5b83\u6709\u4e09\u4e2a\u5b50\u5305\uff0cExec\uff08\u8fd0\u884c\u522b\u7684\u547d\u4ee4\uff09, Signal\uff08\u6355\u6349\u4fe1\u53f7\uff09\u548cUser\uff08\u901a\u8fc7uid\u67e5name\u4e4b\u7c7b\u7684\uff09<\/li>\n<\/ul>\n<p>syscall\u5305\u7684\u4e1c\u897f\u6211\u4e0d\u4e3e\u4f8b\u4e86\uff0c\u5927\u5bb6\u53ef\u4ee5\u770b\u770b\u300aUnix\u9ad8\u7ea7\u73af\u5883\u7f16\u7a0b\u300b\u4e00\u4e66\u3002<\/p>\n<p>os\u91cc\u7684\u53d6\u51e0\u4e2a\u4f8b\uff1a<\/p>\n<p><strong>\u73af\u5883\u53d8\u91cf<\/strong><\/p>\n<pre class=\"EnlighterJSRAW\" data-enlighter-language=\"golang\">package main\n\nimport &quot;os&quot;\nimport &quot;strings&quot;\n\n\nfunc main() {\n    os.Setenv(&quot;WEB&quot;, &quot;https:\/\/coolshell.cn&quot;) \/\/\u8bbe\u7f6e\u73af\u5883\u53d8\u91cf\n    println(os.Getenv(&quot;WEB&quot;)) \/\/\u8bfb\u51fa\u6765\n\n    for _, env := range os.Environ() { \/\/\u7a77\u4e3e\u73af\u5883\u53d8\u91cf\n        e := strings.Split(env, &quot;=&quot;)\n        println(e[0], &quot;=&quot;, e[1])\n    }\n}\n<\/pre>\n<h4><span class=\"ez-toc-section\" id=\"%E6%89%A7%E8%A1%8C%E5%91%BD%E4%BB%A4%E8%A1%8C\"><\/span>\u6267\u884c\u547d\u4ee4\u884c<span class=\"ez-toc-section-end\"><\/span><\/h4>\n<p>\u4e0b\u9762\u662f\u4e00\u4e2a\u6bd4\u8f83\u7b80\u5355\u7684\u793a\u4f8b<\/p>\n<pre class=\"EnlighterJSRAW\" data-enlighter-language=\"golang\">\npackage main\nimport &quot;os\/exec&quot;\nimport &quot;fmt&quot;\nfunc main() {\n    cmd := exec.Command(&quot;ping&quot;, &quot;127.0.0.1&quot;)\n    out, err := cmd.Output()\n    if err!=nil {\n        println(&quot;Command Error!&quot;, err.Error())\n        return\n    }\n    fmt.Println(string(out))\n}<\/pre>\n<p>\u6b63\u89c4\u4e00\u70b9\u7684\u7528\u6765\u5904\u7406\u6807\u51c6\u8f93\u5165\u548c\u8f93\u51fa\u7684\u793a\u4f8b\u5982\u4e0b\uff1a<\/p>\n<pre class=\"EnlighterJSRAW\" data-enlighter-language=\"golang\">package main\n\nimport (\n    &quot;strings&quot;\n    &quot;bytes&quot;\n    &quot;fmt&quot;\n    &quot;log&quot;\n    &quot;os\/exec&quot;\n)\n\nfunc main() {\n    cmd := exec.Command(&quot;tr&quot;, &quot;a-z&quot;, &quot;A-Z&quot;)\n    cmd.Stdin = strings.NewReader(&quot;some input&quot;)\n    var out bytes.Buffer\n    cmd.Stdout = &amp;out\n    err := cmd.Run()\n    if err != nil {\n        log.Fatal(err)\n    }\n    fmt.Printf(&quot;in all caps: %q\\n&quot;, out.String())\n}<\/pre>\n<h4><span class=\"ez-toc-section\" id=\"%E5%91%BD%E4%BB%A4%E8%A1%8C%E5%8F%82%E6%95%B0\"><\/span>\u547d\u4ee4\u884c\u53c2\u6570<span class=\"ez-toc-section-end\"><\/span><\/h4>\n<p>Go\u8bed\u8a00\u4e2d\u5904\u7406\u547d\u4ee4\u884c\u53c2\u6570\u5f88\u7b80\u5355\uff1a(\u4f7f\u7528os\u7684Args\u5c31\u53ef\u4ee5\u4e86)<\/p>\n<pre class=\"EnlighterJSRAW\" data-enlighter-language=\"golang\" data-enlighter-highlight=\"2\">func main() {\n    args := os.Args\n    fmt.Println(args) \/\/\u5e26\u6267\u884c\u6587\u4ef6\u7684\n    fmt.Println(args[1:]) \/\/\u4e0d\u5e26\u6267\u884c\u6587\u4ef6\u7684\n}<\/pre>\n<p>\u5728Windows\u4e0b\uff0c\u5982\u679c\u8fd0\u884c\u7ed3\u679c\u5982\u4e0b\uff1a<\/p>\n<p><code>C:\\Projects\\Go>go run args.go aaa bbb ccc ddd<br \/>\n[C:\\Users\\haoel\\AppData\\Local\\Temp\\go-build742679827\\command-line-arguments&#95;<br \/>\nobj\\a.out.exe aaa bbb ccc ddd]<br \/>\n[aaa bbb ccc ddd]<\/code><\/p>\n<p>\u90a3\u4e48\uff0c\u5982\u679c\u6211\u4eec\u8981\u641e\u51fa\u4e00\u4e9b\u50cf mysql -uRoot -hLocalhost -pPwd \u6216\u662f\u50cf cc -O3 -Wall -o a a.c \u8fd9\u6837\u7684\u547d\u4ee4\u884c\u53c2\u6570\u6211\u4eec\u600e\u4e48\u529e\uff1fGo\u63d0\u4f9b\u4e86\u4e00\u4e2apackage\u53ebflag\u53ef\u4ee5\u5bb9\u6613\u5730\u505a\u5230\u8fd9\u4e00\u70b9<\/p>\n<pre class=\"EnlighterJSRAW\" data-enlighter-language=\"golang\" data-enlighter-highlight=\"13\">\npackage main\nimport &quot;flag&quot;\nimport &quot;fmt&quot;\n\nfunc main() {\n\n    \/\/\u7b2c\u4e00\u4e2a\u53c2\u6570\u662f\u201c\u53c2\u6570\u540d\u201d\uff0c\u7b2c\u4e8c\u4e2a\u662f\u201c\u9ed8\u8ba4\u503c\u201d\uff0c\u7b2c\u4e09\u4e2a\u662f\u201c\u8bf4\u660e\u201d\u3002\u8fd4\u56de\u7684\u662f\u6307\u9488\n    host := flag.String(&quot;host&quot;, &quot;coolshell.cn&quot;, &quot;a host name &quot;)\n    port := flag.Int(&quot;port&quot;, 80, &quot;a port number&quot;)\n    debug := flag.Bool(&quot;d&quot;, false, &quot;enable\/disable debug mode&quot;)\n\n    \/\/\u6b63\u5f0f\u5f00\u59cbParse\u547d\u4ee4\u884c\u53c2\u6570\n    flag.Parse()\n\n    fmt.Println(&quot;host:&quot;, *host)\n    fmt.Println(&quot;port:&quot;, *port)\n    fmt.Println(&quot;debug:&quot;, *debug)\n}<\/pre>\n<p>\u6267\u884c\u8d77\u6765\u4f1a\u662f\u8fd9\u4e2a\u6837\u5b50\uff1a<\/p>\n<pre class=\"EnlighterJSRAW\" data-enlighter-language=\"shell\">\n#\u5982\u679c\u6ca1\u6709\u6307\u5b9a\u53c2\u6570\u540d\uff0c\u5219\u4f7f\u7528\u9ed8\u8ba4\u503c\n$ go run flagtest.go\nhost: coolshell.cn\nport: 80\ndebug: false\n\n#\u6307\u5b9a\u4e86\u53c2\u6570\u540d\u540e\u7684\u60c5\u51b5\n$ go run flagtest.go -host=localhost -port=22 -d\nhost: localhost\nport: 22\ndebug: true\n\n#\u7528\u6cd5\u51fa\u9519\u4e86\uff08\u5982\uff1a\u4f7f\u7528\u4e86\u4e0d\u652f\u6301\u7684\u53c2\u6570\uff0c\u53c2\u6570\u6ca1\u6709=\uff09\n$ go build flagtest.go\n$ .\/flagtest -debug -host localhost -port=22\nflag provided but not defined: -debug\nUsage of flagtest:\n  -d=false: enable\/disable debug mode\n  -host=&quot;coolshell.cn&quot;: a host name\n  -port=80: a port number\nexit status 2\n<\/pre>\n<p>\u611f\u89c9\u8fd8\u662f\u633a\u4e0d\u9519\u7684\u5427\u3002<\/p>\n<h4><span class=\"ez-toc-section\" id=\"%E4%B8%80%E4%B8%AA%E7%AE%80%E5%8D%95%E7%9A%84HTTP_Server\"><\/span>\u4e00\u4e2a\u7b80\u5355\u7684HTTP Server<span class=\"ez-toc-section-end\"><\/span><\/h4>\n<p>\u4ee3\u7801\u80dc\u8fc7\u5343\u8a00\u4e07\u8bed\u3002\u5475\u5475\u3002\u8fd9\u4e2a\u5c0f\u7a0b\u5e8f\u8ba9\u6211\u53c8\u627e\u56de\u4ee5\u524d\u7528C\u5199CGI\u7684\u65f6\u5149\u4e86\u3002\uff08Go\u7684\u5b98\u65b9\u6587\u6863\u662f\u300a<strong><a href=\"http:\/\/golang.org\/doc\/articles\/wiki\/\" target=\"_blank\" rel=\"noopener noreferrer\">Writing Web Applications<\/a><\/strong>\u300b\uff09<\/p>\n<pre class=\"EnlighterJSRAW\" data-enlighter-language=\"golang\">package main\n\nimport (\n    &quot;fmt&quot;\n    &quot;net\/http&quot;\n    &quot;io\/ioutil&quot;\n    &quot;path\/filepath&quot;\n)\n\nconst http_root = &quot;\/home\/haoel\/coolshell.cn\/&quot;\n\nfunc main() {\n    http.HandleFunc(&quot;\/&quot;, rootHandler)\n    http.HandleFunc(&quot;\/view\/&quot;, viewHandler)\n    http.HandleFunc(&quot;\/html\/&quot;, htmlHandler)\n\n    http.ListenAndServe(&quot;:8080&quot;, nil)\n}\n\n\/\/\u8bfb\u53d6\u4e00\u4e9bHTTP\u7684\u5934\nfunc rootHandler(w http.ResponseWriter, r *http.Request) {\n    fmt.Fprintf(w, &quot;rootHandler: %s\\n&quot;, r.URL.Path)\n    fmt.Fprintf(w, &quot;URL: %s\\n&quot;, r.URL)\n    fmt.Fprintf(w, &quot;Method: %s\\n&quot;, r.Method)\n    fmt.Fprintf(w, &quot;RequestURI: %s\\n&quot;, r.RequestURI )\n    fmt.Fprintf(w, &quot;Proto: %s\\n&quot;, r.Proto)\n    fmt.Fprintf(w, &quot;HOST: %s\\n&quot;, r.Host) \n}\n\n\/\/\u7279\u522b\u7684URL\u5904\u7406\nfunc viewHandler(w http.ResponseWriter, r *http.Request) {\n    fmt.Fprintf(w, &quot;viewHandler: %s&quot;, r.URL.Path)\n}\n\n\/\/\u4e00\u4e2a\u9759\u6001\u7f51\u9875\u7684\u670d\u52a1\u793a\u4f8b\u3002\uff08\u5728http_root\u7684html\u76ee\u5f55\u4e0b\uff09\nfunc htmlHandler(w http.ResponseWriter, r *http.Request) {\n    fmt.Printf(&quot;htmlHandler: %s\\n&quot;, r.URL.Path)\n    \n    filename := http_root + r.URL.Path\n    fileext := filepath.Ext(filename)\n\n    content, err := ioutil.ReadFile(filename)\n    if err != nil {\n        fmt.Printf(&quot;   404 Not Found!\\n&quot;)\n        w.WriteHeader(http.StatusNotFound)\n        return\n    }\n    \n    var contype string\n    switch fileext {\n        case &quot;.html&quot;, &quot;htm&quot;:\n            contype = &quot;text\/html&quot;\n        case &quot;.css&quot;:\n            contype = &quot;text\/css&quot;\n        case &quot;.js&quot;:\n            contype = &quot;application\/javascript&quot;\n        case &quot;.png&quot;:\n            contype = &quot;image\/png&quot;\n        case &quot;.jpg&quot;, &quot;.jpeg&quot;:\n            contype = &quot;image\/jpeg&quot;\n        case &quot;.gif&quot;:\n            contype = &quot;image\/gif&quot;\n        default: \n            contype = &quot;text\/plain&quot;\n    }\n    fmt.Printf(&quot;ext %s, ct = %s\\n&quot;, fileext, contype)\n    \n    w.Header().Set(&quot;Content-Type&quot;, contype)\n    fmt.Fprintf(w, &quot;%s&quot;, content)\n    \n}<\/pre>\n<p>Go\u7684\u529f\u80fd\u5e93\u6709\u5f88\u591a\uff0c\u5927\u5bb6\u81ea\u5df1\u6162\u6162\u770b\u5427\u3002<strong>\u6211\u518d\u5410\u4e2a\u69fd\u2014\u2014Go\u7684\u6587\u6863\u771f\u4e0d\u597d\u8bfb\u3002\u4f8b\u5b50\u592a\u5c11\u4e86<\/strong>\u3002<\/p>\n<p>\u5148\u8bf4\u8fd9\u4e48\u591a\u5427\u3002\u8fd9\u662f\u6211\u5468\u672b\u4e24\u5929\u5b66Go\u8bed\u8a00\u5b66\u5230\u7684\u4e1c\u897f\uff0c\u5199\u5f97\u592a\u4ed3\u4fc3\u4e86\uff0c\u800c\u4e14\u8fd8\u6709\u4e00\u4e9b\u4e1c\u897f\u7406\u89e3\u4e0d\u5230\u4f4d\uff0c\u8fd8\u5927\u5bb6\u8bf7\u6307\u6b63\uff01<\/p>\n<p>\uff08\u5168\u6587\u5b8c\uff09<\/p>\n","raw":"","protected":false},"excerpt":{"rendered":"<p>\u5e0c\u671b\u4f60\u770b\u5230\u8fd9\u7bc7\u6587\u7ae0\u7684\u65f6\u5019\u8fd8\u662f\u5728\u516c\u4ea4\u8f66\u548c\u5730\u94c1\u4e0a\u6b63\u5728\u4e0a\u4e0b\u73ed\u7684\u65f6\u95f4\uff0c\u6211\u5e0c\u671b\u6211\u7684\u8fd9\u7bc7\u6587\u7ae0\u53ef\u4ee5\u8ba9\u4f60\u5229\u7528\u8fd9\u6bb5\u65f6\u95f4\u4e86\u89e3\u4e00\u95e8\u8bed\u8a00\u3002\u5f53\u7136\uff0c\u5e0c\u671b\u4f60\u4e0d\u4f1a\u56e0\u4e3a\u770b\u6211\u7684\u6587\u7ae0\u800c\u9519\u8fc7\u7ad9\u3002\u5475\u5475\u3002&#8230;<\/p>\n<p class=\"read-more\"><a class=\"btn btn-default\" href=\"https:\/\/coolshell.cn\/articles\/8489.html\"> Read More<span class=\"screen-reader-text\">  Read More<\/span><\/a><\/p>\n","protected":false},"author":2,"featured_media":0,"comment_status":"open","ping_status":"open","sticky":false,"template":"","format":"standard","meta":[],"categories":[819,23,3],"tags":[238,237],"series":[],"aioseo_notices":[],"views":100894,"post_thumbnail_image":"https:\/\/coolshell.cn\/wp-content\/uploads\/2012\/11\/google-go-language.jpg","content_first_image":"https:\/\/coolshell.cn\/wp-content\/uploads\/2012\/11\/google-go-language.jpg","post_medium_image_300":"https:\/\/coolshell.cn\/wp-content\/uploads\/2012\/11\/google-go-language.jpg","post_thumbnail_image_624":"https:\/\/coolshell.cn\/wp-content\/uploads\/2012\/11\/google-go-language.jpg","post_frist_image":"https:\/\/coolshell.cn\/wp-content\/uploads\/2012\/11\/google-go-language.jpg","post_medium_image":"https:\/\/coolshell.cn\/wp-content\/uploads\/2012\/11\/google-go-language.jpg","post_large_image":"https:\/\/coolshell.cn\/wp-content\/uploads\/2012\/11\/google-go-language.jpg","post_full_image":"https:\/\/coolshell.cn\/wp-content\/uploads\/2012\/11\/google-go-language.jpg","post_all_images":[{"imagesurl":"https:\/\/coolshell.cn\/wp-content\/uploads\/2012\/11\/google-go-language.jpg","id":"image0"}],"videoAdId":"","listAd":"0","listAdId":"","listAdEvery":5,"total_comments":95,"category_name":"Go \u8bed\u8a00","post_date":"2012-11-07","like_count":"0","praiseWord":"\u9f13\u52b1","excitationAd":"0","rewardedVideoAdId":"","detailAdId":"","detailAd":"0","enterpriseMinapp":"0","audios":[],"postImageUrl":"http:\/\/coolshell.cn\/wp-content\/uploads\/2016\/09\/coolshell-360x200.jpg","avatarurls":[],"related_posts":[],"pageviews":100895,"pageviews_wl":88342,"ratings_average":4,"ratings_total":144,"ratings_users":34,"next_post_id":8593,"next_post_title":"\u5982\u4f55\u6d4b\u8bd5\u6d17\u724c\u7a0b\u5e8f","previous_post_id":8460,"previous_post_title":"Go \u8bed\u8a00\u7b80\u4ecb\uff08\u4e0a\uff09\u2014 \u8bed\u6cd5"}